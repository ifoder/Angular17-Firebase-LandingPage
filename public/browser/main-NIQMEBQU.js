import{$ as cu,$a as zt,A as bn,Aa as _u,B as wn,Ba as fe,C as ps,Ca as Jo,D as fs,Da as gu,E as Pt,Ea as re,F as Zc,Fa as Ce,G as Tn,Ga as Es,H as Cn,Ha as at,Ia as lt,Ja as It,K as eu,Ka as Ne,La as Rt,M as He,Ma as Ze,N as Ge,Na as ct,O as je,Oa as ut,P as tu,Pa as Ru,Q as si,Qa as Mu,R as nu,Ra as ku,S as iu,Sa as Ss,T as su,Ta as Ou,U as ou,Ua as Nu,V as ru,Va as Au,W as au,Wa as dt,Xa as ht,Ya as xu,Z as lu,Za as Pu,_ as ms,_a as Lt,a as Bc,aa as uu,ab as Fu,b as Lc,bb as Mn,c as zc,ca as se,cb as Ds,d as Vc,da as oe,db as Ke,e as Uc,ea as En,eb as Is,f as $c,fa as Sn,fb as Bu,g as Hc,ga as Dn,gb as Rs,h as Gc,ha as du,hb as Ms,i as pe,ia as hu,ib as ks,j as hs,jb as Lu,k as jc,kb as zu,l as Wc,m as Kc,n as qc,na as pu,o as Yc,oa as fu,q as Qc,r as Jc,s as gn,t as Z,u as xt,v as yn,x as Xc,y as vn,za as mu}from"./chunk-AYWM6SXM.js";import{$ as _c,$b as W,Aa as bt,B as vt,Ba as wt,Bb as w,Bc as kc,C as Vo,Cc as Oc,Db as Ko,Dc as Nc,E as hn,F as st,Fb as os,Fc as Ac,G as dc,Gc as we,H as is,Ha as X,Ja as bc,Ka as ti,Lb as V,Ma as jo,Mb as J,Mc as as,Nb as rs,O as Xn,Ob as ii,Oc as xc,Pa as de,Pb as Et,Qb as St,Qc as Qo,R as Zn,Rb as g,S as hc,Sb as _,Ta as Tt,Tb as A,Tc as ls,Ua as wc,V as pc,W as fc,Xb as Dt,Yc as mn,Z as mc,_ as Uo,aa as $o,bc as ve,c as Jt,ca as gc,cc as Dc,da as Ho,dc as Ic,ea as ke,ec as pn,f as Ue,fa as Go,ga as Ae,gb as ni,gc as be,hc as v,ia as yc,ib as Tc,ic as he,id as cs,j as cc,jb as Wo,jc as fn,ka as ei,kb as Cc,kc as Rc,lc as Mc,ld as _n,m as uc,ma as vc,mb as ss,md as us,n as Jn,na as ye,nb as Ec,o as ts,oa as O,p as ns,pc as L,q as ge,qb as m,ra as G,rb as xe,sa as D,sd as Pc,ta as b,u as ue,ub as Ct,va as B,vb as j,vc as qo,w as zo,wa as N,wc as Yo,wd as $e,yd as ds,zb as Sc,zd as Fc}from"./chunk-XIQZ7Y67.js";import{a as Vu}from"./chunk-J7IX5MLJ.js";import{a as et}from"./chunk-2QU4JL6V.js";import"./chunk-ISPV3OIH.js";import"./chunk-6ATVBBSN.js";import{$ as nr,A as ys,B as ee,C as wu,D as Tu,E as We,F as Ft,G as vs,H as ci,I as Cu,J as Eu,M as Su,O as C,P as Oe,Q as te,R as er,S as Du,T as ui,U as bs,V as $,W as ne,X as ws,Y as tr,Z as Iu,_ as Bt,a as f,aa as Ts,b as In,c as _s,d as yu,ea as Te,f as vu,fa as Xe,ha as Cs,i as oi,ja as rt,k as ae,l as gs,ma as z,n as Xo,q as Zo,r as bu,t as ot,v as Xt,w as ri,x as ai,y as li,z as Rn}from"./chunk-MFV7QFFA.js";import{a as Me,b as Je,f as T}from"./chunk-FO65GQC2.js";var Uu={title:"Kade\u0159nictv\xED Miko Brno",phone:"+420 775 495 488",addressText:"Skacelova 1648/24, Brno-Kralovo Pole",workHour:"Po-P\xE0 09:00-20:00 So-N\u011B 10:00-18:00",buttontext:"\u041E\u043D\u043B\u0430\u0439\u043D \u0431\u0440\u043E\u043D\u044E\u0432\u0430\u043D\u043D\u044F"};var $u={title:"\u041F\u0440\u0430\u0439\u0441-\u043B\u0438\u0441\u0442",cardButton:"\u0417\u0430\u0431\u0440\u043E\u043D\u044E\u0432\u0430\u0442\u0438 \u0434\u0430\u0442\u0443",currently:"K\u010D"},Hu={title:"Gallery",description:"Project images",detail:`Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam!`,GalleryImages:[{id:1,url:"../assets/images/gallery-images/gallery-image-1.jpg",name:"Tree"},{id:2,url:"../assets/images/gallery-images/gallery-image-2.jpg",name:"Fingerprint"},{id:3,url:"../assets/images/gallery-images/gallery-image-3.jpg",name:"The Man"},{id:4,url:"../assets/images/gallery-images/gallery-image-4.jpg",name:"Mustache"},{id:5,url:"../assets/images/gallery-images/gallery-image-5.jpg",name:"Moose"},{id:6,url:"../assets/images/gallery-images/gallery-image-6.jpg",name:"Justice"}]};var di=["9:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00"];function Em(t,e){if(t&1&&(g(0,"blockquote",4),A(1,"img",5),g(2,"q"),v(3),_(),g(4,"footer"),v(5),_()()),t&2){let n=e.$implicit;w("nzXl",8)("nzLg",8)("nzMd",12)("nzSm",20)("nzXs",20),m(1),pn("src",n.userimage,ni),m(2),he(n.comments),m(2),fn("",n.name," - Happy Customer")}}var Os=(()=>{let e=class e{constructor(){this.testimonials={title:"\u0412\u0456\u0434\u0433\u0443\u043A\u0438",description:"\u0429\u043E \u043F\u0440\u043E \u043D\u0430\u0441 \u043A\u0430\u0436\u0443\u0442\u044C",detail:"",feedbacks:[{name:"John Doe",userimage:"../assets/images/user-images/user-1.jpg",comments:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua",company:"ABC"},{name:"Roslyn Doe",userimage:"../assets/images/user-images/user-2.jpg",comments:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua",company:"XYZ"},{name:"Thomas Doe",userimage:"../assets/images/user-images/user-3.jpg",comments:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua",company:"PQR"}]}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-feedback"]],standalone:!0,features:[L],decls:9,vars:3,consts:[["id","testimonials","data-enllax-ratio",".2",1,"scrollto"],["nz-row","",1,"row2","clearfix"],["nz-col","",1,"section-heading",3,"nzSpan"],[1,"section-title"],["nz-col","",1,"col-3","testimonial","classic",3,"nzXl","nzLg","nzMd","nzSm","nzXs"],["alt","User",3,"src"],["nz-col","","class","col-3 testimonial classic",3,"nzXl","nzLg","nzMd","nzSm","nzXs"]],template:function(s,o){s&1&&(g(0,"aside",0)(1,"div",1)(2,"div",2)(3,"h3"),v(4),_(),g(5,"h2",3),v(6),_()(),Et(7,Em,6,8,"blockquote",6,ii),_()()),s&2&&(m(2),w("nzSpan",20),m(2),he(o.testimonials.title),m(2),he(o.testimonials.description),m(1),St(o.testimonials.feedbacks))},dependencies:[fe,oe,se]});let t=e;return t})();var ir=(()=>{let e=class e{constructor(){this.header=Uu,this._contactsService=b(Ds),this.client=this._contactsService.$contacts,this.i18n=b(Mn)}googleNav(){window.open("https://maps.google.com/maps?daddr="+Jo.lat+","+Jo.lng)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-home"]],standalone:!0,features:[L],decls:21,vars:7,consts:[["id","banner","data-enllax-ratio",".5",1,"scrollto","clearfix"],["nz-row","","id","banner-content",1,"row2","clearfix"],["nz-col","",1,"section-heading",3,"nzSpan"],[1,"section-title"],["nz-row","",1,"ant-flex-justify-center","big-padding-top","big-padding-bottom"],["nz-col","",1,"section-subtitle",3,"nzSpan"],["nz-col","",3,"nzSpan"],["routerLink","/reserve","routerLinkActive","active",1,"button"]],template:function(s,o){s&1&&(g(0,"app-layout")(1,"header",0)(2,"div",1)(3,"div",2)(4,"h1",3),v(5),_()(),g(6,"div",4)(7,"div",5)(8,"p")(9,"b"),v(10),_()(),g(11,"p"),v(12),_()()(),g(13,"div",6)(14,"a",7),v(15),_()()()(),A(16,"app-about")(17,"app-services")(18,"app-feedback")(19,"app-clients"),v(20," >"),_()),s&2&&(m(3),w("nzSpan",20),m(2),he(o.header.title),m(2),w("nzSpan",20),m(3),he(o.client().location),m(2),he(o.client().phone),m(1),w("nzSpan",20),m(2),he(o.i18n.get("header.buttontext")))},dependencies:[Rs,hs,jc,Is,Os,ks,fe,oe,se,Ke],encapsulation:2});let t=e;return t})();function Sm(t,e){if(t&1&&(g(0,"a",1),A(1,"img",2),_()),t&2){let n=e.$implicit;pn("href",n.url,ni),m(1),pn("src",n.url,ni),pn("alt",n.name)}}var Gu=(()=>{let e=class e{constructor(){this.Gallery=Hu}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-gallery"]],standalone:!0,features:[L],decls:3,vars:0,consts:[["id","gallery","data-featherlight-gallery","","data-featherlight-filter","a",1,"row2","text-center","scrollto","clearfix"],["data-featherlight","image","data-wow-delay","0.1s",1,"col-3","wow","fadeIn",3,"href"],[3,"src","alt"],["data-featherlight","image","class","col-3 wow fadeIn","data-wow-delay","0.1s",3,"href"]],template:function(s,o){s&1&&(g(0,"aside",0),Et(1,Sm,2,3,"a",3,ii),_()),s&2&&(m(1),St(o.Gallery.GalleryImages))}});let t=e;return t})();function Im(t,e){if(t&1&&A(0,"nz-avatar",10),t&2){let n=ve().$implicit;w("nzSrc",n.avatar)}}function Rm(t,e){if(t&1){let n=Dt();g(0,"div",6)(1,"nz-card",7),W("click",function(){let o=bt(n).$implicit,r=ve(2);return wt(r.submitBarber(o))}),A(2,"nz-card-meta",8),_(),V(3,Im,1,1,"ng-template",null,9,we),_()}if(t&2){let n=e.$implicit,i=be(4),s,o;w("nzXl",8)("nzLg",8)("nzMd",8)("nzSm",20)("nzXs",20),m(2),w("nzAvatar",i)("nzTitle",((s=n.name)!==null&&s!==void 0?s:n.name)||null)("nzDescription",((o=n.description)!==null&&o!==void 0?o:n.description)||null)}}function Mm(t,e){if(t&1&&(g(0,"section",1)(1,"div",2)(2,"div",3)(3,"h2",4),v(4,"\u041F\u0440\u0430\u0446\u0456\u0432\u043D\u0438\u043A\u0438"),_()(),V(5,Rm,5,8,"div",5),_()()),t&2){let n=e.ngIf;m(2),w("nzSpan",22),m(3),w("ngForOf",n)}}var Wu=(()=>{let e=class e{constructor(){this.eventBarber=new Ct,this._barbersService=b(Lu)}ngOnInit(){this.barbers$=this._barbersService.getBarbers()}submitBarber(i){this.eventBarber.emit(i)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-barbers"]],outputs:{eventBarber:"eventBarber"},standalone:!0,features:[L],decls:2,vars:3,consts:[["id","services","class","secondary-color scrollto",4,"ngIf"],["id","services",1,"secondary-color","scrollto"],["nz-row","",1,"row2","clearfix"],["nz-col","",1,"section-heading",3,"nzSpan"],["nz-col","","nzSpan","22",1,"section-title"],["nz-col","","class","service-category",3,"nzXl","nzLg","nzMd","nzSm","nzXs",4,"ngFor","ngForOf"],["nz-col","",1,"service-category",3,"nzXl","nzLg","nzMd","nzSm","nzXs"],["nzSize","small",1,"service-card",3,"click"],[3,"nzAvatar","nzTitle","nzDescription"],["avatarTemplate",""],[3,"nzSrc"]],template:function(s,o){s&1&&(V(0,Mm,6,2,"section",0),qo(1,"async")),s&2&&w("ngIf",Yo(1,1,o.barbers$))},dependencies:[$e,_n,us,Pc,fe,eu,ms,cu,oe,se,re],styles:[".service-card[_ngcontent-%COMP%]{transition:all .2s;cursor:pointer;padding-left:0!important;padding-right:0!important;margin:10px 5px}.service-card[_ngcontent-%COMP%]:hover{transform:scale(1.01);box-shadow:0 4px 8px #0003,0 6px 20px #00000030}.card-price[_ngcontent-%COMP%]{color:#f3751cd2;font-size:16px;font-weight:600}"]});let t=e;return t})();function km(t,e){if(t&1&&(g(0,"a",9),v(1),_()),t&2){let n=ve().$implicit;m(1),fn("",n.price," K\u010D")}}function Om(t,e){if(t&1){let n=Dt();g(0,"div",6)(1,"nz-card",7),W("click",function(){let o=bt(n).$implicit,r=ve(2);return wt(r.submitService(o))}),g(2,"p"),v(3),_()(),V(4,km,2,1,"ng-template",null,8,we),_()}if(t&2){let n=e.$implicit,i=be(5);w("nzXl",8)("nzLg",8)("nzMd",8)("nzSm",22)("nzXs",22),m(1),w("nzTitle",n.title)("nzExtra",i),m(2),fn(" ",n.description," ")}}function Nm(t,e){if(t&1&&(g(0,"h4",4),v(1),_(),V(2,Om,6,8,"div",5)),t&2){let n=e.$implicit,i=ve();m(1),he(i.i18n.get(n.title)),m(1),w("ngForOf",n.list)}}var Ku=(()=>{let e=class e{constructor(){this.eventService=new Ct,this._servicesService=b(Ms),this.i18n=b(Mn),this.visibleServices=ss(()=>{let i=this._servicesService.servicesSig(),s=this._servicesService.servicesCategorySig();return s.map(o=>o.list=i.filter(r=>o.id===r.categoryId)),s})}ngOnInit(){this._servicesService.getServices().subscribe(i=>this._servicesService.servicesSig.set(i)),this._servicesService.getServicesCategory().subscribe(i=>this._servicesService.servicesCategorySig.set(i))}submitService(i){this.eventService.emit(i)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-services"]],outputs:{eventService:"eventService"},standalone:!0,features:[L],decls:7,vars:1,consts:[["id","services",1,"secondary-color","scrollto"],["nz-row","",1,"row2","clearfix",2,"margin","0 auto"],["nz-col","","cl","","ass","section-heading",3,"nzSpan"],["nz-col","","nzSpan","22",1,"section-title"],["nz-col","","nzSpan","22"],["nz-col","","class","service-category",3,"nzXl","nzLg","nzMd","nzSm","nzXs",4,"ngFor","ngForOf"],["nz-col","",1,"service-category",3,"nzXl","nzLg","nzMd","nzSm","nzXs"],["nzSize","small",1,"service-card",3,"nzTitle","nzExtra","click"],["extraTemplate",""],[1,"card-price"]],template:function(s,o){s&1&&(g(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),v(4,"\u041F\u043E\u0441\u043B\u0443\u0433\u0438"),_()(),Et(5,Nm,3,2,null,null,rs),_()()),s&2&&(m(2),w("nzSpan",22),m(3),St(o.visibleServices()))},dependencies:[$e,_n,fe,ms,oe,se],styles:[".service-card[_ngcontent-%COMP%]{transition:all .2s;cursor:pointer;padding-left:0!important;padding-right:0!important;margin:10px 5px}.service-card[_ngcontent-%COMP%]:hover{transform:scale(1.01);box-shadow:0 4px 8px #0003,0 6px 20px #00000030}.card-price[_ngcontent-%COMP%]{color:#f3751cd2;font-size:16px;font-weight:600}"]});let t=e;return t})();function Am(t,e){if(t&1&&(g(0,"label",11),v(1),_()),t&2){let n=e.$implicit;w("nzValue",n),m(1),he(n)}}var qu=(()=>{let e=class e{constructor(){this.clickEvent=new Ct,this.selectedDate=new Date,this.timePicker=di,this._calendarEvents=b(Lt),this.calendarEvents=this._calendarEvents.$calendarEvents,this.disabledDate=i=>{let s=tu(i,new Date)<0;return this.timePicker.length<1?!0:s}}ngOnInit(){this.disabledTime(this.selectedDate)}selectDate(i){this.selectedTime=void 0,this.disabledTime(i)}disabledTime(i){let s=this._calendarEvents.getCalendarEventsOfDate(i).filter(o=>this._calendarEvents.$currentReserve()?.barber.id==o.barber.id);this.timePicker=di,s.forEach(o=>this.timePicker=this.timePicker.filter(r=>si(new Date(o.date),"HH:mm")!=r))}selectTime(i){let s=i.split(":");this.selectedDate.setHours(s[0],s[1],0)}clickNext(){this.clickEvent.emit(this.selectedDate)}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-datepicker"]],outputs:{clickEvent:"clickEvent"},standalone:!0,features:[L],decls:15,vars:16,consts:[["id","services",1,"secondary-color","scrollto"],["nz-row","",1,"row2","clearfix"],["nz-col","",1,"section-heading",3,"nzSpan"],["nz-col","","nzSpan","20"],["nz-row","","nzJustify","space-around",1,"row2","big-padding-top","big-padding-bottom"],["nz-col","",3,"nzXl","nzLg","nzMd","nzSm","nzXs"],[3,"ngModel","nzDisabledDate","nzFullscreen","ngModelChange","nzSelectChange"],["nz-col","",1,"big-padding-top",3,"nzXl","nzLg","nzMd","nzSm","nzXs"],["nzSize","large",3,"ngModel","ngModelChange"],["nz-col","","nzSpan","20",1,"big-padding-top"],["nz-button","","nzType","primary","nzBlock","",2,"width","100%",3,"disabled","click"],["nz-radio-button","",2,"margin","5px 10px",3,"nzValue"],["style","margin: 5px 10px","nz-radio-button","",3,"nzValue"]],template:function(s,o){s&1&&(g(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),v(4,"\u0412\u0438\u0431\u0435\u0440\u0456\u0442\u044C \u0442\u0435\u0440\u043C\u0456\u043D"),_()(),g(5,"div",4)(6,"div",5)(7,"nz-calendar",6),W("ngModelChange",function(a){return o.selectedDate=a})("nzSelectChange",function(a){return o.selectDate(a)}),_()(),g(8,"div",7)(9,"nz-radio-group",8),W("ngModelChange",function(a){return o.selectedTime=a})("ngModelChange",function(a){return o.selectTime(a)}),Et(10,Am,2,2,"label",12,rs),_()(),g(12,"div",9)(13,"button",10),W("click",function(){return o.clickNext()}),v(14," \u041F\u0440\u043E\u0434\u043E\u0432\u0436\u0438\u0442\u0438 "),_()()()()()),s&2&&(m(2),w("nzSpan",24),m(4),w("nzXl",10)("nzLg",10)("nzMd",20)("nzSm",20)("nzXs",20),m(1),w("ngModel",o.selectedDate)("nzDisabledDate",o.disabledDate)("nzFullscreen",!1),m(1),w("nzXl",10)("nzLg",10)("nzMd",20)("nzSm",20)("nzXs",20),m(1),w("ngModel",o.selectedTime),m(1),St(o.timePicker),m(3),w("disabled",!o.selectedTime))},dependencies:[$e,re,xt,Xc,je,He,Ge,lu,oe,se,iu,nu,fe],styles:[".time-lebel[_ngcontent-%COMP%]{margin-left:10px!important}"]});let t=e;return t})();function xm(t,e){if(t&1){let n=Dt();g(0,"app-services",1),W("eventService",function(s){bt(n);let o=ve();return wt(o.setSelectedService(s))}),_()}}function Pm(t,e){if(t&1){let n=Dt();g(0,"app-barbers",2),W("eventBarber",function(s){bt(n);let o=ve();return wt(o.setSelectedBarber(s))}),_()}}function Fm(t,e){if(t&1){let n=Dt();g(0,"app-datepicker",3),W("clickEvent",function(s){bt(n);let o=ve();return wt(o.setSelectedDate(s))}),_()}}var sr=(()=>{let e=class e{constructor(){this.auth=b(dt),this.route=b($c),this.router=b(pe),this._calendarEventService=b(Lt),this._servicesService=b(Ms),this._storage=b(ht),this.calendarEvent={},this.current=0,this.timePicker=di,this.price=$u}ngOnInit(){Number(this.route.snapshot.paramMap.get("service"))&&(this.current=1)}setSelectedBarber(i){this.current++,this._calendarEventService.$currentReserve.update(s=>s=Je(Me({},s),{barber:i})),this.calendarEvent.barber=i.id}setSelectedService(i){this.current++,this._calendarEventService.$currentReserve.update(s=>s=Je(Me({},s),{service:i})),this.calendarEvent.service=i.id}setSelectedDate(i){this.calendarEvent.date=i,this._calendarEventService.$currentReserve.update(s=>s=Je(Me({},s),{date:i})),this.auth.isAuth()?(this._calendarEventService.compliteReservace(),this.router.navigate(["home"])):this._calendarEventService.compliteReservace()}submitForm(i){}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-reserve"]],standalone:!0,features:[L],decls:5,vars:3,consts:[["id","pricing",1,"secondary-color","scrollto","clearfix"],[3,"eventService"],[3,"eventBarber"],[3,"clickEvent"]],template:function(s,o){s&1&&(g(0,"app-layout")(1,"section",0),V(2,xm,1,0,"app-services")(3,Pm,1,0,"app-barbers")(4,Fm,1,0,"app-datepicker"),_()()),s&2&&(m(2),J(2,o.current==0?2:-1),m(1),J(3,o.current==1?3:-1),m(1),J(4,o.current==2?4:-1))},dependencies:[$e,re,fe,Wu,Ku,qu,Ke],styles:["nz-select[_ngcontent-%COMP%]{margin:0 8px 10px 0;width:120px}.content[_ngcontent-%COMP%]{margin:0 auto;text-align:start;padding:90px 40px 50px}[nz-form][_ngcontent-%COMP%]{max-width:600px;padding-top:20px}.steps[_ngcontent-%COMP%]{max-width:500px;margin:0 auto;padding-bottom:5px}.phone-select[_ngcontent-%COMP%]{width:90px}.register-are[_ngcontent-%COMP%]{margin-bottom:8px}.steps-content[_ngcontent-%COMP%]{max-width:400;margin-top:16px;border:1px dashed #e9e9e9;border-radius:6px;background-color:#fafafa;min-height:200px;padding-top:80px}.steps-action[_ngcontent-%COMP%]{margin-top:24px}button[_ngcontent-%COMP%]{margin-right:8px}h3[_ngcontent-%COMP%]{margin-top:20px}.service-card[_ngcontent-%COMP%]{transition:all .2s;cursor:pointer;padding-left:0!important;padding-right:0!important;margin:10px 5px}.service-card[_ngcontent-%COMP%]:hover{transform:scale(1.01);box-shadow:0 4px 8px #0003,0 6px 20px #00000030}.card-price[_ngcontent-%COMP%]{color:#f3751cd2;font-size:16px;font-weight:600}.time-picker[_ngcontent-%COMP%]{display:flex}label[_ngcontent-%COMP%]{margin:4px}"]});let t=e;return t})();var kn=(()=>{let e=class e{constructor(){this.buttons=[],this._signIn=b(zt),this.router=b(pe)}ngOnInit(){}currentButton(i){return this.buttons.includes(i)}signInGoogle(){this._signIn.signInWithGoogle()}signInPhone(){this.router.navigate(["phone"])}signInEmail(){this.router.navigate(["login"])}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["button-login"]],inputs:{buttons:"buttons"},standalone:!0,features:[L],decls:10,vars:3,consts:[[1,"login-form"],["nz-button","","nzSize","large","nzShape","round",1,"login-form-button","login-form-margin",3,"hidden","click"],["nz-icon","","nzType","google","nzTheme","outline"],["nz-icon","","nzType","phone","nzTheme","outline"],["nz-icon","","nzType","mail","nzTheme","outline"]],template:function(s,o){s&1&&(g(0,"div",0)(1,"button",1),W("click",function(){return o.signInGoogle()}),A(2,"span",2),v(3," \u0423\u0432\u0456\u0439\u0442\u0438 \u0437 Google Account "),_(),g(4,"button",1),W("click",function(){return o.signInPhone()}),A(5,"span",3),v(6," \u0423\u0432\u0456\u0439\u0442\u0438 \u0437 \u043D\u043E\u043C\u0435\u0440\u043E\u043C \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0443 "),_(),g(7,"button",1),W("click",function(){return o.signInEmail()}),A(8,"span",4),v(9," \u0423\u0432\u0456\u0439\u0442\u0438 \u0437 \u0435\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u044E \u043F\u043E\u0447\u0442\u043E\u044E "),_()()),s&2&&(m(1),w("hidden",!o.currentButton("google")),m(3),w("hidden",!o.currentButton("phone")),m(3),w("hidden",!o.currentButton("email")))},dependencies:[$e,fe,je,He,Ge,Qc],encapsulation:2});let t=e;return t})();function Bm(t,e){t&1&&v(0," The input is not valid E-mail! ")}function Lm(t,e){t&1&&v(0," Please input your E-mail! ")}function zm(t,e){if(t&1&&V(0,Bm,1,0)(1,Lm,1,0),t&2){let n=e.$implicit;J(0,n.errors!=null&&n.errors.email?0:-1),m(1),J(1,n.errors!=null&&n.errors.required?1:-1)}}function Vm(t,e){t&1&&v(0," MaxLength is 40 ")}function Um(t,e){t&1&&v(0," MinLength is 6 ")}function $m(t,e){t&1&&v(0," Password is required ")}function Hm(t,e){if(t&1&&V(0,Vm,1,0)(1,Um,1,0)(2,$m,1,0),t&2){let n=e.$implicit;J(0,n.errors!=null&&n.errors.maxlength?0:-1),m(1),J(1,n.errors!=null&&n.errors.minlength?1:-1),m(1),J(2,n.errors!=null&&n.errors.required?2:-1)}}var Xu=(()=>{let e=class e{constructor(i,s){this.fb=i,this.router=s,this._signIn=b(zt),this.buttonsLogin=["google","phone"],this.isLoginFailed=!1,this.errorMessage="",this.validateForm=this.fb.group({email:["",[Z.required,Z.email]],password:["",Z.required],remember:[!1]})}ngOnInit(){}submitForm(){this.validateForm.valid?console.log(this.validateForm.value):Object.values(this.validateForm.controls).forEach(i=>{i.invalid&&(i.markAsDirty(),i.updateValueAndValidity({onlySelf:!0}))})}signInGoogle(){this._signIn.signInWithGoogle()}signInPhone(){this.router.navigate(["phone"])}};e.\u0275fac=function(s){return new(s||e)(xe(Pt),xe(pe))},e.\u0275cmp=B({type:e,selectors:[["app-login"]],standalone:!0,features:[L],decls:34,vars:7,consts:[["nz-row","","nzJustify","center",1,"row2"],["nz-col","",1,"section-heading",3,"nzSpan"],["nz-col","","nzSpan","20",1,"section-title"],["nz-col","","nzXs","20","nzSm","20","nzMd","10","nzLg","10","nzXl","10"],["nz-form","",1,"login-form",3,"formGroup","ngSubmit"],["nzHasFeedback","",3,"nzErrorTip"],["nzPrefixIcon","user"],["nz-input","","formControlName","email","placeholder","E-mail","id","email","type","email"],["emailErrorTpl",""],["nzPrefixIcon","lock"],["nz-input","","minlength","6","maxlength","12","placeholder","Password","formControlName","password","id","password"],["passwordErrorTpl",""],["nz-row","",1,"login-form-margin"],["nz-col","",3,"nzSpan"],["nz-checkbox","","formControlName","remember"],[1,"login-form-forgot"],["nz-button","","nzType","primary",1,"login-form-button","login-form-margin"],["routerLink","/register"],[3,"buttons"]],template:function(s,o){if(s&1&&(g(0,"app-layout")(1,"div",0)(2,"div",1)(3,"h2",2),v(4,"\u0412\u0445\u0456\u0434"),_()(),g(5,"div",3)(6,"form",4),W("ngSubmit",function(){return o.submitForm()}),g(7,"nz-form-item")(8,"nz-form-control",5)(9,"nz-input-group",6),A(10,"input",7),V(11,zm,2,2,"ng-template",null,8,we),_()()(),g(13,"nz-form-item")(14,"nz-form-control",5)(15,"nz-input-group",9),A(16,"input",10),V(17,Hm,3,3,"ng-template",null,11,we),_()()(),g(19,"div",12)(20,"div",13)(21,"label",14)(22,"span"),v(23," \u0417\u0430\u043F\u043E\u043C\u043D\u0438\u0442\u0438 \u043C\u0435\u043D\u0435"),_()()(),g(24,"div",13)(25,"a",15),v(26,"\u0417\u0430\u0431\u0443\u0432 \u043F\u0430\u0440\u043E\u043B\u044C?"),_()()(),g(27,"button",16),v(28," \u0423\u0432\u0456\u0439\u0442\u0438 "),_(),v(29," \u0430\u0431\u043E "),g(30,"a",17),v(31,"\u0437\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u0443\u0432\u0430\u0442\u0438\u0441\u044C!"),_()()(),g(32,"div",3),A(33,"button-login",18),_()()()),s&2){let r=be(12),a=be(18);m(2),w("nzSpan",20),m(4),w("formGroup",o.validateForm),m(2),w("nzErrorTip",r),m(6),w("nzErrorTip",a),m(6),w("nzSpan",12),m(4),w("nzSpan",12),m(9),w("buttons",o.buttonsLogin)}},dependencies:[re,vn,gn,xt,yn,ps,fs,bn,wn,je,He,Ge,uu,oe,se,Sn,En,Dn,Tn,Cn,kn,hs,Ke]});let t=e;return t})();function jm(t,e){t&1&&v(0," The input is not valid firstName! ")}function Wm(t,e){t&1&&v(0," Please input your firstName! ")}function Km(t,e){if(t&1&&V(0,jm,1,0)(1,Wm,1,0),t&2){let n=e.$implicit;J(0,n.errors!=null&&n.errors.firstName?0:-1),m(1),J(1,n.errors!=null&&n.errors.required?1:-1)}}function qm(t,e){t&1&&v(0," The input is not valid E-mail! ")}function Ym(t,e){t&1&&v(0," Please input your E-mail! ")}function Qm(t,e){if(t&1&&V(0,qm,1,0)(1,Ym,1,0),t&2){let n=e.$implicit;J(0,n.errors!=null&&n.errors.email?0:-1),m(1),J(1,n.errors!=null&&n.errors.required?1:-1)}}function Jm(t,e){t&1&&v(0," MaxLength is 40 ")}function Xm(t,e){t&1&&v(0," MinLength is 6 ")}function Zm(t,e){t&1&&v(0," Password is required ")}function e_(t,e){if(t&1&&V(0,Jm,1,0)(1,Xm,1,0)(2,Zm,1,0),t&2){let n=e.$implicit;J(0,n.errors!=null&&n.errors.maxlength?0:-1),m(1),J(1,n.errors!=null&&n.errors.minlength?1:-1),m(1),J(2,n.errors!=null&&n.errors.required?2:-1)}}var Zu=(()=>{let e=class e{constructor(i,s,o){this._storage=i,this.fb=s,this.router=o,this.signService=b(zt),this.authService=b(dt),this.buttonsLogin=["email","google","phone"],this.validateForm=this.fb.group({firstName:["",Z.required],email:["",[Z.required,Z.email]],password:["",Z.required]})}submitForm(){this.validateForm.valid?(console.log(this.validateForm.value),this.signService.register(this.validateForm.value.firstName,this.validateForm.value.email,this.validateForm.value.password)):Object.values(this.validateForm.controls).forEach(i=>{i.invalid&&(i.markAsDirty(),i.updateValueAndValidity({onlySelf:!0}))})}};e.\u0275fac=function(s){return new(s||e)(xe(ht),xe(Pt),xe(pe))},e.\u0275cmp=B({type:e,selectors:[["app-register"]],standalone:!0,features:[L],decls:29,vars:6,consts:[["nz-row","","nzJustify","center",1,"row2"],["nz-col","",1,"section-heading",3,"nzSpan"],["nz-col","","nzSpan","20",1,"section-title"],["nz-col","","nzXs","20","nzSm","20","nzMd","10","nzLg","10","nzXl","10"],["nz-form","",1,"login-form",3,"formGroup","ngSubmit"],["nzHasFeedback","",3,"nzErrorTip"],["nzPrefixIcon","user"],["nz-input","","formControlName","firstName","placeholder","\u0412\u0430\u0448\u0435 \u0456\u043C'\u044F","id","firstName","type","firstName"],["firstNameErrorTpl",""],["nzPrefixIcon","mail"],["nz-input","","formControlName","email","placeholder","E-mail","id","email","type","email"],["emailErrorTpl",""],["nzPrefixIcon","lock"],["nz-input","","minlength","6","maxlength","12","placeholder","\u041F\u0430\u0440\u043E\u043B\u044C","formControlName","password","id","password"],["passwordErrorTpl",""],["nz-button","","nzType","primary",1,"login-form-button","login-form-margin"],[3,"buttons"]],template:function(s,o){if(s&1&&(g(0,"app-layout")(1,"div",0)(2,"div",1)(3,"h2",2),v(4,"\u0420\u0435\u0454\u0441\u0442\u0440\u0430\u0446\u0456\u044F"),_()(),g(5,"div",3)(6,"form",4),W("ngSubmit",function(){return o.submitForm()}),g(7,"nz-form-item")(8,"nz-form-control",5)(9,"nz-input-group",6),A(10,"input",7),V(11,Km,2,2,"ng-template",null,8,we),_()()(),g(13,"nz-form-item")(14,"nz-form-control",5)(15,"nz-input-group",9),A(16,"input",10),V(17,Qm,2,2,"ng-template",null,11,we),_()()(),g(19,"nz-form-item")(20,"nz-form-control",5)(21,"nz-input-group",12),A(22,"input",13),V(23,e_,3,3,"ng-template",null,14,we),_()()(),g(25,"button",15),v(26," \u0423\u0432\u0456\u0439\u0442\u0438 "),_()()(),g(27,"div",3),A(28,"button-login",16),_()()()),s&2){let r=be(12),a=be(18),l=be(24);m(2),w("nzSpan",20),m(4),w("formGroup",o.validateForm),m(2),w("nzErrorTip",r),m(6),w("nzErrorTip",a),m(6),w("nzErrorTip",l),m(8),w("buttons",o.buttonsLogin)}},dependencies:[re,vn,gn,xt,yn,ps,fs,bn,wn,je,He,Ge,oe,se,Sn,En,Dn,Tn,Cn,kn,Ke],styles:["label[_ngcontent-%COMP%]{display:block;margin-top:10px}.card-container.card[_ngcontent-%COMP%]{max-width:400px!important;padding:40px}.card[_ngcontent-%COMP%]{background-color:#f7f7f7;padding:20px 25px 30px;margin:50px auto 25px;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;-moz-box-shadow:0px 2px 2px rgba(0,0,0,.3);-webkit-box-shadow:0px 2px 2px rgba(0,0,0,.3);box-shadow:0 2px 2px #0000004d}.profile-img-card[_ngcontent-%COMP%]{width:96px;height:96px;margin:0 auto 10px;display:block;-moz-border-radius:50%;-webkit-border-radius:50%;border-radius:50%}"]});let t=e;return t})();var mi=(()=>{let e=class e{constructor(){this.authService=b(dt),this.router=b(pe),this.localStorage=b(ht)}canActivate(i,s){return!0}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function t_(t,e){if(t&1&&(g(0,"nz-timeline-item",6)(1,"h4"),v(2),_(),g(3,"p"),v(4),_(),g(5,"p"),v(6),_()()),t&2){let n=e.$implicit,i=ve(2);w("nzColor",i.getTimelineColor(n)),m(2),he(i.formatDate(n.date)),m(2),Mc(" ",n.user.username," - ",n.user.email?n.user.email:null," ",n.user.email?n.user.phone:null," "),m(2),Rc(" ",n.barber==null?null:n.barber.name," -> ",n.service==null?null:n.service.title," ")}}function n_(t,e){if(t&1&&(g(0,"nz-timeline"),V(1,t_,7,7,"nz-timeline-item",5),_()),t&2){let n=ve();m(1),w("ngForOf",n.sort(n.calendarEvents()))}}var ed=(()=>{let e=class e{constructor(i,s){this.storage=i,this.fb=s,this.authService=b(dt),this.router=b(pe),this.currentUser$=ss(()=>this.authService.$user()),this._calendarService=b(Lt),this.calendarEvents=this._calendarService.$calendarEvents,this.validateForm=this.fb.group({email:["",[Z.required,Z.email]],password:["",Z.required],remember:[!1]})}ngOnInit(){}sort(i){return this.calendarEvents().sort((s,o)=>new Date(s.date).getTime()-new Date(o.date).getTime()),this.calendarEvents().filter(s=>s.user.email==this.authService.$user()?.email)}ngOnDestroy(){}getCellWithDate(i){return this._calendarService.getCalendarEventsOfDate(i)}getTimelineColor(i){return new Date(i.date).getTime()-new Date().getTime()<0?"red":"green"}deleteEvent(i){}formatDate(i){let s=new Date(i),o=new Date;return s.getDate()==o.getDate()?si(s,"h:mm"):si(s,"EEEE dd.MM h:mm",{locale:zu})}};e.\u0275fac=function(s){return new(s||e)(xe(ht),xe(Pt))},e.\u0275cmp=B({type:e,selectors:[["edit-user-app"]],standalone:!0,features:[L],decls:6,vars:3,consts:[["nz-row","",1,"row"],["nz-col","",3,"nzMd","nzXs"],[1,"stats-small","stats-small--1","card","card-small"],[1,"card-body","p-0","d-flex"],[4,"ngIf"],[3,"nzColor",4,"ngFor","ngForOf"],[3,"nzColor"]],template:function(s,o){s&1&&(g(0,"app-layout")(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3),V(5,n_,2,1,"nz-timeline",4),_()()()()()),s&2&&(m(2),w("nzMd",12)("nzXs",22),m(3),w("ngIf",o.calendarEvents()))},dependencies:[$e,_n,us,fe,oe,se,mu,_u,re,Ke],styles:[".login-form[_ngcontent-%COMP%]{max-width:300px}.login-form-margin[_ngcontent-%COMP%]{margin-bottom:16px}.login-form-forgot[_ngcontent-%COMP%]{float:right}.login-form-button[_ngcontent-%COMP%]{width:100%}"]});let t=e;return t})();function i_(t,e){t&1&&(g(0,"nz-select",20),A(1,"nz-option",21)(2,"nz-option",22),_())}function s_(t,e){t&1&&v(0," Use correct phone number use numbers [0-9] ")}function o_(t,e){if(t&1&&V(0,s_,1,0),t&2){let n=e.$implicit;J(0,n.errors!=null&&n.errors.pattern?0:-1)}}var td=(()=>{let e=class e{ngOnInit(){}getOTP(){this.applicationVerifier=this._signIn.reCaptcha(),console.log(this.applicationVerifier),this.isLoading=!0,this.newUser={phone:this.validateForm.value.phoneNumberPrefix+this.validateForm.value.phoneNumber,username:this.validateForm.value.name},this._signIn.signInWithPhone(this.applicationVerifier,this.newUser.phone).subscribe(i=>{this.verificationId=this._storage.get("verificationId"),this.confirmationResult=i,this.isLoading=!1,this.hideFirstStep=!0})}constructor(i){this.fb=i,this._signIn=b(zt),this._storage=b(ht),this._router=b(pe),this.isLoading=!1,this.hideFirstStep=!1,this.buttonsLogin=["google","email"],this.newUser={},this.validateForm=this.fb.group({name:["",Z.required],phoneNumber:["",[Z.required,Z.minLength(6),Z.maxLength(12),Z.pattern("[0-9]*")]],phoneNumberPrefix:"+420",verificationId:["",Z.required]})}submitForm(){if(this.validateForm.valid){let i=this._signIn.withCredentional(this.verificationId,this.validateForm.value.verificationId,this.newUser).then(()=>{this._router.navigate(["home"])});console.log(i)}else Object.values(this.validateForm.controls).forEach(i=>{i.invalid&&(i.markAsDirty(),i.updateValueAndValidity({onlySelf:!0}))})}};e.\u0275fac=function(s){return new(s||e)(xe(Pt))},e.\u0275cmp=B({type:e,selectors:[["app-phone"]],standalone:!0,features:[L],decls:33,vars:9,consts:[["nz-row","","nzJustify","space-around","nzAlign","middle",1,"row2"],["nz-col","",1,"section-heading",3,"nzSpan"],["nz-col","","nzSpan","20",1,"section-title"],["nz-col","","nzXs","20","nzSm","20","nzMd","10","nzLg","10","nzXl","10"],["nz-col","","nz-form","",1,"login-form",3,"formGroup","ngSubmit"],["nzErrorTip","\u041D\u0435 \u043C\u043E\u0436\u0435 \u0431\u0443\u0442\u0438 \u043F\u0443\u0441\u0442\u0438\u043C"],["for","name","nzSpan","22"],["nz-input","","formControlName","name","name","name","placeholder","Username","id","name"],["nzHasFeedback","",3,"nzErrorTip"],["nzSpan","22"],[3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["placeholder","000 000 000","formControlName","phoneNumber","id","phoneNumber","nz-input",""],["phoneErrorTpl",""],["nzType","info","nzMessage","\u041D\u0430 \u0432\u0430\u0448 \u043D\u043E\u043C\u0435\u0440 \u043D\u0430\u0434\u0456\u0439\u0434\u0435 \u043A\u043E\u0434 \u0434\u043B\u044F \u043F\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043D\u043D\u044F","nzShowIcon","",3,"hidden"],[3,"hidden"],["nz-input","","formControlName","verificationId","placeholder","Verification code","id","verificationId","type","text"],["nz-button","","nzType","primary",1,"login-form-button",3,"nzLoading","disabled","click"],["id","sign-in-button"],[3,"buttons"],["formControlName","phoneNumberPrefix","name","phoneNumberPrefix",1,"phone-select"],["nzLabel","+420","nzValue","+420"],["nzLabel","+380","nzValue","+380"]],template:function(s,o){if(s&1&&(g(0,"app-layout")(1,"div",0)(2,"div",1)(3,"h2",2),v(4,"\u0412\u0445\u0456\u0434"),_()(),g(5,"div",3)(6,"form",4),W("ngSubmit",function(){return o.submitForm()}),g(7,"nz-form-item")(8,"nz-form-control",5)(9,"nz-form-label",6),v(10,"\u0406\u043C'\u044F"),_(),A(11,"input",7),_()(),g(12,"nz-form-item")(13,"nz-form-control",8)(14,"nz-form-label",9),v(15,"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u0432\u0430\u0448 \u043D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0443"),_(),g(16,"nz-input-group",10),V(17,i_,3,0,"ng-template",null,11,we),A(19,"input",12),V(20,o_,1,1,"ng-template",null,13,we),_()()(),A(22,"nz-alert",14),g(23,"nz-form-item",15)(24,"nz-form-control")(25,"nz-form-label"),v(26,"\u0412\u0432\u0435\u0434\u0456\u0442\u044C \u043A\u043E\u0434 \u0437 \u0441\u043C\u0441 \u0442\u0443\u0442"),_(),A(27,"input",16),_()(),g(28,"button",17),W("click",function(){return o.hideFirstStep?o.submitForm:o.getOTP()}),v(29," \u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C "),_(),A(30,"div",18),_()(),g(31,"div",3),A(32,"button-login",19),_()()()),s&2){let r=be(18),a=be(21);m(2),w("nzSpan",20),m(4),w("formGroup",o.validateForm),m(7),w("nzErrorTip",a),m(3),w("nzAddOnBefore",r),m(6),w("hidden",!o.hideFirstStep),m(1),w("hidden",!o.hideFirstStep),m(5),w("nzLoading",o.isLoading)("disabled",o.validateForm.controls.phoneNumber.status=="INVALID"||(o.validateForm.controls.name.errors==null?null:o.validateForm.controls.name.errors.required)),m(4),w("buttons",o.buttonsLogin)}},dependencies:[re,vn,gn,xt,yn,bn,wn,Jc,je,He,Ge,oe,se,Sn,En,du,Dn,Tn,Cn,ru,au,kn,Ke]});let t=e;return t})();var nd=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-success"]],standalone:!0,features:[L],decls:6,vars:0,consts:[["nzStatus","success","nzTitle","Successfully Purchased Cloud Server ECS!","nzSubTitle","Order number: 2017182818828182881 Cloud server configuration takes 1-5 minutes, please wait."],["nz-result-extra",""],["nz-button","","nzType","primary"],["nz-button",""]],template:function(s,o){s&1&&(g(0,"nz-result",0)(1,"div",1)(2,"button",2),v(3,"Go Console"),_(),g(4,"button",3),v(5,"Buy Again"),_()()())},dependencies:[re,je,He,Ge,fu,pu]});let t=e;return t})();var id=[{title:"Home",path:"home",component:ir},{title:"About",path:"about",component:Is},{title:"Client",path:"clients",component:Rs},{title:"Reserve",path:"reserve",component:sr},{title:"Reserve",path:"reserve/:service",component:sr},{title:"Success",path:"success",component:nd},{title:"FireAdmin",path:"admin",loadChildren:()=>import("./chunk-GX3VFYHX.js").then(t=>t.AdminRoutingModule)},{title:"Feedback",path:"feedback",component:Os},{title:"Gallery",path:"gallery",component:Gu},{title:"Login",path:"login",component:Xu,canActivate:[mi],data:{role:"notLoggined"}},{title:"Register",path:"register",component:Zu,canActivate:[mi],data:{role:"notLoggined"}},{path:"phone",component:td,canActivate:[mi],data:{role:"notLoggined"}},{title:"Services",path:"services",component:ks},{title:"Profile",path:"user",component:ed,canActivate:[mi]},{title:"Home",path:"**",component:ir}];var r_="@",or=class{constructor(e,n,i,s,o){this.doc=e,this.delegate=n,this.zone=i,this.animationType=s,this.moduleImpl=o,this._rendererFactoryPromise=null}loadImpl(){return(this.moduleImpl??import("./chunk-6PZ73U4E.js")).catch(n=>{throw new vc(5300,!1)}).then(({\u0275createEngine:n,\u0275AnimationRendererFactory:i})=>{let s=n(this.animationType,this.doc),o=new i(this.delegate,s,this.zone);return this.delegate=o,o})}createRenderer(e,n){let i=this.delegate.createRenderer(e,n);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let s=new rr(i);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let r=o.createRenderer(e,n);s.use(r)}).catch(o=>{s.use(i)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}},rr=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let n of this.replay)n(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,n){this.delegate.appendChild(e,n)}insertBefore(e,n,i,s){this.delegate.insertBefore(e,n,i,s)}removeChild(e,n,i){this.delegate.removeChild(e,n,i)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,i,s){this.delegate.setAttribute(e,n,i,s)}removeAttribute(e,n,i){this.delegate.removeAttribute(e,n,i)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,i,s){this.delegate.setStyle(e,n,i,s)}removeStyle(e,n,i){this.delegate.removeStyle(e,n,i)}setProperty(e,n,i){this.shouldReplay(n)&&this.replay.push(s=>s.setProperty(e,n,i)),this.delegate.setProperty(e,n,i)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,i){return this.shouldReplay(n)&&this.replay.push(s=>s.listen(e,n,i)),this.delegate.listen(e,n,i)}shouldReplay(e){return this.replay!==null&&e.startsWith(r_)}};function sd(t="animations"){return bc([{provide:Cc,useFactory:(e,n,i)=>new or(e,n,i,t),deps:[mn,Lc,j]},{provide:wc,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var As="analytics",a_="firebase_id",l_="origin",c_=60*1e3,u_="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",pr="https://www.googletagmanager.com/gtag/js";var Ee=new Bt("@firebase/analytics");var d_={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Pe=new Rn("analytics","Analytics",d_);function h_(t){if(!t.startsWith(pr)){let e=Pe.create("invalid-gtag-resource",{gtagURL:t});return Ee.warn(e.message),""}return t}function dd(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function p_(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function f_(t,e){let n=p_("firebase-js-sdk-policy",{createScriptURL:h_}),i=document.createElement("script"),s=`${pr}?l=${t}&id=${e}`;i.src=n?n?.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function m_(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}function __(t,e,n,i,s,o){return T(this,null,function*(){let r=i[s];try{if(r)yield e[r];else{let l=(yield dd(n)).find(c=>c.measurementId===s);l&&(yield e[l.appId])}}catch(a){Ee.error(a)}t("config",s,o)})}function g_(t,e,n,i,s){return T(this,null,function*(){try{let o=[];if(s&&s.send_to){let r=s.send_to;Array.isArray(r)||(r=[r]);let a=yield dd(n);for(let l of r){let c=a.find(d=>d.measurementId===l),u=c&&e[c.appId];if(u)o.push(u);else{o=[];break}}}o.length===0&&(o=Object.values(e)),yield Promise.all(o),t("event",i,s||{})}catch(o){Ee.error(o)}})}function y_(t,e,n,i){function s(o,...r){return T(this,null,function*(){try{if(o==="event"){let[a,l]=r;yield g_(t,e,n,a,l)}else if(o==="config"){let[a,l]=r;yield __(t,e,n,i,a,l)}else if(o==="consent"){let[a]=r;t("consent","update",a)}else if(o==="get"){let[a,l,c]=r;t("get",a,l,c)}else if(o==="set"){let[a]=r;t("set",a)}else t(o,...r)}catch(a){Ee.error(a)}})}return s}function v_(t,e,n,i,s){let o=function(...r){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=y_(o,t,e,n),{gtagCore:o,wrappedGtag:window[s]}}function b_(t){let e=window.document.getElementsByTagName("script");for(let n of Object.values(e))if(n.src&&n.src.includes(pr)&&n.src.includes(t))return n;return null}var w_=30,T_=1e3,lr=class{constructor(e={},n=T_){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}},hd=new lr;function C_(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function E_(t){return T(this,null,function*(){var e;let{appId:n,apiKey:i}=t,s={method:"GET",headers:C_(i)},o=u_.replace("{app-id}",n),r=yield fetch(o,s);if(r.status!==200&&r.status!==304){let a="";try{let l=yield r.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Pe.create("config-fetch-failed",{httpStatus:r.status,responseMessage:a})}return r.json()})}function S_(i){return T(this,arguments,function*(t,e=hd,n){let{appId:s,apiKey:o,measurementId:r}=t.options;if(!s)throw Pe.create("no-app-id");if(!o){if(r)return{measurementId:r,appId:s};throw Pe.create("no-api-key")}let a=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},l=new cr;return setTimeout(()=>T(this,null,function*(){l.abort()}),n!==void 0?n:c_),pd({appId:s,apiKey:o,measurementId:r},a,l,e)})}function pd(o,r,a){return T(this,arguments,function*(t,{throttleEndTimeMillis:e,backoffCount:n},i,s=hd){var l;let{appId:c,measurementId:u}=t;try{yield D_(i,e)}catch(d){if(u)return Ee.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${d?.message}]`),{appId:c,measurementId:u};throw d}try{let d=yield E_(t);return s.deleteThrottleMetadata(c),d}catch(d){let h=d;if(!I_(h)){if(s.deleteThrottleMetadata(c),u)return Ee.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${u} provided in the "measurementId" field in the local Firebase config. [${h?.message}]`),{appId:c,measurementId:u};throw d}let p=Number((l=h?.customData)===null||l===void 0?void 0:l.httpStatus)===503?bs(n,s.intervalMillis,w_):bs(n,s.intervalMillis),y={throttleEndTimeMillis:Date.now()+p,backoffCount:n+1};return s.setThrottleMetadata(c,y),Ee.debug(`Calling attemptFetch again in ${p} millis`),pd(t,y,i,s)}})}function D_(t,e){return new Promise((n,i)=>{let s=Math.max(e-Date.now(),0),o=setTimeout(n,s);t.addEventListener(()=>{clearTimeout(o),i(Pe.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function I_(t){if(!(t instanceof li)||!t.customData)return!1;let e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}var cr=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}};var ur;function R_(t,e,n,i,s){return T(this,null,function*(){if(s&&s.global){t("event",n,i);return}else{let o=yield e,r=Object.assign(Object.assign({},i),{send_to:o});t("event",n,r)}})}function M_(t,e,n,i){return T(this,null,function*(){if(i&&i.global)return t("set",{user_id:n}),Promise.resolve();{let s=yield e;t("config",s,{update:!0,user_id:n})}})}var dr;function k_(t){dr=t}function O_(t){ur=t}function N_(){return T(this,null,function*(){if(Xt())try{yield ri()}catch(t){return Ee.warn(Pe.create("indexeddb-unavailable",{errorInfo:t?.toString()}).message),!1}else return Ee.warn(Pe.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0})}function A_(t,e,n,i,s,o,r){return T(this,null,function*(){var a;let l=S_(t);l.then(p=>{n[p.measurementId]=p.appId,t.options.measurementId&&p.measurementId!==t.options.measurementId&&Ee.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>Ee.error(p)),e.push(l);let c=N_().then(p=>{if(p)return i.getId()}),[u,d]=yield Promise.all([l,c]);b_(o)||f_(o,u.measurementId),dr&&(s("consent","default",dr),k_(void 0)),s("js",new Date);let h=(a=r?.config)!==null&&a!==void 0?a:{};return h[l_]="firebase",h.update=!0,d!=null&&(h[a_]=d),s("config",u.measurementId,h),ur&&(s("set",ur),O_(void 0)),u.measurementId})}var hr=class{constructor(e){this.app=e}_delete(){return delete On[this.app.options.appId],Promise.resolve()}},On={},od=[],rd={},ar="dataLayer",x_="gtag",ad,fr,ld=!1;function P_(){let t=[];if(Zo()&&t.push("This is a browser extension environment."),ai()||t.push("Cookies are not available."),t.length>0){let e=t.map((i,s)=>`(${s+1}) ${i}`).join(" "),n=Pe.create("invalid-analytics-context",{errorInfo:e});Ee.warn(n.message)}}function F_(t,e,n){P_();let i=t.options.appId;if(!i)throw Pe.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Ee.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Pe.create("no-api-key");if(On[i]!=null)throw Pe.create("already-exists",{id:i});if(!ld){m_(ar);let{wrappedGtag:o,gtagCore:r}=v_(On,od,rd,ar,x_);fr=o,ad=r,ld=!0}return On[i]=A_(t,od,rd,e,ad,ar,n),new hr(t)}function mr(t=rt()){t=$(t);let e=Xe(t,As);return e.isInitialized()?e.getImmediate():fd(t)}function fd(t,e={}){let n=Xe(t,As);if(n.isInitialized()){let s=n.getImmediate();if(Cu(e,n.getOptions()))return s;throw Pe.create("already-initialized")}return n.initialize({options:e})}function md(){return T(this,null,function*(){if(Zo()||!ai()||!Xt())return!1;try{return yield ri()}catch{return!1}})}function _d(t,e,n){t=$(t),M_(fr,On[t.app.options.appId],e,n).catch(i=>Ee.error(i))}function _r(t,e,n,i){t=$(t),R_(fr,On[t.app.options.appId],e,n,i).catch(s=>Ee.error(s))}var cd="@firebase/analytics",ud="0.10.2";function B_(){Te(new ne(As,(e,{options:n})=>{let i=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return F_(i,s,n)},"PUBLIC")),Te(new ne("analytics-internal",t,"PRIVATE")),z(cd,ud),z(cd,ud,"esm2017");function t(e){try{let n=e.getProvider(As).getImmediate();return{logEvent:(i,s,o)=>_r(n,i,s,o)}}catch(n){throw Pe.create("interop-component-reg-failed",{reason:n})}}}B_();var vd="functions";var gr=class{constructor(e,n,i){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i.get().then(s=>this.appCheck=s,()=>{})}getAuthToken(){return T(this,null,function*(){if(this.auth)try{let e=yield this.auth.getToken();return e?.accessToken}catch{return}})}getMessagingToken(){return T(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(e){return T(this,null,function*(){if(this.appCheck){let n=e?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return n.error?null:n.token}return null})}getContext(e){return T(this,null,function*(){let n=yield this.getAuthToken(),i=yield this.getMessagingToken(),s=yield this.getAppCheckToken(e);return{authToken:n,messagingToken:i,appCheckToken:s}})}};var yr="us-central1";var vr=class{constructor(e,n,i,s,o=yr,r){this.app=e,this.fetchImpl=r,this.emulatorOrigin=null,this.contextProvider=new gr(n,i,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{let a=new URL(o);this.customDomain=a.origin,this.region=yr}catch{this.customDomain=null,this.region=o}}_delete(){return this.deleteService()}_url(e){let n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}};function L_(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}var gd="@firebase/functions",yd="0.11.3";var z_="auth-internal",V_="app-check-internal",U_="messaging-internal";function $_(t,e){let n=(i,{instanceIdentifier:s})=>{let o=i.getProvider("app").getImmediate(),r=i.getProvider(z_),a=i.getProvider(U_),l=i.getProvider(V_);return new vr(o,r,a,l,s,t)};Te(new ne(vd,n,"PUBLIC").setMultipleInstances(!0)),z(gd,yd,e),z(gd,yd,"esm2017")}function bd(t=rt(),e=yr){let i=Xe($(t),vd).getImmediate({identifier:e}),s=oi("functions");return s&&wd(i,...s),i}function wd(t,e,n){L_($(t),e,n)}$_(fetch.bind(self));var _i=class{constructor(e){return e}},Td="functions",br=class{constructor(){return lt(Td)}};var wr=new G("angularfire2.functions-instances");function H_(t,e){let n=at(Td,t,e);return n&&new _i(n)}function G_(t){return(e,n)=>{let i=e.runOutsideAngular(()=>t(n));return new _i(i)}}var j_={provide:br,deps:[[new X,wr]]},W_={provide:_i,useFactory:H_,deps:[[new X,wr],ct]},K_=(()=>{class t{constructor(){z("angularfire",Ce.full,"fn")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=N({type:t});static \u0275inj=O({providers:[W_,j_]})}return t})();function Cd(t,...e){return{ngModule:K_,providers:[{provide:wr,useFactory:G_(t),multi:!0,deps:[j,de,Ne,ut,[new X,Ss],[new X,It],...e]}]}}var Ed=Ze(bd,!0);var q_="/firebase-messaging-sw.js",Y_="/firebase-cloud-messaging-push-scope",kd="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Q_="https://fcmregistrations.googleapis.com/v1",Od="google.c.a.c_id",J_="google.c.a.c_l",X_="google.c.a.ts",Z_="google.c.a.e";var xs=function(t){return t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked",t}(xs||{});function Mt(t){let e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function eg(t){let e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),i=atob(n),s=new Uint8Array(i.length);for(let o=0;o<i.length;++o)s[o]=i.charCodeAt(o);return s}var Tr="fcm_token_details_db",tg=5,Sd="fcm_token_object_Store";function ng(t){return T(this,null,function*(){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(o=>o.name).includes(Tr))return null;let e=null;return(yield nr(Tr,tg,{upgrade:(i,s,o,r)=>T(this,null,function*(){var a;if(s<2||!i.objectStoreNames.contains(Sd))return;let l=r.objectStore(Sd),c=yield l.index("fcmSenderId").get(t);if(yield l.clear(),!!c){if(s===2){let u=c;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:Mt(u.vapidKey)}}}else if(s===3){let u=c;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Mt(u.auth),p256dh:Mt(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Mt(u.vapidKey)}}}else if(s===4){let u=c;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:Mt(u.auth),p256dh:Mt(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:Mt(u.vapidKey)}}}}})})).close(),yield Ts(Tr),yield Ts("fcm_vapid_details_db"),yield Ts("undefined"),ig(e)?e:null})}function ig(t){if(!t||!t.subscriptionOptions)return!1;let{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}var sg="firebase-messaging-database",og=1,Zt="firebase-messaging-store",Cr=null;function Dr(){return Cr||(Cr=nr(sg,og,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Zt)}}})),Cr}function Nd(t){return T(this,null,function*(){let e=Rr(t),i=yield(yield Dr()).transaction(Zt).objectStore(Zt).get(e);if(i)return i;{let s=yield ng(t.appConfig.senderId);if(s)return yield Ir(t,s),s}})}function Ir(t,e){return T(this,null,function*(){let n=Rr(t),s=(yield Dr()).transaction(Zt,"readwrite");return yield s.objectStore(Zt).put(e,n),yield s.done,e})}function rg(t){return T(this,null,function*(){let e=Rr(t),i=(yield Dr()).transaction(Zt,"readwrite");yield i.objectStore(Zt).delete(e),yield i.done})}function Rr({appConfig:t}){return t.appId}var ag={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Se=new Rn("messaging","Messaging",ag);function lg(t,e){return T(this,null,function*(){let n=yield kr(t),i=xd(e),s={method:"POST",headers:n,body:JSON.stringify(i)},o;try{o=yield(yield fetch(Mr(t.appConfig),s)).json()}catch(r){throw Se.create("token-subscribe-failed",{errorInfo:r?.toString()})}if(o.error){let r=o.error.message;throw Se.create("token-subscribe-failed",{errorInfo:r})}if(!o.token)throw Se.create("token-subscribe-no-token");return o.token})}function cg(t,e){return T(this,null,function*(){let n=yield kr(t),i=xd(e.subscriptionOptions),s={method:"PATCH",headers:n,body:JSON.stringify(i)},o;try{o=yield(yield fetch(`${Mr(t.appConfig)}/${e.token}`,s)).json()}catch(r){throw Se.create("token-update-failed",{errorInfo:r?.toString()})}if(o.error){let r=o.error.message;throw Se.create("token-update-failed",{errorInfo:r})}if(!o.token)throw Se.create("token-update-no-token");return o.token})}function Ad(t,e){return T(this,null,function*(){let i={method:"DELETE",headers:yield kr(t)};try{let o=yield(yield fetch(`${Mr(t.appConfig)}/${e}`,i)).json();if(o.error){let r=o.error.message;throw Se.create("token-unsubscribe-failed",{errorInfo:r})}}catch(s){throw Se.create("token-unsubscribe-failed",{errorInfo:s?.toString()})}})}function Mr({projectId:t}){return`${Q_}/projects/${t}/registrations`}function kr(n){return T(this,arguments,function*({appConfig:t,installations:e}){let i=yield e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${i}`})})}function xd({p256dh:t,auth:e,endpoint:n,vapidKey:i}){let s={web:{endpoint:n,auth:e,p256dh:t}};return i!==kd&&(s.web.applicationPubKey=i),s}var ug=7*24*60*60*1e3;function dg(t){return T(this,null,function*(){let e=yield fg(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:Mt(e.getKey("auth")),p256dh:Mt(e.getKey("p256dh"))},i=yield Nd(t.firebaseDependencies);if(i){if(mg(i.subscriptionOptions,n))return Date.now()>=i.createTime+ug?pg(t,{token:i.token,createTime:Date.now(),subscriptionOptions:n}):i.token;try{yield Ad(t.firebaseDependencies,i.token)}catch(s){console.warn(s)}return Dd(t.firebaseDependencies,n)}else return Dd(t.firebaseDependencies,n)})}function hg(t){return T(this,null,function*(){let e=yield Nd(t.firebaseDependencies);e&&(yield Ad(t.firebaseDependencies,e.token),yield rg(t.firebaseDependencies));let n=yield t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0})}function pg(t,e){return T(this,null,function*(){try{let n=yield cg(t.firebaseDependencies,e),i=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return yield Ir(t.firebaseDependencies,i),n}catch(n){throw yield hg(t),n}})}function Dd(t,e){return T(this,null,function*(){let i={token:yield lg(t,e),createTime:Date.now(),subscriptionOptions:e};return yield Ir(t,i),i.token})}function fg(t,e){return T(this,null,function*(){let n=yield t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:eg(e)})})}function mg(t,e){let n=e.vapidKey===t.vapidKey,i=e.endpoint===t.endpoint,s=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&i&&s&&o}function Id(t){let e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return _g(e,t),gg(e,t),yg(e,t),e}function _g(t,e){if(!e.notification)return;t.notification={};let n=e.notification.title;n&&(t.notification.title=n);let i=e.notification.body;i&&(t.notification.body=i);let s=e.notification.image;s&&(t.notification.image=s);let o=e.notification.icon;o&&(t.notification.icon=o)}function gg(t,e){e.data&&(t.data=e.data)}function yg(t,e){var n,i,s,o,r;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};let a=(s=(i=e.fcmOptions)===null||i===void 0?void 0:i.link)!==null&&s!==void 0?s:(o=e.notification)===null||o===void 0?void 0:o.click_action;a&&(t.fcmOptions.link=a);let l=(r=e.fcmOptions)===null||r===void 0?void 0:r.analytics_label;l&&(t.fcmOptions.analyticsLabel=l)}function vg(t){return typeof t=="object"&&!!t&&Od in t}Pd("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");Pd("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function Pd(t,e){let n=[];for(let i=0;i<t.length;i++)n.push(t.charAt(i)),i<e.length&&n.push(e.charAt(i));return n.join("")}function bg(t){if(!t||!t.options)throw Er("App Configuration Object");if(!t.name)throw Er("App Name");let e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(let i of e)if(!n[i])throw Er(i);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Er(t){return Se.create("missing-app-config-values",{valueName:t})}var Sr=class{constructor(e,n,i){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;let s=bg(e);this.firebaseDependencies={app:e,appConfig:s,installations:n,analyticsProvider:i}}_delete(){return Promise.resolve()}};function wg(t){return T(this,null,function*(){try{t.swRegistration=yield navigator.serviceWorker.register(q_,{scope:Y_}),t.swRegistration.update().catch(()=>{})}catch(e){throw Se.create("failed-service-worker-registration",{browserErrorMessage:e?.message})}})}function Tg(t,e){return T(this,null,function*(){if(!e&&!t.swRegistration&&(yield wg(t)),!(!e&&t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw Se.create("invalid-sw-registration");t.swRegistration=e}})}function Cg(t,e){return T(this,null,function*(){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=kd)})}function Eg(t,e){return T(this,null,function*(){if(!navigator)throw Se.create("only-available-in-window");if(Notification.permission==="default"&&(yield Notification.requestPermission()),Notification.permission!=="granted")throw Se.create("permission-blocked");return yield Cg(t,e?.vapidKey),yield Tg(t,e?.serviceWorkerRegistration),dg(t)})}function Sg(t,e,n){return T(this,null,function*(){let i=Dg(e);(yield t.firebaseDependencies.analyticsProvider.get()).logEvent(i,{message_id:n[Od],message_name:n[J_],message_time:n[X_],message_device_time:Math.floor(Date.now()/1e3)})})}function Dg(t){switch(t){case xs.NOTIFICATION_CLICKED:return"notification_open";case xs.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Ig(t,e){return T(this,null,function*(){let n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===xs.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(Id(n)):t.onMessageHandler.next(Id(n)));let i=n.data;vg(i)&&i[Z_]==="1"&&(yield Sg(t,n.messageType,i))})}var Rd="@firebase/messaging",Md="0.12.7";var Rg=t=>{let e=new Sr(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>Ig(e,n)),e},Mg=t=>{let e=t.getProvider("messaging").getImmediate();return{getToken:i=>Eg(e,i)}};function kg(){Te(new ne("messaging",Rg,"PUBLIC")),Te(new ne("messaging-internal",Mg,"PRIVATE")),z(Rd,Md),z(Rd,Md,"esm2017")}function Or(){return T(this,null,function*(){try{yield ri()}catch{return!1}return typeof window<"u"&&Xt()&&ai()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})}function Fd(t=rt()){return Or().then(e=>{if(!e)throw Se.create("unsupported-browser")},e=>{throw Se.create("indexed-db-unsupported")}),Xe($(t),"messaging").getImmediate()}kg();var gi=class{constructor(e){return e}},Bd="messaging",Nr=class{constructor(){return lt(Bd)}};var Ld="__angularfire_symbol__messagingIsSupported",Ar="__angularfire_symbol__messagingIsSupportedValue";globalThis[Ld]||=Or().then(t=>globalThis[Ar]=t).catch(()=>globalThis[Ar]=!1);var Ps={async:()=>globalThis[Ld],sync:()=>{let t=globalThis[Ar];if(t===void 0)throw new Error(Es("Messaging"));return t}},xr=new G("angularfire2.messaging-instances");function Og(t,e){if(!Ps.sync())return null;let n=at(Bd,t,e);return n&&new gi(n)}function Ng(t){return(e,n)=>{if(!Ps.sync())return null;let i=e.runOutsideAngular(()=>t(n));return new gi(i)}}var Ag={provide:Nr,deps:[[new X,xr]]},xg={provide:gi,useFactory:Og,deps:[[new X,xr],ct]},Pg=(()=>{class t{constructor(){z("angularfire",Ce.full,"fcm")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=N({type:t});static \u0275inj=O({providers:[xg,Ag,{provide:as,useValue:Ps.async,multi:!0}]})}return t})();function zd(t,...e){return{ngModule:Pg,providers:[{provide:xr,useFactory:Ng(t),multi:!0,deps:[j,de,Ne,ut,...e]}]}}var NE=Ps.async;var Vd=Ze(Fd,!0);var yi=class{constructor(e){return e}},Ud="performance",Pr=class{constructor(){return lt(Ud)}};var Fr=new G("angularfire2.performance-instances");function Fg(t,e,n){if(!ds(n))return null;let i=at(Ud,t,e);return i&&new yi(i)}function Bg(t){return(e,n,i)=>{if(!ds(n))return null;let s=e.runOutsideAngular(()=>t(i));return new yi(s)}}var Lg={provide:Pr,deps:[[new X,Fr]]},zg={provide:yi,useFactory:Fg,deps:[[new X,Fr],ct,Tt]},Vg=(()=>{class t{constructor(){z("angularfire",Ce.full,"perf")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=N({type:t});static \u0275inj=O({providers:[zg,Lg]})}return t})();function $d(t,...e){return{ngModule:Vg,providers:[{provide:Fr,useFactory:Bg(t),multi:!0,deps:[j,Tt,de,Ne,ut,...e]}]}}var Hd=Ze(Vu,!0);var Yd="firebasestorage.googleapis.com",Ug="storageBucket",$g=2*60*1e3,Hg=10*60*1e3;var pt=class t extends li{constructor(e,n,i=0){super(Br(e),`Firebase Storage: ${n} (${Br(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,t.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Br(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},Ot=function(t){return t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment",t}(Ot||{});function Br(t){return"storage/"+t}function Gg(){let t="An unknown error occurred, please check the error payload for server response.";return new pt(Ot.UNKNOWN,t)}function jg(){return new pt(Ot.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Wg(){return new pt(Ot.CANCELED,"User canceled the upload/download.")}function Kg(t){return new pt(Ot.INVALID_URL,"Invalid URL '"+t+"'.")}function qg(t){return new pt(Ot.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Gd(t){return new pt(Ot.INVALID_ARGUMENT,t)}function Qd(){return new pt(Ot.APP_DELETED,"The Firebase app was deleted.")}function Yg(t){return new pt(Ot.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}var kt=class t{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let i;try{i=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(i.path==="")return i;throw qg(e)}static makeFromUrl(e,n){let i=null,s="([A-Za-z0-9.\\-_]+)";function o(q){q.path.charAt(q.path.length-1)==="/"&&(q.path_=q.path_.slice(0,-1))}let r="(/(.*))?$",a=new RegExp("^gs://"+s+r,"i"),l={bucket:1,path:3};function c(q){q.path_=decodeURIComponent(q.path)}let u="v[A-Za-z0-9_]+",d=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${d}/${u}/b/${s}/o${h}`,"i"),y={bucket:1,path:3},S=n===Yd?"(?:storage.googleapis.com|storage.cloud.google.com)":n,I="([^?#]*)",ie=new RegExp(`^https?://${S}/${s}/${I}`,"i"),x=[{regex:a,indices:l,postModify:o},{regex:p,indices:y,postModify:c},{regex:ie,indices:{bucket:1,path:2},postModify:c}];for(let q=0;q<x.length;q++){let Ve=x[q],Bo=Ve.regex.exec(e);if(Bo){let Cm=Bo[Ve.indices.bucket],Lo=Bo[Ve.indices.path];Lo||(Lo=""),i=new t(Cm,Lo),Ve.postModify(i);break}}if(i==null)throw Kg(e);return i}},Lr=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function Qg(t,e,n){let i=1,s=null,o=null,r=!1,a=0;function l(){return a===2}let c=!1;function u(...I){c||(c=!0,e.apply(null,I))}function d(I){s=setTimeout(()=>{s=null,t(p,l())},I)}function h(){o&&clearTimeout(o)}function p(I,...ie){if(c){h();return}if(I){h(),u.call(null,I,...ie);return}if(l()||r){h(),u.call(null,I,...ie);return}i<64&&(i*=2);let x;a===1?(a=2,x=0):x=(i+Math.random())*1e3,d(x)}let y=!1;function S(I){y||(y=!0,h(),!c&&(s!==null?(I||(a=2),clearTimeout(s),d(0)):I||(a=1)))}return d(0),o=setTimeout(()=>{r=!0,S(!0)},n),S}function Jg(t){t(!1)}function Xg(t){return t!==void 0}function jd(t,e,n,i){if(i<e)throw Gd(`Invalid value for '${t}'. Expected ${e} or greater.`);if(i>n)throw Gd(`Invalid value for '${t}'. Expected ${n} or less.`)}function Zg(t){let e=encodeURIComponent,n="?";for(let i in t)if(t.hasOwnProperty(i)){let s=e(i)+"="+e(t[i]);n=n+s+"&"}return n=n.slice(0,-1),n}var zr=function(t){return t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT",t}(zr||{});function e0(t,e){let n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||s||o}var Vr=class{constructor(e,n,i,s,o,r,a,l,c,u,d,h=!0){this.url_=e,this.method_=n,this.headers_=i,this.body_=s,this.successCodes_=o,this.additionalRetryCodes_=r,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=d,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,y)=>{this.resolve_=p,this.reject_=y,this.start_()})}start_(){let e=(i,s)=>{if(s){i(!1,new Nn(!1,null,!0));return}let o=this.connectionFactory_();this.pendingConnection_=o;let r=a=>{let l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&o.addUploadProgressListener(r),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(r),this.pendingConnection_=null;let a=o.getErrorCode()===zr.NO_ERROR,l=o.getStatus();if(!a||e0(l,this.additionalRetryCodes_)&&this.retry){let u=o.getErrorCode()===zr.ABORT;i(!1,new Nn(!1,null,u));return}let c=this.successCodes_.indexOf(l)!==-1;i(!0,new Nn(c,o))})},n=(i,s)=>{let o=this.resolve_,r=this.reject_,a=s.connection;if(s.wasSuccessCode)try{let l=this.callback_(a,a.getResponse());Xg(l)?o(l):o()}catch(l){r(l)}else if(a!==null){let l=Gg();l.serverResponse=a.getErrorText(),this.errorCallback_?r(this.errorCallback_(a,l)):r(l)}else if(s.canceled){let l=this.appDelete_?Qd():Wg();r(l)}else{let l=jg();r(l)}};this.canceled_?n(!1,new Nn(!1,null,!0)):this.backoffId_=Qg(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Jg(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Nn=class{constructor(e,n,i){this.wasSuccessCode=e,this.connection=n,this.canceled=!!i}};function t0(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function n0(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function i0(t,e){e&&(t["X-Firebase-GMPID"]=e)}function s0(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function o0(t,e,n,i,s,o,r=!0){let a=Zg(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return i0(c,e),t0(c,n),n0(c,o),s0(c,i),new Vr(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,r)}function r0(t){if(t.length===0)return null;let e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function a0(t){let e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}var YE=256*1024;var Ur=class t{constructor(e,n){this._service=e,n instanceof kt?this._location=n:this._location=kt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new t(e,n)}get root(){let e=new kt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return a0(this._location.path)}get storage(){return this._service}get parent(){let e=r0(this._location.path);if(e===null)return null;let n=new kt(this._location.bucket,e);return new t(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Yg(e)}};function Wd(t,e){let n=e?.[Ug];return n==null?null:kt.makeFromBucketSpec(n,t)}function l0(t,e,n,i={}){t.host=`${e}:${n}`,t._protocol="http";let{mockUserToken:s}=i;s&&(t._overrideAuthToken=typeof s=="string"?s:gs(s,t.app.options.projectId))}var $r=class{constructor(e,n,i,s,o){this.app=e,this._authProvider=n,this._appCheckProvider=i,this._url=s,this._firebaseVersion=o,this._bucket=null,this._host=Yd,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=$g,this._maxUploadRetryTime=Hg,this._requests=new Set,s!=null?this._bucket=kt.makeFromBucketSpec(s,this._host):this._bucket=Wd(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=kt.makeFromBucketSpec(this._url,e):this._bucket=Wd(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){jd("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){jd("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return T(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let n=yield e.getToken();if(n!==null)return n.accessToken}return null})}_getAppCheckToken(){return T(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ur(this,e)}_makeRequest(e,n,i,s,o=!0){if(this._deleted)return new Lr(Qd());{let r=o0(e,this._appId,i,s,n,this._firebaseVersion,o);return this._requests.add(r),r.getPromise().then(()=>this._requests.delete(r),()=>this._requests.delete(r)),r}}makeRequestWithTokens(e,n){return T(this,null,function*(){let[i,s]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,i,s).getPromise()})}},Kd="@firebase/storage",qd="0.12.3";var Jd="storage";function Xd(t=rt(),e){t=$(t);let i=Xe(t,Jd).getImmediate({identifier:e}),s=oi("storage");return s&&Zd(i,...s),i}function Zd(t,e,n,i={}){l0(t,e,n,i)}function c0(t,{instanceIdentifier:e}){let n=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new $r(n,i,s,e,Cs)}function u0(){Te(new ne(Jd,c0,"PUBLIC").setMultipleInstances(!0)),z(Kd,qd,""),z(Kd,qd,"esm2017")}u0();var vi=class{constructor(e){return e}},eh="storage",Hr=class{constructor(){return lt(eh)}};var Gr=new G("angularfire2.storage-instances");function d0(t,e){let n=at(eh,t,e);return n&&new vi(n)}function h0(t){return(e,n)=>{let i=e.runOutsideAngular(()=>t(n));return new vi(i)}}var p0={provide:Hr,deps:[[new X,Gr]]},f0={provide:vi,useFactory:d0,deps:[[new X,Gr],ct]},m0=(()=>{class t{constructor(){z("angularfire",Ce.full,"gcs")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=N({type:t});static \u0275inj=O({providers:[f0,p0]})}return t})();function th(t,...e){return{ngModule:m0,providers:[{provide:Gr,useFactory:h0(t),multi:!0,deps:[j,de,Ne,ut,[new X,Ss],[new X,It],...e]}]}}var nh=Ze(Xd,!0);var en=class{constructor(e){return e}},oh="analytics",Wr=class{constructor(){return lt(oh)}};var Kr="__angularfire_symbol__analyticsIsSupportedValue",rh="__angularfire_symbol__analyticsIsSupported";globalThis[rh]||=md().then(t=>globalThis[Kr]=t).catch(()=>globalThis[Kr]=!1);var Fs={async:()=>globalThis[rh],sync:()=>{let t=globalThis[Kr];if(t===void 0)throw new Error(Es("Analytics"));return t}},ah=Fs.async;var _0=Ze(_r,!0);var g0=Ze(_d,!0);var lh=(()=>{class t{initialized;disposables=[];constructor(n,i,s){z("angularfire",Ce.full,"user-tracking");let o;this.initialized=i.runOutsideAngular(()=>new Promise(r=>{o=r})),ah().then(()=>{let r=s.get(en);r?this.disposables=[Nu(n).subscribe(a=>{g0(r,a?.uid),o()})]:o()})}ngOnDestroy(){this.disposables.forEach(n=>n.unsubscribe())}static \u0275fac=function(i){return new(i||t)(D(ku),D(j),D(de))};static \u0275prov=ye({token:t,factory:t.\u0275fac})}return t})(),y0="firebase_event_origin",v0="firebase_previous_class",b0="firebase_previous_id",w0="firebase_previous_screen",T0="firebase_screen_class",ih="firebase_screen_id",C0="firebase_screen",qr="outlet",E0="page_path",S0="page_title",bi="screen_class",sh="screen_name",D0="screen_view",I0="auto",R0="#",M0=Math.floor(Math.random()*(2**32-1))-2**31,jr={},k0=t=>{let e=[t[bi],t[qr]].join(R0);if(jr.hasOwnProperty(e))return jr[e];{let n=M0++;return jr[e]=n,n}},O0=(t,e,n)=>t.events.pipe(st(s=>s instanceof Uc)).pipe(ke(s=>{let r=t.parseUrl(t.url.replace(/(?:\().+(?:\))/g,h=>h.replace("://",":///"))).root.children[s.snapshot.outlet]?.toString()||"",a=t.routerState.root.children.map(h=>h).find(h=>h.outlet===s.snapshot.outlet);if(!a)return ge(null);let l=a;for(;l.firstChild;)l=l.firstChild;let c=l.pathFromRoot.map(h=>h.routeConfig?.path).filter(h=>h).join("/")||"/",u={[sh]:c,[E0]:`/${r}`,[y0]:I0,[C0]:c,[qr]:s.snapshot.outlet};e&&(u[S0]=e.getTitle());let d=a.component;if(d){if(d===Gc){let h=s.snapshot;for(;h.firstChild;)h=h.firstChild;d=h.component}}else d=s.snapshot.component;if(typeof d=="string")return ge(Je(Me({},u),{[bi]:d}));if(d){let h=n.resolveComponentFactory(d);return ge(Je(Me({},u),{[bi]:h.selector}))}return ge(null)}),st(s=>!!s),ue(s=>Me({[T0]:s[bi],[ih]:k0(s)},s)),fc(s=>s[qr]),zo(s=>s.pipe(Zn((o,r)=>JSON.stringify(o)===JSON.stringify(r)),Ho(void 0),mc(),ue(([o,r])=>o?Me({[v0]:o[bi],[w0]:o[sh],[b0]:o[ih]},r):r)))),N0=(()=>{class t{disposable;constructor(n,i,s,o,r,a){z("angularfire",Ce.full,"screen-tracking"),ah().then(()=>{let l=a.get(en);!n||!l||o.runOutsideAngular(()=>{this.disposable=O0(n,i,s).pipe(ke(c=>T(this,null,function*(){return r&&(yield r.initialized),_0(l,D0,c)}))).subscribe()})})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}static \u0275fac=function(i){return new(i||t)(D(pe,8),D(Vc,8),D(Tc),D(j),D(lh,8),D(de))};static \u0275prov=ye({token:t,factory:t.\u0275fac})}return t})(),Yr=new G("angularfire2.analytics-instances");function A0(t,e){if(!Fs.sync())return null;let n=at(oh,t,e);return n&&new en(n)}function x0(t){return(e,n)=>{if(!Fs.sync())return null;let i=e.runOutsideAngular(()=>t(n));return new en(i)}}var P0={provide:Wr,deps:[[new X,Yr]]},F0={provide:en,useFactory:A0,deps:[[new X,Yr],ct]},B0=(()=>{class t{constructor(n,i){z("angularfire",Ce.full,"analytics")}static \u0275fac=function(i){return new(i||t)(D(N0,8),D(lh,8))};static \u0275mod=N({type:t});static \u0275inj=O({providers:[F0,P0,{provide:as,useValue:Fs.async,multi:!0}]})}return t})();function ch(t,...e){return{ngModule:B0,providers:[{provide:Yr,useFactory:x0(t),multi:!0,deps:[j,de,Ne,ut,...e]}]}}var L0=new Map,z0={activated:!1,tokenObservers:[]},V0={initialized:!1,enabled:!1};function tt(t){return L0.get(t)||Object.assign({},z0)}function fh(){return V0}var U0="https://content-firebaseappcheck.googleapis.com/v1";var $0="exchangeDebugToken",uh={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},eD=24*60*60*1e3;var Jr=class{constructor(e,n,i,s,o){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=i,this.lowerBound=s,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=s,s>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return T(this,null,function*(){this.stop();try{this.pending=new ae,this.pending.promise.catch(n=>{}),yield H0(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new ae,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function H0(t){return new Promise(e=>{setTimeout(e,t)})}var G0={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Ut=new Rn("appCheck","AppCheck",G0);function mh(t){if(!tt(t).activated)throw Ut.create("use-before-activation",{appName:t.name})}function _h(i,s){return T(this,arguments,function*({url:t,body:e},n){let o={"Content-Type":"application/json"},r=n.getImmediate({optional:!0});if(r){let p=yield r.getHeartbeatsHeader();p&&(o["X-Firebase-Client"]=p)}let a={method:"POST",body:JSON.stringify(e),headers:o},l;try{l=yield fetch(t,a)}catch(p){throw Ut.create("fetch-network-error",{originalErrorMessage:p?.message})}if(l.status!==200)throw Ut.create("fetch-status-error",{httpStatus:l.status});let c;try{c=yield l.json()}catch(p){throw Ut.create("fetch-parse-error",{originalErrorMessage:p?.message})}let u=c.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw Ut.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(u[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function gh(t,e){let{projectId:n,appId:i,apiKey:s}=t.options;return{url:`${U0}/projects/${n}/apps/${i}:${$0}?key=${s}`,body:{debug_token:e}}}var j0="firebase-app-check-database",W0=1,Xr="firebase-app-check-store";var Bs=null;function K0(){return Bs||(Bs=new Promise((t,e)=>{try{let n=indexedDB.open(j0,W0);n.onsuccess=i=>{t(i.target.result)},n.onerror=i=>{var s;e(Ut.create("storage-open",{originalErrorMessage:(s=i.target.error)===null||s===void 0?void 0:s.message}))},n.onupgradeneeded=i=>{let s=i.target.result;switch(i.oldVersion){case 0:s.createObjectStore(Xr,{keyPath:"compositeKey"})}}}catch(n){e(Ut.create("storage-open",{originalErrorMessage:n?.message}))}}),Bs)}function q0(t,e){return Y0(Q0(t),e)}function Y0(t,e){return T(this,null,function*(){let i=(yield K0()).transaction(Xr,"readwrite"),o=i.objectStore(Xr).put({compositeKey:t,value:e});return new Promise((r,a)=>{o.onsuccess=l=>{r()},i.onerror=l=>{var c;a(Ut.create("storage-set",{originalErrorMessage:(c=l.target.error)===null||c===void 0?void 0:c.message}))}})})}function Q0(t){return`${t.options.appId}-${t.name}`}var Zr=new Bt("@firebase/app-check");function Qr(t,e){return Xt()?q0(t,e).catch(n=>{Zr.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function yh(){return fh().enabled}function vh(){return T(this,null,function*(){let t=fh();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var J0={error:"UNKNOWN_ERROR"};function X0(t){return _s.encodeString(JSON.stringify(t),!1)}function ea(t,e=!1){return T(this,null,function*(){let n=t.app;mh(n);let i=tt(n),s=i.token,o;if(s&&!wi(s)&&(i.token=void 0,s=void 0),!s){let l=yield i.cachedTokenPromise;l&&(wi(l)?s=l:yield Qr(n,void 0))}if(!e&&s&&wi(s))return{token:s.token};let r=!1;if(yh()){i.exchangeTokenPromise||(i.exchangeTokenPromise=_h(gh(n,yield vh()),t.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),r=!0);let l=yield i.exchangeTokenPromise;return yield Qr(n,l),i.token=l,{token:l.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),r=!0),s=yield tt(n).exchangeTokenPromise}catch(l){l.code==="appCheck/throttled"?Zr.warn(l.message):Zr.error(l),o=l}let a;return s?o?wi(s)?a={token:s.token,internalError:o}:a=hh(o):(a={token:s.token},i.token=s,yield Qr(n,s)):a=hh(o),r&&n1(n,a),a})}function Z0(t){return T(this,null,function*(){let e=t.app;mh(e);let{provider:n}=tt(e);if(yh()){let i=yield vh(),{token:s}=yield _h(gh(e,i),t.heartbeatServiceProvider);return{token:s}}else{let{token:i}=yield n.getToken();return{token:i}}})}function e1(t,e,n,i){let{app:s}=t,o=tt(s),r={next:n,error:i,type:e};if(o.tokenObservers=[...o.tokenObservers,r],o.token&&wi(o.token)){let a=o.token;Promise.resolve().then(()=>{n({token:a.token}),dh(t)}).catch(()=>{})}o.cachedTokenPromise.then(()=>dh(t))}function bh(t,e){let n=tt(t),i=n.tokenObservers.filter(s=>s.next!==e);i.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=i}function dh(t){let{app:e}=t,n=tt(e),i=n.tokenRefresher;i||(i=t1(t),n.tokenRefresher=i),!i.isRunning()&&n.isTokenAutoRefreshEnabled&&i.start()}function t1(t){let{app:e}=t;return new Jr(()=>T(this,null,function*(){let n=tt(e),i;if(n.token?i=yield ea(t,!0):i=yield ea(t),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let n=tt(e);if(n.token){let i=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,s=n.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,s),Math.max(0,i-Date.now())}else return 0},uh.RETRIAL_MIN_WAIT,uh.RETRIAL_MAX_WAIT)}function n1(t,e){let n=tt(t).tokenObservers;for(let i of n)try{i.type==="EXTERNAL"&&e.error!=null?i.error(e.error):i.next(e)}catch{}}function wi(t){return t.expireTimeMillis-Date.now()>0}function hh(t){return{token:X0(J0),error:t}}var ta=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=tt(this.app);for(let n of e)bh(this.app,n.next);return Promise.resolve()}};function i1(t,e){return new ta(t,e)}function s1(t){return{getToken:e=>ea(t,e),getLimitedUseToken:()=>Z0(t),addTokenListener:e=>e1(t,"INTERNAL",e),removeTokenListener:e=>bh(t.app,e)}}var o1="@firebase/app-check",r1="0.8.3";var a1="app-check",ph="app-check-internal";function l1(){Te(new ne(a1,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return i1(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(ph).initialize()})),Te(new ne(ph,t=>{let e=t.getProvider("app-check").getImmediate();return s1(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),z(o1,r1)}l1();var c1=["localhost","0.0.0.0","127.0.0.1"],hD=typeof window<"u"&&c1.includes(window.location.hostname);var u1="firebase",d1="10.10.0";et.registerVersion(u1,d1,"app-compat");var h1=["ngOnDestroy"],Ch=(t,e,n,i={})=>new Proxy(t,{get:(s,o)=>n.runOutsideAngular(()=>{if(t[o])return i?.spy?.get&&i.spy.get(o,t[o]),t[o];if(h1.indexOf(o)>-1)return()=>{};let r=e.toPromise().then(a=>{let l=a?.[o];return typeof l=="function"?l.bind(a):l?.then?l.then(c=>n.run(()=>c)):n.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>r[l],apply:(a,l,c)=>r.then(u=>{let d=u?.(...c);return i?.spy?.apply&&i.spy.apply(o,c,d),d})})})});var na=class{constructor(e){return e}},Ls=new G("angularfire2.app.options"),zs=new G("angularfire2.app.name");function Vs(t,e,n){let i=typeof n=="string"&&n||"[DEFAULT]",s=typeof n=="object"&&n||{};s.name=s.name||i;let r=et.apps.filter(a=>a&&a.name===s.name)[0]||e.runOutsideAngular(()=>et.initializeApp(t,s));try{if(JSON.stringify(t)!==JSON.stringify(r.options)){let a=!!module.hot;p1("error",`${r.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new na(r)}var p1=(t,...e)=>{Qo()&&typeof console<"u"&&console[t](...e)};function Us(t,e,n,i,s){let[,o,r]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(o)return f1(s,r)||(Th("error",`${e} was already initialized on the ${n} Firebase App with different settings.${m1?" You may need to reload as Firebase is not HMR aware.":""}`),Th("warn",{is:s,was:r})),o;{let a=i();return globalThis.\u0275AngularfireInstanceCache.push([t,a,s]),a}}function f1(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var m1=typeof module<"u"&&!!module.hot,Th=(t,...e)=>{Qo()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var ia=new G("angularfire2.auth.use-emulator"),sa=new G("angularfire2.auth.settings"),oa=new G("angularfire2.auth.tenant-id"),ra=new G("angularfire2.auth.langugage-code"),aa=new G("angularfire2.auth.use-device-language"),la=new G("angularfire.auth.persistence"),ca=(t,e,n,i,s,o,r,a)=>Us(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let l=e.runOutsideAngular(()=>t.auth());if(n&&l.useEmulator(...n),i&&(l.tenantId=i),l.languageCode=s,o&&l.useDeviceLanguage(),r)for(let[c,u]of Object.entries(r))l.settings[c]=u;return a&&l.setPersistence(a),l},[n,i,s,o,r,a]),Eh=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,i,s,o,r,a,l,c,u,d,h,p){let y=new Ue,S=ge(void 0).pipe(Jn(r.outsideAngular),ke(()=>o.runOutsideAngular(()=>import("./chunk-4T7SIAW7.js"))),ue(()=>Vs(n,o,i)),ue(I=>ca(I,o,a,c,u,d,l,h)),$o({bufferSize:1,refCount:!1}));if(Fc(s))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ge(null);else{S.pipe(pc()).subscribe();let I=S.pipe(ke(x=>x.getRedirectResult().then(q=>q,()=>null)),Rt,$o({bufferSize:1,refCount:!1})),ie=S.pipe(ke(x=>new Jt(q=>({unsubscribe:o.runOutsideAngular(()=>x.onAuthStateChanged(Ve=>q.next(Ve),Ve=>q.error(Ve),()=>q.complete()))})))),_e=S.pipe(ke(x=>new Jt(q=>({unsubscribe:o.runOutsideAngular(()=>x.onIdTokenChanged(Ve=>q.next(Ve),Ve=>q.error(Ve),()=>q.complete()))}))));this.authState=I.pipe(Go(ie),ts(r.outsideAngular),Jn(r.insideAngular)),this.user=I.pipe(Go(_e),ts(r.outsideAngular),Jn(r.insideAngular)),this.idToken=this.user.pipe(ke(x=>x?ns(x.getIdToken()):ge(null))),this.idTokenResult=this.user.pipe(ke(x=>x?ns(x.getIdTokenResult()):ge(null))),this.credential=hn(I,y,this.authState.pipe(st(x=>!x))).pipe(ue(x=>x?.user?x:null),ts(r.outsideAngular),Jn(r.insideAngular))}return Ch(this,S,o,{spy:{apply:(I,ie,_e)=>{(I.startsWith("signIn")||I.startsWith("createUser"))&&_e.then(x=>y.next(x))}}})}static \u0275fac=function(i){return new(i||t)(D(Ls),D(zs,8),D(Tt),D(j),D(Ne),D(ia,8),D(sa,8),D(oa,8),D(ra,8),D(aa,8),D(la,8),D(It,8))};static \u0275prov=ye({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var Sh="@firebase/database",Dh="1.0.4";var wl="";function Tl(t){wl=t}var ga=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ee(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:ys(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var ya=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return We(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var ip=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new ga(e)}}catch{}return new ya},nn=ip("localStorage"),va=ip("sessionStorage");var Fn=new Bt("@firebase/database"),sp=function(){let t=1;return function(){return t++}}(),op=function(t){let e=Du(t),n=new Su;n.update(e);let i=n.digest();return _s.encodeByteArray(i)},ji=function(...t){let e="";for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?e+=ji.apply(null,i):typeof i=="object"?e+=ee(i):e+=i,e+=" "}return e},sn=null,Ih=!0,rp=function(t,e){f(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Fn.logLevel=Iu.VERBOSE,sn=Fn.log.bind(Fn),e&&va.set("logging_enabled",!0)):typeof t=="function"?sn=t:(sn=null,va.remove("logging_enabled"))},le=function(...t){if(Ih===!0&&(Ih=!1,sn===null&&va.get("logging_enabled")===!0&&rp(!0)),sn){let e=ji.apply(null,t);sn(e)}},Wi=function(t){return function(...e){le(t,...e)}},ba=function(...t){let e="FIREBASE INTERNAL ERROR: "+ji(...t);Fn.error(e)},_t=function(...t){let e=`FIREBASE FATAL ERROR: ${ji(...t)}`;throw Fn.error(e),new Error(e)},me=function(...t){let e="FIREBASE WARNING: "+ji(...t);Fn.warn(e)},y1=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&me("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},_o=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},v1=function(t){if(ot()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},jt="[MIN_NAME]",Nt="[MAX_NAME]",rn=function(t,e){if(t===e)return 0;if(t===jt||e===Nt)return-1;if(e===jt||t===Nt)return 1;{let n=Rh(t),i=Rh(e);return n!==null?i!==null?n-i===0?t.length-e.length:n-i:-1:i!==null?1:t<e?-1:1}},b1=function(t,e){return t===e?0:t<e?-1:1},Ti=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ee(e))},Cl=function(t){if(typeof t!="object"||t===null)return ee(t);let e=[];for(let i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)i!==0&&(n+=","),n+=ee(e[i]),n+=":",n+=Cl(t[e[i]]);return n+="}",n},ap=function(t,e){let n=t.length;if(n<=e)return[t];let i=[];for(let s=0;s<n;s+=e)s+e>n?i.push(t.substring(s,n)):i.push(t.substring(s,s+e));return i};function ce(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var lp=function(t){f(!_o(t),"Invalid JSON number");let e=11,n=52,i=(1<<e-1)-1,s,o,r,a,l;t===0?(o=0,r=0,s=1/t===-1/0?1:0):(s=t<0,t=Math.abs(t),t>=Math.pow(2,1-i)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),i),o=a+i,r=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(o=0,r=Math.round(t/Math.pow(2,1-i-n))));let c=[];for(l=n;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(l=e;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);c.push(s?1:0),c.reverse();let u=c.join(""),d="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},w1=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},T1=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function C1(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}var E1=new RegExp("^-?(0*)\\d{1,10}$"),S1=-2147483648,D1=2147483647,Rh=function(t){if(E1.test(t)){let e=Number(t);if(e>=S1&&e<=D1)return e}return null},jn=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw me("Exception was thrown by user callback.",n),e},Math.floor(0))}},I1=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Di=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var wa=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(i=>this.appCheck=i)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,i)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(i=>i.addTokenListener(e))}notifyForInvalidToken(){me(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var Ta=class{constructor(e,n,i){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(le("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,i)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,i):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',me(e)}},Ii=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Hs="5",cp="v",up="s",dp="r",hp="f",pp=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,fp="ls",mp="p",Ca="ac",_p="websocket",gp="long_polling";var Gs=class{constructor(e,n,i,s,o=!1,r="",a=!1,l=!1){this.secure=n,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=r,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=nn.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&nn.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function R1(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function yp(t,e,n){f(typeof e=="string","typeof type must == string"),f(typeof n=="object","typeof params must == object");let i;if(e===_p)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===gp)i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);R1(t)&&(n.ns=t.namespace);let s=[];return ce(n,(o,r)=>{s.push(o+"="+r)}),i+s.join("&")}var Ea=class{constructor(){this.counters_={}}incrementCounter(e,n=1){We(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return vu(this.counters_)}};var ua={},da={};function El(t){let e=t.toString();return ua[e]||(ua[e]=new Ea),ua[e]}function M1(t,e){let n=t.toString();return da[n]||(da[n]=e()),da[n]}var Sa=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&jn(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var Mh="start",k1="close",O1="pLPCommand",N1="pRTLPCB",vp="id",bp="pw",wp="ser",A1="cb",x1="seg",P1="ts",F1="d",B1="dframe",Tp=1870,Cp=30,L1=Tp-Cp,z1=25e3,V1=3e4,Oi=class t{constructor(e,n,i,s,o,r,a){this.connId=e,this.repoInfo=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.transportSessionId=r,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Wi(e),this.stats_=El(n),this.urlFn=l=>(this.appCheckToken&&(l[Ca]=this.appCheckToken),yp(n,gp,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Sa(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(V1)),v1(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Da((...o)=>{let[r,a,l,c,u]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,r===Mh)this.id=a,this.password=l;else if(r===k1)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+r)},(...o)=>{let[r,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(r,a)},()=>{this.onClosed_()},this.urlFn);let i={};i[Mh]="t",i[wp]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[A1]=this.scriptTagHolder.uniqueCallbackIdentifier),i[cp]=Hs,this.transportSessionId&&(i[up]=this.transportSessionId),this.lastSessionId&&(i[fp]=this.lastSessionId),this.applicationId&&(i[mp]=this.applicationId),this.appCheckToken&&(i[Ca]=this.appCheckToken),typeof location<"u"&&location.hostname&&pp.test(location.hostname)&&(i[dp]=hp);let s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ot()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!w1()&&!T1()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=ee(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let i=yu(n),s=ap(i,L1);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(ot())return;this.myDisconnFrame=document.createElement("iframe");let i={};i[B1]="t",i[vp]=e,i[bp]=n,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=ee(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},Da=class t{constructor(e,n,i,s){if(this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ot())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=sp(),window[O1+this.uniqueCallbackIdentifier]=e,window[N1+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');let r="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(a){le("frame writing exception"),a.stack&&le(a.stack),le(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||le("No IE domain setting required")}catch{let i=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[vp]=this.myID,e[bp]=this.myPW,e[wp]=this.currentSerial;let n=this.urlFn(e),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Cp+i.length<=Tp;){let r=this.pendingSegs.shift();i=i+"&"+x1+s+"="+r.seg+"&"+P1+s+"="+r.ts+"&"+F1+s+"="+r.d,s++}return n=n+i,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,i){this.pendingSegs.push({seg:e,ts:n,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let i=()=>{this.outstandingRequests.delete(n),this.newRequest_()},s=setTimeout(i,Math.floor(z1)),o=()=>{clearTimeout(s),i()};this.addTag(e,o)}addTag(e,n){ot()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){let s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),n())},i.onerror=()=>{le("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}};var U1=16384,$1=45e3,js=null;typeof MozWebSocket<"u"?js=MozWebSocket:typeof WebSocket<"u"&&(js=WebSocket);var xn=(()=>{class t{constructor(n,i,s,o,r,a,l){this.connId=n,this.applicationId=s,this.appCheckToken=o,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Wi(this.connId),this.stats_=El(i),this.connURL=t.connectionURL_(i,a,l,o,s),this.nodeAdmin=i.nodeAdmin}static connectionURL_(n,i,s,o,r){let a={};return a[cp]=Hs,!ot()&&typeof location<"u"&&location.hostname&&pp.test(location.hostname)&&(a[dp]=hp),i&&(a[up]=i),s&&(a[fp]=s),o&&(a[Ca]=o),r&&(a[mp]=r),yp(n,_p,a)}open(n,i){this.onDisconnect=i,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,nn.set("previous_websocket_failure",!0);try{let s;if(ot()){let o=this.nodeAdmin?"AdminNode":"Node";s={headers:{"User-Agent":`Firebase/${Hs}/${wl}/${process.platform}/${o}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(s.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(s.headers["X-Firebase-AppCheck"]=this.appCheckToken);let r=process.env,a=this.connURL.indexOf("wss://")===0?r.HTTPS_PROXY||r.https_proxy:r.HTTP_PROXY||r.http_proxy;a&&(s.proxy={origin:a})}this.mySock=new js(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");let o=s.message||s.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");let o=s.message||s.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let i=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(i);s&&s.length>1&&parseFloat(s[1])<4.4&&(n=!0)}return!n&&js!==null&&!t.forceDisallow_}static previouslyFailed(){return nn.isInMemoryStorage||nn.get("previous_websocket_failure")===!0}markConnectionHealthy(){nn.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let i=this.frames.join("");this.frames=null;let s=ys(i);this.onMessage(s)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(f(this.frames===null,"We already have a frame buffer"),n.length<=6){let i=Number(n);if(!isNaN(i))return this.handleNewFrameCount_(i),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let i=n.data;if(this.bytesReceived+=i.length,this.stats_.incrementCounter("bytes_received",i.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(i);else{let s=this.extractFrameCount_(i);s!==null&&this.appendFrame_(s)}}send(n){this.resetKeepAlive();let i=ee(n);this.bytesSent+=i.length,this.stats_.incrementCounter("bytes_sent",i.length);let s=ap(i,U1);s.length>1&&this.sendString_(String(s.length));for(let o=0;o<s.length;o++)this.sendString_(s[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor($1))}sendString_(n){try{this.mySock.send(n)}catch(i){this.log_("Exception thrown from WebSocket.send():",i.message||i.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),Ep=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Oi,xn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let i=xn&&xn.isAvailable(),s=i&&!xn.previouslyFailed();if(n.webSocketOnly&&(i||me("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[xn];else{let o=this.transports_=[];for(let r of t.ALL_TRANSPORTS)r&&r.isAvailable()&&o.push(r);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),H1=6e4,G1=5e3,j1=10*1024,W1=100*1024,ha="t",kh="d",K1="s",Oh="r",q1="e",Nh="o",Ah="a",xh="n",Ph="p",Y1="h",Ia=class{constructor(e,n,i,s,o,r,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=r,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Wi("c:"+this.id+":"),this.transportManager_=new Ep(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,i)},Math.floor(0));let s=e.healthyTimeout||0;s>0&&(this.healthyTimeout_=Di(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>W1?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>j1?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(ha in e){let n=e[ha];n===Ah?this.upgradeIfSecondaryHealthy_():n===Oh?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Nh&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Ti("t",e),i=Ti("d",e);if(n==="c")this.onSecondaryControl_(i);else if(n==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Ph,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Ah,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:xh,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Ti("t",e),i=Ti("d",e);n==="c"?this.onControl_(i):n==="d"&&this.onDataMessage_(i)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Ti(ha,e);if(kh in e){let i=e[kh];if(n===Y1){let s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(n===xh){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===K1?this.onConnectionShutdown_(i):n===Oh?this.onReset_(i):n===q1?ba("Server Error: "+i):n===Nh?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ba("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,i=e.v,s=e.h;this.sessionId=e.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Hs!==i&&me("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),Di(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(H1))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Di(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(G1))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Ph,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(nn.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Ws=class{put(e,n,i,s){}merge(e,n,i,s){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,i){}onDisconnectMerge(e,n,i){}onDisconnectCancel(e,n){}reportStats(e){}};var Ks=class{constructor(e){this.allowedEvents_=e,this.listeners_={},f(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let i=[...this.listeners_[e]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,n)}}on(e,n,i){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:i});let s=this.getInitialEvent(e);s&&n.apply(i,s)}off(e,n,i){this.validateEventType_(e);let s=this.listeners_[e]||[];for(let o=0;o<s.length;o++)if(s[o].callback===n&&(!i||i===s[o].context)){s.splice(o,1);return}}validateEventType_(e){f(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var qs=class t extends Ks{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Xo()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return f(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var Fh=32,Bh=768,F=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function P(){return new F("")}function R(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Wt(t){return t.pieces_.length-t.pieceNum_}function U(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new F(t.pieces_,e)}function Sl(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Q1(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ni(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Sp(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new F(e,0)}function K(t,e){let n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof F)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{let i=e.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&n.push(i[s])}return new F(n,0)}function M(t){return t.pieceNum_>=t.pieces_.length}function De(t,e){let n=R(t),i=R(e);if(n===null)return e;if(n===i)return De(U(t),U(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function J1(t,e){let n=Ni(t,0),i=Ni(e,0);for(let s=0;s<n.length&&s<i.length;s++){let o=rn(n[s],i[s]);if(o!==0)return o}return n.length===i.length?0:n.length<i.length?-1:1}function Dl(t,e){if(Wt(t)!==Wt(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function qe(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(Wt(t)>Wt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var Ra=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Ni(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=ui(this.parts_[i]);Dp(this)}};function X1(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=ui(e),Dp(t)}function Z1(t){let e=t.parts_.pop();t.byteLength_-=ui(e),t.parts_.length>0&&(t.byteLength_-=1)}function Dp(t){if(t.byteLength_>Bh)throw new Error(t.errorPrefix_+"has a key path longer than "+Bh+" bytes ("+t.byteLength_+").");if(t.parts_.length>Fh)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Fh+") or object contains a cycle "+tn(t))}function tn(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var Ma=class t extends Ks{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let i=!document[e];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}static getInstance(){return new t}getInitialEvent(e){return f(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ci=1e3,ey=60*5*1e3,Lh=30*1e3,ty=1.3,ny=3e4,iy="server_kill",zh=3,Il=(()=>{class t extends Ws{constructor(n,i,s,o,r,a,l,c){if(super(),this.repoInfo_=n,this.applicationId_=i,this.onDataUpdate_=s,this.onConnectStatus_=o,this.onServerInfoUpdate_=r,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=Wi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ci,this.maxReconnectDelay_=ey,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!ot())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Ma.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&qs.getInstance().on("online",this.onOnline_,this)}sendRequest(n,i,s){let o=++this.requestNumber_,r={r:o,a:n,b:i};this.log_(ee(r)),f(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[o]=s)}get(n){this.initConnection_();let i=new ae,o={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let l=a.d;a.s==="ok"?i.resolve(l):i.reject(l)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;let r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),i.promise}listen(n,i,s,o){this.initConnection_();let r=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+r),this.listens.has(a)||this.listens.set(a,new Map),f(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),f(!this.listens.get(a).has(r),"listen() called twice for same path/queryId.");let l={onComplete:o,hashFn:i,query:n,tag:s};this.listens.get(a).set(r,l),this.connected_&&this.sendListen_(l)}sendGet_(n){let i=this.outstandingGets_[n];this.sendRequest("g",i.request,s=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),i.onComplete&&i.onComplete(s)})}sendListen_(n){let i=n.query,s=i._path.toString(),o=i._queryIdentifier;this.log_("Listen on "+s+" for "+o);let r={p:s},a="q";n.tag&&(r.q=i._queryObject,r.t=n.tag),r.h=n.hashFn(),this.sendRequest(a,r,l=>{let c=l.d,u=l.s;t.warnOnListenWarnings_(c,i),(this.listens.get(s)&&this.listens.get(s).get(o))===n&&(this.log_("listen response",l),u!=="ok"&&this.removeListen_(s,o),n.onComplete&&n.onComplete(u,c))})}static warnOnListenWarnings_(n,i){if(n&&typeof n=="object"&&We(n,"w")){let s=Ft(n,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){let o='".indexOn": "'+i._queryParams.getIndex().toString()+'"',r=i._path.toString();me(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Tu(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Lh)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,i=wu(n)?"auth":"gauth",s={cred:n};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(i,s,o=>{let r=o.s,a=o.d||"error";this.authToken_===n&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let i=n.s,s=n.d||"error";i==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(i,s)})}unlisten(n,i){let s=n._path.toString(),o=n._queryIdentifier;this.log_("Unlisten called for "+s+" "+o),f(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,o)&&this.connected_&&this.sendUnlisten_(s,o,n._queryObject,i)}sendUnlisten_(n,i,s,o){this.log_("Unlisten on "+n+" for "+i);let r={p:n},a="n";o&&(r.q=s,r.t=o),this.sendRequest(a,r)}onDisconnectPut(n,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,i,s):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:i,onComplete:s})}onDisconnectMerge(n,i,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,i,s):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:i,onComplete:s})}onDisconnectCancel(n,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:i})}sendOnDisconnect_(n,i,s,o){let r={p:i,d:s};this.log_("onDisconnect "+n,r),this.sendRequest(n,r,a=>{o&&setTimeout(()=>{o(a.s,a.d)},Math.floor(0))})}put(n,i,s,o){this.putInternal("p",n,i,s,o)}merge(n,i,s,o){this.putInternal("m",n,i,s,o)}putInternal(n,i,s,o,r){this.initConnection_();let a={p:i,d:s};r!==void 0&&(a.h=r),this.outstandingPuts_.push({action:n,request:a,onComplete:o}),this.outstandingPutCount_++;let l=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(l):this.log_("Buffering put: "+i)}sendPut_(n){let i=this.outstandingPuts_[n].action,s=this.outstandingPuts_[n].request,o=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(i,s,r=>{this.log_(i+" response",r),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(r.s,r.d)})}reportStats(n){if(this.connected_){let i={c:n};this.log_("reportStats",i),this.sendRequest("s",i,s=>{if(s.s!=="ok"){let r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+ee(n));let i=n.r,s=this.requestCBHash_[i];s&&(delete this.requestCBHash_[i],s(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,i){this.log_("handleServerMessage",n,i),n==="d"?this.onDataUpdate_(i.p,i.d,!1,i.t):n==="m"?this.onDataUpdate_(i.p,i.d,!0,i.t):n==="c"?this.onListenRevoked_(i.p,i.q):n==="ac"?this.onAuthRevoked_(i.s,i.d):n==="apc"?this.onAppCheckRevoked_(i.s,i.d):n==="sd"?this.onSecurityDebugPacket_(i):ba("Unrecognized action received from server: "+ee(n)+`
Are you using the latest client?`)}onReady_(n,i){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=i,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){f(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ci,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Ci,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>ny&&(this.reconnectDelay_=Ci),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,i=Math.max(0,this.reconnectDelay_-n);i=Math.random()*i,this.log_("Trying to reconnect in "+i+"ms"),this.scheduleConnect_(i),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*ty)}this.onConnectStatus_(!1)}establishConnection_(){return T(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),i=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+t.nextConnectionId_++,r=this.lastSessionId,a=!1,l=null,c=function(){l?l.close():(a=!0,s())},u=function(h){f(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(h)};this.realtime_={close:c,sendRequest:u};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,p]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?le("getToken() completed but was canceled"):(le("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=p&&p.token,l=new Ia(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,i,s,y=>{me(y+" ("+this.repoInfo_.toString()+")"),this.interrupt(iy)},r))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&me(h),c())}}})}interrupt(n){le("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){le("Resuming connection for reason: "+n),delete this.interruptReasons_[n],vs(this.interruptReasons_)&&(this.reconnectDelay_=Ci,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let i=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:i})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let i=this.outstandingPuts_[n];i&&"h"in i.request&&i.queued&&(i.onComplete&&i.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,i){let s;i?s=i.map(r=>Cl(r)).join("$"):s="default";let o=this.removeListen_(n,s);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(n,i){let s=new F(n).toString(),o;if(this.listens.has(s)){let r=this.listens.get(s);o=r.get(i),r.delete(i),r.size===0&&this.listens.delete(s)}else o=void 0;return o}onAuthRevoked_(n,i){le("Auth token revoked: "+n+"/"+i),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=zh&&(this.reconnectDelay_=Lh,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,i){le("App check token revoked: "+n+"/"+i),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=zh&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let i of n.values())this.sendListen_(i);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},i="js";ot()&&(this.repoInfo_.nodeAdmin?i="admin_node":i="node"),n["sdk."+i+"."+wl.replace(/\./g,"-")]=1,Xo()?n["framework.cordova"]=1:bu()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=qs.getInstance().currentlyOnline();return vs(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),k=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Bn=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let i=new k(jt,e),s=new k(jt,n);return this.compare(i,s)!==0}minPost(){return k.MIN}};var $s,Ys=class extends Bn{static get __EMPTY_NODE(){return $s}static set __EMPTY_NODE(e){$s=e}compare(e,n){return rn(e.name,n.name)}isDefinedOn(e){throw In("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return k.MIN}maxPost(){return new k(Nt,$s)}makePost(e,n){return f(typeof e=="string","KeyIndex indexValue must always be a string."),new k(e,$s)}toString(){return".key"}},mt=new Ys;var Pn=class{constructor(e,n,i,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let r=1;for(;!e.isEmpty();)if(e=e,r=n?i(e.key,n):1,s&&(r*=-1),r<0)this.isReverse_?e=e.left:e=e.right;else if(r===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},nt=(()=>{class t{constructor(n,i,s,o,r){this.key=n,this.value=i,this.color=s??t.RED,this.left=o??Ye.EMPTY_NODE,this.right=r??Ye.EMPTY_NODE}copy(n,i,s,o,r){return new t(n??this.key,i??this.value,s??this.color,o??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,i,s){let o=this,r=s(n,o.key);return r<0?o=o.copy(null,null,null,o.left.insert(n,i,s),null):r===0?o=o.copy(null,i,null,null,null):o=o.copy(null,null,null,null,o.right.insert(n,i,s)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ye.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,i){let s,o;if(s=this,i(n,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(n,i),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),i(n,s.key)===0){if(s.right.isEmpty())return Ye.EMPTY_NODE;o=s.right.min_(),s=s.copy(o.key,o.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(n,i))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),i=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,i)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),ka=class{copy(e,n,i,s,o){return this}insert(e,n,i){return new nt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Ye=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,nt.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,nt.BLACK,null,null))}get(e){let n,i=this.root_;for(;!i.isEmpty();){if(n=this.comparator_(e,i.key),n===0)return i.value;n<0?i=i.left:n>0&&(i=i.right)}return null}getPredecessorKey(e){let n,i=this.root_,s=null;for(;!i.isEmpty();)if(n=this.comparator_(e,i.key),n===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else n<0?i=i.left:n>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Pn(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Pn(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Pn(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Pn(this.root_,null,this.comparator_,!0,e)}};Ye.EMPTY_NODE=new ka;function sy(t,e){return rn(t.name,e.name)}function Rl(t,e){return rn(t,e)}var Oa;function oy(t){Oa=t}var Ip=function(t){return typeof t=="number"?"number:"+lp(t):"string:"+t},Rp=function(t){if(t.isLeafNode()){let e=t.val();f(typeof e=="string"||typeof e=="number"||typeof e=="object"&&We(e,".sv"),"Priority must be a string or number.")}else f(t===Oa||t.isEmpty(),"priority of unexpected type.");f(t===Oa||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var Vh,Ln=(()=>{class t{constructor(n,i=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=i,this.lazyHash_=null,f(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Rp(this.priorityNode_)}static set __childrenNodeConstructor(n){Vh=n}static get __childrenNodeConstructor(){return Vh}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return M(n)?this:R(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,i){return null}updateImmediateChild(n,i){return n===".priority"?this.updatePriority(i):i.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,i).updatePriority(this.priorityNode_)}updateChild(n,i){let s=R(n);return s===null?i:i.isEmpty()&&s!==".priority"?this:(f(s!==".priority"||Wt(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(U(n),i)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,i){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+Ip(this.priorityNode_.val())+":");let i=typeof this.value_;n+=i+":",i==="number"?n+=lp(this.value_):n+=this.value_,this.lazyHash_=op(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(f(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let i=typeof n.value_,s=typeof this.value_,o=t.VALUE_TYPE_ORDER.indexOf(i),r=t.VALUE_TYPE_ORDER.indexOf(s);return f(o>=0,"Unknown leaf type: "+i),f(r>=0,"Unknown leaf type: "+s),o===r?s==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:r-o}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let i=n;return this.value_===i.value_&&this.priorityNode_.equals(i.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),Mp,kp;function ry(t){Mp=t}function ay(t){kp=t}var Na=class extends Bn{compare(e,n){let i=e.node.getPriority(),s=n.node.getPriority(),o=i.compareTo(s);return o===0?rn(e.name,n.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return k.MIN}maxPost(){return new k(Nt,new Ln("[PRIORITY-POST]",kp))}makePost(e,n){let i=Mp(e);return new k(n,new Ln("[PRIORITY-POST]",i))}toString(){return".priority"}},H=new Na;var ly=Math.log(2),Aa=class{constructor(e){let n=o=>parseInt(Math.log(o)/ly,10),i=o=>parseInt(Array(o+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let s=i(this.count);this.bits_=e+1&s}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Qs=function(t,e,n,i){t.sort(e);let s=function(l,c){let u=c-l,d,h;if(u===0)return null;if(u===1)return d=t[l],h=n?n(d):d,new nt(h,d.node,nt.BLACK,null,null);{let p=parseInt(u/2,10)+l,y=s(l,p),S=s(p+1,c);return d=t[p],h=n?n(d):d,new nt(h,d.node,nt.BLACK,y,S)}},o=function(l){let c=null,u=null,d=t.length,h=function(y,S){let I=d-y,ie=d;d-=y;let _e=s(I+1,ie),x=t[I],q=n?n(x):x;p(new nt(q,x.node,S,null,_e))},p=function(y){c?(c.left=y,c=y):(u=y,c=y)};for(let y=0;y<l.count;++y){let S=l.nextBitIsOne(),I=Math.pow(2,l.count-(y+1));S?h(I,nt.BLACK):(h(I,nt.BLACK),h(I,nt.RED))}return u},r=new Aa(t.length),a=o(r);return new Ye(i||e,a)};var pa,An={},zn=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return f(An&&H,"ChildrenNode.ts has not been loaded"),pa=pa||new t({".priority":An},{".priority":H}),pa}get(e){let n=Ft(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Ye?n:null}hasIndex(e){return We(this.indexSet_,e.toString())}addIndex(e,n){f(e!==mt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let i=[],s=!1,o=n.getIterator(k.Wrap),r=o.getNext();for(;r;)s=s||e.isDefinedOn(r.node),i.push(r),r=o.getNext();let a;s?a=Qs(i,e.getCompare()):a=An;let l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;let u=Object.assign({},this.indexes_);return u[l]=a,new t(u,c)}addToIndexes(e,n){let i=ci(this.indexes_,(s,o)=>{let r=Ft(this.indexSet_,o);if(f(r,"Missing index implementation for "+o),s===An)if(r.isDefinedOn(e.node)){let a=[],l=n.getIterator(k.Wrap),c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Qs(a,r.getCompare())}else return An;else{let a=n.get(e.name),l=s;return a&&(l=l.remove(new k(e.name,a))),l.insert(e,e.node)}});return new t(i,this.indexSet_)}removeFromIndexes(e,n){let i=ci(this.indexes_,s=>{if(s===An)return s;{let o=n.get(e.name);return o?s.remove(new k(e.name,o)):s}});return new t(i,this.indexSet_)}};var Ei,E=(()=>{class t{constructor(n,i,s){this.children_=n,this.priorityNode_=i,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Rp(this.priorityNode_),this.children_.isEmpty()&&f(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Ei||(Ei=new t(new Ye(Rl),null,zn.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Ei}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let i=this.children_.get(n);return i===null?Ei:i}}getChild(n){let i=R(n);return i===null?this:this.getImmediateChild(i).getChild(U(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,i){if(f(i,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(i);{let s=new k(n,i),o,r;i.isEmpty()?(o=this.children_.remove(n),r=this.indexMap_.removeFromIndexes(s,this.children_)):(o=this.children_.insert(n,i),r=this.indexMap_.addToIndexes(s,this.children_));let a=o.isEmpty()?Ei:this.priorityNode_;return new t(o,a,r)}}updateChild(n,i){let s=R(n);if(s===null)return i;{f(R(n)!==".priority"||Wt(n)===1,".priority must be the last token in a path");let o=this.getImmediateChild(s).updateChild(U(n),i);return this.updateImmediateChild(s,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let i={},s=0,o=0,r=!0;if(this.forEachChild(H,(a,l)=>{i[a]=l.val(n),s++,r&&t.INTEGER_REGEXP_.test(a)?o=Math.max(o,Number(a)):r=!1}),!n&&r&&o<2*s){let a=[];for(let l in i)a[l]=i[l];return a}else return n&&!this.getPriority().isEmpty()&&(i[".priority"]=this.getPriority().val()),i}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+Ip(this.getPriority().val())+":"),this.forEachChild(H,(i,s)=>{let o=s.hash();o!==""&&(n+=":"+i+":"+o)}),this.lazyHash_=n===""?"":op(n)}return this.lazyHash_}getPredecessorChildName(n,i,s){let o=this.resolveIndex_(s);if(o){let r=o.getPredecessorKey(new k(n,i));return r?r.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let i=this.resolveIndex_(n);if(i){let s=i.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(n){let i=this.getFirstChildName(n);return i?new k(i,this.children_.get(i)):null}getLastChildName(n){let i=this.resolveIndex_(n);if(i){let s=i.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(n){let i=this.getLastChildName(n);return i?new k(i,this.children_.get(i)):null}forEachChild(n,i){let s=this.resolveIndex_(n);return s?s.inorderTraversal(o=>i(o.name,o.node)):this.children_.inorderTraversal(i)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,i){let s=this.resolveIndex_(i);if(s)return s.getIteratorFrom(n,o=>o);{let o=this.children_.getIteratorFrom(n.name,k.Wrap),r=o.peek();for(;r!=null&&i.compare(r,n)<0;)o.getNext(),r=o.peek();return o}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,i){let s=this.resolveIndex_(i);if(s)return s.getReverseIteratorFrom(n,o=>o);{let o=this.children_.getReverseIteratorFrom(n.name,k.Wrap),r=o.peek();for(;r!=null&&i.compare(r,n)>0;)o.getNext(),r=o.peek();return o}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Ki?-1:0}withIndex(n){if(n===mt||this.indexMap_.hasIndex(n))return this;{let i=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,i)}}isIndexed(n){return n===mt||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let i=n;if(this.getPriority().equals(i.getPriority()))if(this.children_.count()===i.children_.count()){let s=this.getIterator(H),o=i.getIterator(H),r=s.getNext(),a=o.getNext();for(;r&&a;){if(r.name!==a.name||!r.node.equals(a.node))return!1;r=s.getNext(),a=o.getNext()}return r===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===mt?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),xa=class extends E{constructor(){super(new Ye(Rl),E.EMPTY_NODE,zn.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return E.EMPTY_NODE}isEmpty(){return!1}},Ki=new xa;Object.defineProperties(k,{MIN:{value:new k(jt,E.EMPTY_NODE)},MAX:{value:new k(Nt,Ki)}});Ys.__EMPTY_NODE=E.EMPTY_NODE;Ln.__childrenNodeConstructor=E;oy(Ki);ay(Ki);var cy=!0;function Y(t,e=null){if(t===null)return E.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),f(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Ln(n,Y(e))}if(!(t instanceof Array)&&cy){let n=[],i=!1;if(ce(t,(r,a)=>{if(r.substring(0,1)!=="."){let l=Y(a);l.isEmpty()||(i=i||!l.getPriority().isEmpty(),n.push(new k(r,l)))}}),n.length===0)return E.EMPTY_NODE;let o=Qs(n,sy,r=>r.name,Rl);if(i){let r=Qs(n,H.getCompare());return new E(o,Y(e),new zn({".priority":r},{".priority":H}))}else return new E(o,Y(e),zn.Default)}else{let n=E.EMPTY_NODE;return ce(t,(i,s)=>{if(We(t,i)&&i.substring(0,1)!=="."){let o=Y(s);(o.isLeafNode()||!o.isEmpty())&&(n=n.updateImmediateChild(i,o))}}),n.updatePriority(Y(e))}}ry(Y);var Ai=class extends Bn{constructor(e){super(),this.indexPath_=e,f(!M(e)&&R(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let i=this.extractChild(e.node),s=this.extractChild(n.node),o=i.compareTo(s);return o===0?rn(e.name,n.name):o}makePost(e,n){let i=Y(e),s=E.EMPTY_NODE.updateChild(this.indexPath_,i);return new k(n,s)}maxPost(){let e=E.EMPTY_NODE.updateChild(this.indexPath_,Ki);return new k(Nt,e)}toString(){return Ni(this.indexPath_,0).join("/")}};var Pa=class extends Bn{compare(e,n){let i=e.node.compareTo(n.node);return i===0?rn(e.name,n.name):i}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return k.MIN}maxPost(){return k.MAX}makePost(e,n){let i=Y(e);return new k(n,i)}toString(){return".value"}},Ml=new Pa;function Op(t){return{type:"value",snapshotNode:t}}function Vn(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function xi(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Pi(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function uy(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Fi=class{constructor(e){this.index_=e}updateChild(e,n,i,s,o,r){f(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(s).equals(i.getChild(s))&&a.isEmpty()===i.isEmpty()||(r!=null&&(i.isEmpty()?e.hasChild(n)?r.trackChildChange(xi(n,a)):f(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?r.trackChildChange(Vn(n,i)):r.trackChildChange(Pi(n,i,a))),e.isLeafNode()&&i.isEmpty())?e:e.updateImmediateChild(n,i).withIndex(this.index_)}updateFullNode(e,n,i){return i!=null&&(e.isLeafNode()||e.forEachChild(H,(s,o)=>{n.hasChild(s)||i.trackChildChange(xi(s,o))}),n.isLeafNode()||n.forEachChild(H,(s,o)=>{if(e.hasChild(s)){let r=e.getImmediateChild(s);r.equals(o)||i.trackChildChange(Pi(s,o,r))}else i.trackChildChange(Vn(s,o))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?E.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Js=class t{constructor(e){this.indexedFilter_=new Fi(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,i=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&i}updateChild(e,n,i,s,o,r){return this.matches(new k(n,i))||(i=E.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,i,s,o,r)}updateFullNode(e,n,i){n.isLeafNode()&&(n=E.EMPTY_NODE);let s=n.withIndex(this.index_);s=s.updatePriority(E.EMPTY_NODE);let o=this;return n.forEachChild(H,(r,a)=>{o.matches(new k(r,a))||(s=s.updateImmediateChild(r,E.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,s,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var Fa=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let i=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=n=>{let i=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new Js(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,i,s,o,r){return this.rangedFilter_.matches(new k(n,i))||(i=E.EMPTY_NODE),e.getImmediateChild(n).equals(i)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,i,s,o,r):this.fullLimitUpdateChild_(e,n,i,o,r)}updateFullNode(e,n,i){let s;if(n.isLeafNode()||n.isEmpty())s=E.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){s=E.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;o.hasNext()&&r<this.limit_;){let a=o.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))s=s.updateImmediateChild(a.name,a.node),r++;else break;else continue}}else{s=n.withIndex(this.index_),s=s.updatePriority(E.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let r=0;for(;o.hasNext();){let a=o.getNext();r<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?r++:s=s.updateImmediateChild(a.name,E.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,s,i)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,i,s,o){let r;if(this.reverse_){let d=this.index_.getCompare();r=(h,p)=>d(p,h)}else r=this.index_.getCompare();let a=e;f(a.numChildren()===this.limit_,"");let l=new k(n,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=s.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=s.getChildAfterChild(this.index_,h,this.reverse_);let p=h==null?1:r(h,l);if(u&&!i.isEmpty()&&p>=0)return o?.trackChildChange(Pi(n,i,d)),a.updateImmediateChild(n,i);{o?.trackChildChange(xi(n,d));let S=a.updateImmediateChild(n,E.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(o?.trackChildChange(Vn(h.name,h.node)),S.updateImmediateChild(h.name,h.node)):S}}else return i.isEmpty()?e:u&&r(c,l)>=0?(o!=null&&(o.trackChildChange(xi(c.name,c.node)),o.trackChildChange(Vn(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(c.name,E.EMPTY_NODE)):e}};var Bi=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=H}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return f(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return f(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:jt}hasEnd(){return this.endSet_}getIndexEndValue(){return f(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return f(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Nt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return f(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===H}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function dy(t){return t.loadsAllData()?new Fi(t.getIndex()):t.hasLimit()?new Fa(t):new Js(t)}function hy(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function py(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Ba(t,e,n){let i=t.copy();return i.startSet_=!0,e===void 0&&(e=null),i.indexStartValue_=e,n!=null?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function fy(t,e,n){let i;return t.index_===mt||n?i=Ba(t,e,n):i=Ba(t,e,Nt),i.startAfterSet_=!0,i}function La(t,e,n){let i=t.copy();return i.endSet_=!0,e===void 0&&(e=null),i.indexEndValue_=e,n!==void 0?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function my(t,e,n){let i;return t.index_===mt||n?i=La(t,e,n):i=La(t,e,jt),i.endBeforeSet_=!0,i}function go(t,e){let n=t.copy();return n.index_=e,n}function Uh(t){let e={};if(t.isDefault())return e;let n;if(t.index_===H?n="$priority":t.index_===Ml?n="$value":t.index_===mt?n="$key":(f(t.index_ instanceof Ai,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ee(n),t.startSet_){let i=t.startAfterSet_?"startAfter":"startAt";e[i]=ee(t.indexStartValue_),t.startNameSet_&&(e[i]+=","+ee(t.indexStartName_))}if(t.endSet_){let i=t.endBeforeSet_?"endBefore":"endAt";e[i]=ee(t.indexEndValue_),t.endNameSet_&&(e[i]+=","+ee(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function $h(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==H&&(e.i=t.index_.toString()),e}var za=class t extends Ws{constructor(e,n,i,s){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=Wi("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(f(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,i,s){let o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);let r=t.getListenId_(e,i),a={};this.listens_[r]=a;let l=Uh(e._queryParams);this.restRequest_(o+".json",l,(c,u)=>{let d=u;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(o,d,!1,i),Ft(this.listens_,r)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",s(h,null)}})}unlisten(e,n){let i=t.getListenId_(e,n);delete this.listens_[i]}get(e){let n=Uh(e._queryParams),i=e._path.toString(),s=new ae;return this.restRequest_(i+".json",n,(o,r)=>{let a=r;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(i,a,!1,null),s.resolve(a)):s.reject(new Error(a))}),s.promise}refreshAuthToken(e){}restRequest_(e,n={},i){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(n.auth=s.accessToken),o&&o.token&&(n.ac=o.token);let r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Eu(n);this.log_("Sending REST request for "+r);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(i&&a.readyState===4){this.log_("REST Response for "+r+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=ys(a.responseText)}catch{me("Failed to parse JSON response for "+r+": "+a.responseText)}i(null,l)}else a.status!==401&&a.status!==404&&me("Got unsuccessful REST response for "+r+" Status: "+a.status),i(a.status);i=null}},a.open("GET",r,!0),a.send()})}};var Va=class{constructor(){this.rootNode_=E.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Xs(){return{value:null,children:new Map}}function Wn(t,e,n){if(M(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let i=R(e);t.children.has(i)||t.children.set(i,Xs());let s=t.children.get(i);e=U(e),Wn(s,e,n)}}function Ua(t,e){if(M(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(H,(i,s)=>{Wn(t,new F(i),s)}),Ua(t,e)}}else if(t.children.size>0){let n=R(e);return e=U(e),t.children.has(n)&&Ua(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function $a(t,e,n){t.value!==null?n(e,t.value):_y(t,(i,s)=>{let o=new F(e.toString()+"/"+i);$a(s,o,n)})}function _y(t,e){t.children.forEach((n,i)=>{e(i,n)})}var Ha=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&ce(this.last_,(i,s)=>{n[i]=n[i]-s}),this.last_=e,n}};var Hh=10*1e3,gy=30*1e3,yy=5*60*1e3,Ga=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new Ha(e);let i=Hh+(gy-Hh)*Math.random();Di(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){let e=this.statsListener_.get(),n={},i=!1;ce(e,(s,o)=>{o>0&&We(this.statsToReport_,s)&&(n[s]=o,i=!0)}),i&&this.server_.reportStats(n),Di(this.reportStats_.bind(this),Math.floor(Math.random()*2*yy))}};var ft=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(ft||{});function kl(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ol(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Nl(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var ja=class t{constructor(e,n,i){this.path=e,this.affectedTree=n,this.revert=i,this.type=ft.ACK_USER_WRITE,this.source=kl()}operationForChild(e){if(M(this.path)){if(this.affectedTree.value!=null)return f(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new F(e));return new t(P(),n,this.revert)}}else return f(R(this.path)===e,"operationForChild called for unrelated child."),new t(U(this.path),this.affectedTree,this.revert)}};var Zs=class t{constructor(e,n){this.source=e,this.path=n,this.type=ft.LISTEN_COMPLETE}operationForChild(e){return M(this.path)?new t(this.source,P()):new t(this.source,U(this.path))}};var Un=class t{constructor(e,n,i){this.source=e,this.path=n,this.snap=i,this.type=ft.OVERWRITE}operationForChild(e){return M(this.path)?new t(this.source,P(),this.snap.getImmediateChild(e)):new t(this.source,U(this.path),this.snap)}};var Li=class t{constructor(e,n,i){this.source=e,this.path=n,this.children=i,this.type=ft.MERGE}operationForChild(e){if(M(this.path)){let n=this.children.subtree(new F(e));return n.isEmpty()?null:n.value?new Un(this.source,P(),n.value):new t(this.source,P(),n)}else return f(R(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,U(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var gt=class{constructor(e,n,i){this.node_=e,this.fullyInitialized_=n,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(M(e))return this.isFullyInitialized()&&!this.filtered_;let n=R(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var Wa=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function vy(t,e,n,i){let s=[],o=[];return e.forEach(r=>{r.type==="child_changed"&&t.index_.indexedValueChanged(r.oldSnap,r.snapshotNode)&&o.push(uy(r.childName,r.snapshotNode))}),Si(t,s,"child_removed",e,i,n),Si(t,s,"child_added",e,i,n),Si(t,s,"child_moved",o,i,n),Si(t,s,"child_changed",e,i,n),Si(t,s,"value",e,i,n),s}function Si(t,e,n,i,s,o){let r=i.filter(a=>a.type===n);r.sort((a,l)=>wy(t,a,l)),r.forEach(a=>{let l=by(t,a,o);s.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function by(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function wy(t,e,n){if(e.childName==null||n.childName==null)throw In("Should only compare child_ events.");let i=new k(e.childName,e.snapshotNode),s=new k(n.childName,n.snapshotNode);return t.index_.compare(i,s)}function yo(t,e){return{eventCache:t,serverCache:e}}function Ri(t,e,n,i){return yo(new gt(e,n,i),t.serverCache)}function Np(t,e,n,i){return yo(t.eventCache,new gt(e,n,i))}function eo(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function on(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var fa,Ty=()=>(fa||(fa=new Ye(b1)),fa),Ie=class t{constructor(e,n=Ty()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return ce(e,(i,s)=>{n=n.set(new F(i),s)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:P(),value:this.value};if(M(e))return null;{let i=R(e),s=this.children.get(i);if(s!==null){let o=s.findRootMostMatchingPathAndValue(U(e),n);return o!=null?{path:K(new F(i),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(M(e))return this;{let n=R(e),i=this.children.get(n);return i!==null?i.subtree(U(e)):new t(null)}}set(e,n){if(M(e))return new t(n,this.children);{let i=R(e),o=(this.children.get(i)||new t(null)).set(U(e),n),r=this.children.insert(i,o);return new t(this.value,r)}}remove(e){if(M(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=R(e),i=this.children.get(n);if(i){let s=i.remove(U(e)),o;return s.isEmpty()?o=this.children.remove(n):o=this.children.insert(n,s),this.value===null&&o.isEmpty()?new t(null):new t(this.value,o)}else return this}}get(e){if(M(e))return this.value;{let n=R(e),i=this.children.get(n);return i?i.get(U(e)):null}}setTree(e,n){if(M(e))return n;{let i=R(e),o=(this.children.get(i)||new t(null)).setTree(U(e),n),r;return o.isEmpty()?r=this.children.remove(i):r=this.children.insert(i,o),new t(this.value,r)}}fold(e){return this.fold_(P(),e)}fold_(e,n){let i={};return this.children.inorderTraversal((s,o)=>{i[s]=o.fold_(K(e,s),n)}),n(e,this.value,i)}findOnPath(e,n){return this.findOnPath_(e,P(),n)}findOnPath_(e,n,i){let s=this.value?i(n,this.value):!1;if(s)return s;if(M(e))return null;{let o=R(e),r=this.children.get(o);return r?r.findOnPath_(U(e),K(n,o),i):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,P(),n)}foreachOnPath_(e,n,i){if(M(e))return this;{this.value&&i(n,this.value);let s=R(e),o=this.children.get(s);return o?o.foreachOnPath_(U(e),K(n,s),i):new t(null)}}foreach(e){this.foreach_(P(),e)}foreach_(e,n){this.children.inorderTraversal((i,s)=>{s.foreach_(K(e,i),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,i)=>{i.value&&e(n,i.value)})}};var it=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Ie(null))}};function Mi(t,e,n){if(M(e))return new it(new Ie(n));{let i=t.writeTree_.findRootMostValueAndPath(e);if(i!=null){let s=i.path,o=i.value,r=De(s,e);return o=o.updateChild(r,n),new it(t.writeTree_.set(s,o))}else{let s=new Ie(n),o=t.writeTree_.setTree(e,s);return new it(o)}}}function Ka(t,e,n){let i=t;return ce(n,(s,o)=>{i=Mi(i,K(e,s),o)}),i}function Gh(t,e){if(M(e))return it.empty();{let n=t.writeTree_.setTree(e,new Ie(null));return new it(n)}}function qa(t,e){return an(t,e)!=null}function an(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(De(n.path,e)):null}function jh(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(H,(i,s)=>{e.push(new k(i,s))}):t.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&e.push(new k(i,s.value))}),e}function Ht(t,e){if(M(e))return t;{let n=an(t,e);return n!=null?new it(new Ie(n)):new it(t.writeTree_.subtree(e))}}function Ya(t){return t.writeTree_.isEmpty()}function $n(t,e){return Ap(P(),t.writeTree_,e)}function Ap(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal((s,o)=>{s===".priority"?(f(o.value!==null,"Priority writes must always be leaf nodes"),i=o.value):n=Ap(K(t,s),o,n)}),!n.getChild(t).isEmpty()&&i!==null&&(n=n.updateChild(K(t,".priority"),i)),n}}function vo(t,e){return Bp(e,t)}function Cy(t,e,n,i,s){f(i>t.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:s}),s&&(t.visibleWrites=Mi(t.visibleWrites,e,n)),t.lastWriteId=i}function Ey(t,e,n,i){f(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=Ka(t.visibleWrites,e,n),t.lastWriteId=i}function Sy(t,e){for(let n=0;n<t.allWrites.length;n++){let i=t.allWrites[n];if(i.writeId===e)return i}return null}function Dy(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);f(n>=0,"removeWrite called with nonexistent writeId.");let i=t.allWrites[n];t.allWrites.splice(n,1);let s=i.visible,o=!1,r=t.allWrites.length-1;for(;s&&r>=0;){let a=t.allWrites[r];a.visible&&(r>=n&&Iy(a,i.path)?s=!1:qe(i.path,a.path)&&(o=!0)),r--}if(s){if(o)return Ry(t),!0;if(i.snap)t.visibleWrites=Gh(t.visibleWrites,i.path);else{let a=i.children;ce(a,l=>{t.visibleWrites=Gh(t.visibleWrites,K(i.path,l))})}return!0}else return!1}function Iy(t,e){if(t.snap)return qe(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&qe(K(t.path,n),e))return!0;return!1}function Ry(t){t.visibleWrites=xp(t.allWrites,My,P()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function My(t){return t.visible}function xp(t,e,n){let i=it.empty();for(let s=0;s<t.length;++s){let o=t[s];if(e(o)){let r=o.path,a;if(o.snap)qe(n,r)?(a=De(n,r),i=Mi(i,a,o.snap)):qe(r,n)&&(a=De(r,n),i=Mi(i,P(),o.snap.getChild(a)));else if(o.children){if(qe(n,r))a=De(n,r),i=Ka(i,a,o.children);else if(qe(r,n))if(a=De(r,n),M(a))i=Ka(i,P(),o.children);else{let l=Ft(o.children,R(a));if(l){let c=l.getChild(U(a));i=Mi(i,P(),c)}}}else throw In("WriteRecord should have .snap or .children")}}return i}function Pp(t,e,n,i,s){if(!i&&!s){let o=an(t.visibleWrites,e);if(o!=null)return o;{let r=Ht(t.visibleWrites,e);if(Ya(r))return n;if(n==null&&!qa(r,P()))return null;{let a=n||E.EMPTY_NODE;return $n(r,a)}}}else{let o=Ht(t.visibleWrites,e);if(!s&&Ya(o))return n;if(!s&&n==null&&!qa(o,P()))return null;{let r=function(c){return(c.visible||s)&&(!i||!~i.indexOf(c.writeId))&&(qe(c.path,e)||qe(e,c.path))},a=xp(t.allWrites,r,e),l=n||E.EMPTY_NODE;return $n(a,l)}}}function ky(t,e,n){let i=E.EMPTY_NODE,s=an(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(H,(o,r)=>{i=i.updateImmediateChild(o,r)}),i;if(n){let o=Ht(t.visibleWrites,e);return n.forEachChild(H,(r,a)=>{let l=$n(Ht(o,new F(r)),a);i=i.updateImmediateChild(r,l)}),jh(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}else{let o=Ht(t.visibleWrites,e);return jh(o).forEach(r=>{i=i.updateImmediateChild(r.name,r.node)}),i}}function Oy(t,e,n,i,s){f(i||s,"Either existingEventSnap or existingServerSnap must exist");let o=K(e,n);if(qa(t.visibleWrites,o))return null;{let r=Ht(t.visibleWrites,o);return Ya(r)?s.getChild(n):$n(r,s.getChild(n))}}function Ny(t,e,n,i){let s=K(e,n),o=an(t.visibleWrites,s);if(o!=null)return o;if(i.isCompleteForChild(n)){let r=Ht(t.visibleWrites,s);return $n(r,i.getNode().getImmediateChild(n))}else return null}function Ay(t,e){return an(t.visibleWrites,e)}function xy(t,e,n,i,s,o,r){let a,l=Ht(t.visibleWrites,e),c=an(l,P());if(c!=null)a=c;else if(n!=null)a=$n(l,n);else return[];if(a=a.withIndex(r),!a.isEmpty()&&!a.isLeafNode()){let u=[],d=r.getCompare(),h=o?a.getReverseIteratorFrom(i,r):a.getIteratorFrom(i,r),p=h.getNext();for(;p&&u.length<s;)d(p,i)!==0&&u.push(p),p=h.getNext();return u}else return[]}function Py(){return{visibleWrites:it.empty(),allWrites:[],lastWriteId:-1}}function to(t,e,n,i){return Pp(t.writeTree,t.treePath,e,n,i)}function Al(t,e){return ky(t.writeTree,t.treePath,e)}function Wh(t,e,n,i){return Oy(t.writeTree,t.treePath,e,n,i)}function no(t,e){return Ay(t.writeTree,K(t.treePath,e))}function Fy(t,e,n,i,s,o){return xy(t.writeTree,t.treePath,e,n,i,s,o)}function xl(t,e,n){return Ny(t.writeTree,t.treePath,e,n)}function Fp(t,e){return Bp(K(t.treePath,e),t.writeTree)}function Bp(t,e){return{treePath:t,writeTree:e}}var Qa=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,i=e.childName;f(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),f(i!==".priority","Only non-priority child changes can be tracked.");let s=this.changeMap.get(i);if(s){let o=s.type;if(n==="child_added"&&o==="child_removed")this.changeMap.set(i,Pi(i,e.snapshotNode,s.snapshotNode));else if(n==="child_removed"&&o==="child_added")this.changeMap.delete(i);else if(n==="child_removed"&&o==="child_changed")this.changeMap.set(i,xi(i,s.oldSnap));else if(n==="child_changed"&&o==="child_added")this.changeMap.set(i,Vn(i,e.snapshotNode));else if(n==="child_changed"&&o==="child_changed")this.changeMap.set(i,Pi(i,e.snapshotNode,s.oldSnap));else throw In("Illegal combination of changes: "+e+" occurred after "+s)}else this.changeMap.set(i,e)}getChanges(){return Array.from(this.changeMap.values())}};var Ja=class{getCompleteChild(e){return null}getChildAfterChild(e,n,i){return null}},Lp=new Ja,zi=class{constructor(e,n,i=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=i}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let i=this.optCompleteServerCache_!=null?new gt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return xl(this.writes_,e,i)}}getChildAfterChild(e,n,i){let s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:on(this.viewCache_),o=Fy(this.writes_,s,n,1,i,e);return o.length===0?null:o[0]}};function By(t){return{filter:t}}function Ly(t,e){f(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),f(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function zy(t,e,n,i,s){let o=new Qa,r,a;if(n.type===ft.OVERWRITE){let c=n;c.source.fromUser?r=Xa(t,e,c.path,c.snap,i,s,o):(f(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!M(c.path),r=io(t,e,c.path,c.snap,i,s,a,o))}else if(n.type===ft.MERGE){let c=n;c.source.fromUser?r=Uy(t,e,c.path,c.children,i,s,o):(f(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),r=Za(t,e,c.path,c.children,i,s,a,o))}else if(n.type===ft.ACK_USER_WRITE){let c=n;c.revert?r=Gy(t,e,c.path,i,s,o):r=$y(t,e,c.path,c.affectedTree,i,s,o)}else if(n.type===ft.LISTEN_COMPLETE)r=Hy(t,e,n.path,i,o);else throw In("Unknown operation type: "+n.type);let l=o.getChanges();return Vy(e,r,l),{viewCache:r,changes:l}}function Vy(t,e,n){let i=e.eventCache;if(i.isFullyInitialized()){let s=i.getNode().isLeafNode()||i.getNode().isEmpty(),o=eo(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!i.getNode().equals(o)||!i.getNode().getPriority().equals(o.getPriority()))&&n.push(Op(eo(e)))}}function zp(t,e,n,i,s,o){let r=e.eventCache;if(no(i,n)!=null)return e;{let a,l;if(M(n))if(f(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=on(e),u=c instanceof E?c:E.EMPTY_NODE,d=Al(i,u);a=t.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{let c=to(i,on(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,o)}else{let c=R(n);if(c===".priority"){f(Wt(n)===1,"Can't have a priority with additional path components");let u=r.getNode();l=e.serverCache.getNode();let d=Wh(i,n,u,l);d!=null?a=t.filter.updatePriority(u,d):a=r.getNode()}else{let u=U(n),d;if(r.isCompleteForChild(c)){l=e.serverCache.getNode();let h=Wh(i,n,r.getNode(),l);h!=null?d=r.getNode().getImmediateChild(c).updateChild(u,h):d=r.getNode().getImmediateChild(c)}else d=xl(i,c,e.serverCache);d!=null?a=t.filter.updateChild(r.getNode(),c,d,u,s,o):a=r.getNode()}}return Ri(e,a,r.isFullyInitialized()||M(n),t.filter.filtersNodes())}}function io(t,e,n,i,s,o,r,a){let l=e.serverCache,c,u=r?t.filter:t.filter.getIndexedFilter();if(M(n))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){let p=l.getNode().updateChild(n,i);c=u.updateFullNode(l.getNode(),p,null)}else{let p=R(n);if(!l.isCompleteForPath(n)&&Wt(n)>1)return e;let y=U(n),I=l.getNode().getImmediateChild(p).updateChild(y,i);p===".priority"?c=u.updatePriority(l.getNode(),I):c=u.updateChild(l.getNode(),p,I,y,Lp,null)}let d=Np(e,c,l.isFullyInitialized()||M(n),u.filtersNodes()),h=new zi(s,d,o);return zp(t,d,n,s,h,a)}function Xa(t,e,n,i,s,o,r){let a=e.eventCache,l,c,u=new zi(s,e,o);if(M(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,r),l=Ri(e,c,!0,t.filter.filtersNodes());else{let d=R(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),i),l=Ri(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=U(n),p=a.getNode().getImmediateChild(d),y;if(M(h))y=i;else{let S=u.getCompleteChild(d);S!=null?Sl(h)===".priority"&&S.getChild(Sp(h)).isEmpty()?y=S:y=S.updateChild(h,i):y=E.EMPTY_NODE}if(p.equals(y))l=e;else{let S=t.filter.updateChild(a.getNode(),d,y,h,u,r);l=Ri(e,S,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function Kh(t,e){return t.eventCache.isCompleteForChild(e)}function Uy(t,e,n,i,s,o,r){let a=e;return i.foreach((l,c)=>{let u=K(n,l);Kh(e,R(u))&&(a=Xa(t,a,u,c,s,o,r))}),i.foreach((l,c)=>{let u=K(n,l);Kh(e,R(u))||(a=Xa(t,a,u,c,s,o,r))}),a}function qh(t,e,n){return n.foreach((i,s)=>{e=e.updateChild(i,s)}),e}function Za(t,e,n,i,s,o,r,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;M(n)?c=i:c=new Ie(null).setTree(n,i);let u=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(u.hasChild(d)){let p=e.serverCache.getNode().getImmediateChild(d),y=qh(t,p,h);l=io(t,l,new F(d),y,s,o,r,a)}}),c.children.inorderTraversal((d,h)=>{let p=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!u.hasChild(d)&&!p){let y=e.serverCache.getNode().getImmediateChild(d),S=qh(t,y,h);l=io(t,l,new F(d),S,s,o,r,a)}}),l}function $y(t,e,n,i,s,o,r){if(no(s,n)!=null)return e;let a=e.serverCache.isFiltered(),l=e.serverCache;if(i.value!=null){if(M(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return io(t,e,n,l.getNode().getChild(n),s,o,a,r);if(M(n)){let c=new Ie(null);return l.getNode().forEachChild(mt,(u,d)=>{c=c.set(new F(u),d)}),Za(t,e,n,c,s,o,a,r)}else return e}else{let c=new Ie(null);return i.foreach((u,d)=>{let h=K(n,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),Za(t,e,n,c,s,o,a,r)}}function Hy(t,e,n,i,s){let o=e.serverCache,r=Np(e,o.getNode(),o.isFullyInitialized()||M(n),o.isFiltered());return zp(t,r,n,i,Lp,s)}function Gy(t,e,n,i,s,o){let r;if(no(i,n)!=null)return e;{let a=new zi(i,e,s),l=e.eventCache.getNode(),c;if(M(n)||R(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=to(i,on(e));else{let d=e.serverCache.getNode();f(d instanceof E,"serverChildren would be complete if leaf node"),u=Al(i,d)}u=u,c=t.filter.updateFullNode(l,u,o)}else{let u=R(n),d=xl(i,u,e.serverCache);d==null&&e.serverCache.isCompleteForChild(u)&&(d=l.getImmediateChild(u)),d!=null?c=t.filter.updateChild(l,u,d,U(n),a,o):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,E.EMPTY_NODE,U(n),a,o):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(r=to(i,on(e)),r.isLeafNode()&&(c=t.filter.updateFullNode(c,r,o)))}return r=e.serverCache.isFullyInitialized()||no(i,P())!=null,Ri(e,c,r,t.filter.filtersNodes())}}var el=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let i=this.query_._queryParams,s=new Fi(i.getIndex()),o=dy(i);this.processor_=By(o);let r=n.serverCache,a=n.eventCache,l=s.updateFullNode(E.EMPTY_NODE,r.getNode(),null),c=o.updateFullNode(E.EMPTY_NODE,a.getNode(),null),u=new gt(l,r.isFullyInitialized(),s.filtersNodes()),d=new gt(c,a.isFullyInitialized(),o.filtersNodes());this.viewCache_=yo(d,u),this.eventGenerator_=new Wa(this.query_)}get query(){return this.query_}};function jy(t){return t.viewCache_.serverCache.getNode()}function Wy(t){return eo(t.viewCache_)}function Ky(t,e){let n=on(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!M(e)&&!n.getImmediateChild(R(e)).isEmpty())?n.getChild(e):null}function Yh(t){return t.eventRegistrations_.length===0}function qy(t,e){t.eventRegistrations_.push(e)}function Qh(t,e,n){let i=[];if(n){f(e==null,"A cancel should cancel all event registrations.");let s=t.query._path;t.eventRegistrations_.forEach(o=>{let r=o.createCancelEvent(n,s);r&&i.push(r)})}if(e){let s=[];for(let o=0;o<t.eventRegistrations_.length;++o){let r=t.eventRegistrations_[o];if(!r.matches(e))s.push(r);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(o+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return i}function Jh(t,e,n,i){e.type===ft.MERGE&&e.source.queryId!==null&&(f(on(t.viewCache_),"We should always have a full cache before handling merges"),f(eo(t.viewCache_),"Missing event cache, even though we have a server cache"));let s=t.viewCache_,o=zy(t.processor_,s,e,n,i);return Ly(t.processor_,o.viewCache),f(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=o.viewCache,Vp(t,o.changes,o.viewCache.eventCache.getNode(),null)}function Yy(t,e){let n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(H,(o,r)=>{i.push(Vn(o,r))}),n.isFullyInitialized()&&i.push(Op(n.getNode())),Vp(t,i,n.getNode(),e)}function Vp(t,e,n,i){let s=i?[i]:t.eventRegistrations_;return vy(t.eventGenerator_,e,n,s)}var so,oo=class{constructor(){this.views=new Map}};function Qy(t){f(!so,"__referenceConstructor has already been defined"),so=t}function Jy(){return f(so,"Reference.ts has not been loaded"),so}function Xy(t){return t.views.size===0}function Pl(t,e,n,i){let s=e.source.queryId;if(s!==null){let o=t.views.get(s);return f(o!=null,"SyncTree gave us an op for an invalid query."),Jh(o,e,n,i)}else{let o=[];for(let r of t.views.values())o=o.concat(Jh(r,e,n,i));return o}}function Up(t,e,n,i,s){let o=e._queryIdentifier,r=t.views.get(o);if(!r){let a=to(n,s?i:null),l=!1;a?l=!0:i instanceof E?(a=Al(n,i),l=!1):(a=E.EMPTY_NODE,l=!1);let c=yo(new gt(a,l,!1),new gt(i,s,!1));return new el(e,c)}return r}function Zy(t,e,n,i,s,o){let r=Up(t,e,i,s,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,r),qy(r,n),Yy(r,n)}function ev(t,e,n,i){let s=e._queryIdentifier,o=[],r=[],a=Kt(t);if(s==="default")for(let[l,c]of t.views.entries())r=r.concat(Qh(c,n,i)),Yh(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||o.push(c.query));else{let l=t.views.get(s);l&&(r=r.concat(Qh(l,n,i)),Yh(l)&&(t.views.delete(s),l.query._queryParams.loadsAllData()||o.push(l.query)))}return a&&!Kt(t)&&o.push(new(Jy())(e._repo,e._path)),{removed:o,events:r}}function $p(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Gt(t,e){let n=null;for(let i of t.views.values())n=n||Ky(i,e);return n}function Hp(t,e){if(e._queryParams.loadsAllData())return bo(t);{let i=e._queryIdentifier;return t.views.get(i)}}function Gp(t,e){return Hp(t,e)!=null}function Kt(t){return bo(t)!=null}function bo(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var ro;function tv(t){f(!ro,"__referenceConstructor has already been defined"),ro=t}function nv(){return f(ro,"Reference.ts has not been loaded"),ro}var iv=1,ao=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ie(null),this.pendingWriteTree_=Py(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function Fl(t,e,n,i,s){return Cy(t.pendingWriteTree_,e,n,i,s),s?Kn(t,new Un(kl(),e,n)):[]}function sv(t,e,n,i){Ey(t.pendingWriteTree_,e,n,i);let s=Ie.fromObject(n);return Kn(t,new Li(kl(),e,s))}function $t(t,e,n=!1){let i=Sy(t.pendingWriteTree_,e);if(Dy(t.pendingWriteTree_,e)){let o=new Ie(null);return i.snap!=null?o=o.set(P(),!0):ce(i.children,r=>{o=o.set(new F(r),!0)}),Kn(t,new ja(i.path,o,n))}else return[]}function qi(t,e,n){return Kn(t,new Un(Ol(),e,n))}function ov(t,e,n){let i=Ie.fromObject(n);return Kn(t,new Li(Ol(),e,i))}function rv(t,e){return Kn(t,new Zs(Ol(),e))}function av(t,e,n){let i=Bl(t,n);if(i){let s=Ll(i),o=s.path,r=s.queryId,a=De(o,e),l=new Zs(Nl(r),a);return zl(t,o,l)}else return[]}function lo(t,e,n,i,s=!1){let o=e._path,r=t.syncPointTree_.get(o),a=[];if(r&&(e._queryIdentifier==="default"||Gp(r,e))){let l=ev(r,e,n,i);Xy(r)&&(t.syncPointTree_=t.syncPointTree_.remove(o));let c=l.removed;if(a=l.events,!s){let u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(o,(h,p)=>Kt(p));if(u&&!d){let h=t.syncPointTree_.subtree(o);if(!h.isEmpty()){let p=uv(h);for(let y=0;y<p.length;++y){let S=p[y],I=S.query,ie=qp(t,S);t.listenProvider_.startListening(ki(I),Vi(t,I),ie.hashFn,ie.onComplete)}}}!d&&c.length>0&&!i&&(u?t.listenProvider_.stopListening(ki(e),null):c.forEach(h=>{let p=t.queryToTagMap.get(To(h));t.listenProvider_.stopListening(ki(h),p)}))}dv(t,c)}return a}function jp(t,e,n,i){let s=Bl(t,i);if(s!=null){let o=Ll(s),r=o.path,a=o.queryId,l=De(r,e),c=new Un(Nl(a),l,n);return zl(t,r,c)}else return[]}function lv(t,e,n,i){let s=Bl(t,i);if(s){let o=Ll(s),r=o.path,a=o.queryId,l=De(r,e),c=Ie.fromObject(n),u=new Li(Nl(a),l,c);return zl(t,r,u)}else return[]}function tl(t,e,n,i=!1){let s=e._path,o=null,r=!1;t.syncPointTree_.foreachOnPath(s,(h,p)=>{let y=De(h,s);o=o||Gt(p,y),r=r||Kt(p)});let a=t.syncPointTree_.get(s);a?(r=r||Kt(a),o=o||Gt(a,P())):(a=new oo,t.syncPointTree_=t.syncPointTree_.set(s,a));let l;o!=null?l=!0:(l=!1,o=E.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((p,y)=>{let S=Gt(y,P());S&&(o=o.updateImmediateChild(p,S))}));let c=Gp(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=To(e);f(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let p=hv();t.queryToTagMap.set(h,p),t.tagToQueryMap.set(p,h)}let u=vo(t.pendingWriteTree_,s),d=Zy(a,e,n,u,o,l);if(!c&&!r&&!i){let h=Hp(a,e);d=d.concat(pv(t,e,h))}return d}function wo(t,e,n){let s=t.pendingWriteTree_,o=t.syncPointTree_.findOnPath(e,(r,a)=>{let l=De(r,e),c=Gt(a,l);if(c)return c});return Pp(s,e,o,n,!0)}function cv(t,e){let n=e._path,i=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{let d=De(c,n);i=i||Gt(u,d)});let s=t.syncPointTree_.get(n);s?i=i||Gt(s,P()):(s=new oo,t.syncPointTree_=t.syncPointTree_.set(n,s));let o=i!=null,r=o?new gt(i,!0,!1):null,a=vo(t.pendingWriteTree_,e._path),l=Up(s,e,a,o?r.getNode():E.EMPTY_NODE,o);return Wy(l)}function Kn(t,e){return Wp(e,t.syncPointTree_,null,vo(t.pendingWriteTree_,P()))}function Wp(t,e,n,i){if(M(t.path))return Kp(t,e,n,i);{let s=e.get(P());n==null&&s!=null&&(n=Gt(s,P()));let o=[],r=R(t.path),a=t.operationForChild(r),l=e.children.get(r);if(l&&a){let c=n?n.getImmediateChild(r):null,u=Fp(i,r);o=o.concat(Wp(a,l,c,u))}return s&&(o=o.concat(Pl(s,t,i,n))),o}}function Kp(t,e,n,i){let s=e.get(P());n==null&&s!=null&&(n=Gt(s,P()));let o=[];return e.children.inorderTraversal((r,a)=>{let l=n?n.getImmediateChild(r):null,c=Fp(i,r),u=t.operationForChild(r);u&&(o=o.concat(Kp(u,a,l,c)))}),s&&(o=o.concat(Pl(s,t,i,n))),o}function qp(t,e){let n=e.query,i=Vi(t,n);return{hashFn:()=>(jy(e)||E.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?av(t,n._path,i):rv(t,n._path);{let o=C1(s,n);return lo(t,n,null,o)}}}}function Vi(t,e){let n=To(e);return t.queryToTagMap.get(n)}function To(t){return t._path.toString()+"$"+t._queryIdentifier}function Bl(t,e){return t.tagToQueryMap.get(e)}function Ll(t){let e=t.indexOf("$");return f(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new F(t.substr(0,e))}}function zl(t,e,n){let i=t.syncPointTree_.get(e);f(i,"Missing sync point for query tag that we're tracking");let s=vo(t.pendingWriteTree_,e);return Pl(i,n,s,null)}function uv(t){return t.fold((e,n,i)=>{if(n&&Kt(n))return[bo(n)];{let s=[];return n&&(s=$p(n)),ce(i,(o,r)=>{s=s.concat(r)}),s}})}function ki(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(nv())(t._repo,t._path):t}function dv(t,e){for(let n=0;n<e.length;++n){let i=e[n];if(!i._queryParams.loadsAllData()){let s=To(i),o=t.queryToTagMap.get(s);t.queryToTagMap.delete(s),t.tagToQueryMap.delete(o)}}}function hv(){return iv++}function pv(t,e,n){let i=e._path,s=Vi(t,e),o=qp(t,n),r=t.listenProvider_.startListening(ki(e),s,o.hashFn,o.onComplete),a=t.syncPointTree_.subtree(i);if(s)f(!Kt(a.value),"If we're adding a query, it shouldn't be shadowed");else{let l=a.fold((c,u,d)=>{if(!M(c)&&u&&Kt(u))return[bo(u).query];{let h=[];return u&&(h=h.concat($p(u).map(p=>p.query))),ce(d,(p,y)=>{h=h.concat(y)}),h}});for(let c=0;c<l.length;++c){let u=l[c];t.listenProvider_.stopListening(ki(u),Vi(t,u))}}return r}var nl=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},il=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=K(this.path_,e);return new t(this.syncTree_,n)}node(){return wo(this.syncTree_,this.path_)}},fv=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Xh=function(t,e,n){if(!t||typeof t!="object")return t;if(f(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return mv(t[".sv"],e,n);if(typeof t[".sv"]=="object")return _v(t[".sv"],e);f(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},mv=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:f(!1,"Unexpected server value: "+t)}},_v=function(t,e,n){t.hasOwnProperty("increment")||f(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let i=t.increment;typeof i!="number"&&f(!1,"Unexpected increment value: "+i);let s=e.node();if(f(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;let r=s.getValue();return typeof r!="number"?i:r+i},Yp=function(t,e,n,i){return Ul(e,new il(n,t),i)},Vl=function(t,e,n){return Ul(t,new nl(e),n)};function Ul(t,e,n){let i=t.getPriority().val(),s=Xh(i,e.getImmediateChild(".priority"),n),o;if(t.isLeafNode()){let r=t,a=Xh(r.getValue(),e,n);return a!==r.getValue()||s!==r.getPriority().val()?new Ln(a,Y(s)):t}else{let r=t;return o=r,s!==r.getPriority().val()&&(o=o.updatePriority(new Ln(s))),r.forEachChild(H,(a,l)=>{let c=Ul(l,e.getImmediateChild(a),n);c!==l&&(o=o.updateImmediateChild(a,c))}),o}}var Ui=class{constructor(e="",n=null,i={children:{},childCount:0}){this.name=e,this.parent=n,this.node=i}};function Co(t,e){let n=e instanceof F?e:new F(e),i=t,s=R(n);for(;s!==null;){let o=Ft(i.node.children,s)||{children:{},childCount:0};i=new Ui(s,i,o),n=U(n),s=R(n)}return i}function ln(t){return t.node.value}function $l(t,e){t.node.value=e,sl(t)}function Qp(t){return t.node.childCount>0}function gv(t){return ln(t)===void 0&&!Qp(t)}function Eo(t,e){ce(t.node.children,(n,i)=>{e(new Ui(n,t,i))})}function Jp(t,e,n,i){n&&!i&&e(t),Eo(t,s=>{Jp(s,e,!0,i)}),n&&i&&e(t)}function yv(t,e,n){let i=n?t:t.parent;for(;i!==null;){if(e(i))return!0;i=i.parent}return!1}function Yi(t){return new F(t.parent===null?t.name:Yi(t.parent)+"/"+t.name)}function sl(t){t.parent!==null&&vv(t.parent,t.name,t)}function vv(t,e,n){let i=gv(n),s=We(t.node.children,e);i&&s?(delete t.node.children[e],t.node.childCount--,sl(t)):!i&&!s&&(t.node.children[e]=n.node,t.node.childCount++,sl(t))}var bv=/[\[\].#$\/\u0000-\u001F\u007F]/,wv=/[\[\].#$\u0000-\u001F\u007F]/,ma=10*1024*1024,So=function(t){return typeof t=="string"&&t.length!==0&&!bv.test(t)},Xp=function(t){return typeof t=="string"&&t.length!==0&&!wv.test(t)},Tv=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Xp(t)},$i=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!_o(t)||t&&typeof t=="object"&&We(t,".sv")},yt=function(t,e,n,i){i&&e===void 0||Qi(Oe(t,"value"),e,n)},Qi=function(t,e,n){let i=n instanceof F?new Ra(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+tn(i));if(typeof e=="function")throw new Error(t+"contains a function "+tn(i)+" with contents = "+e.toString());if(_o(e))throw new Error(t+"contains "+e.toString()+" "+tn(i));if(typeof e=="string"&&e.length>ma/3&&ui(e)>ma)throw new Error(t+"contains a string greater than "+ma+" utf8 bytes "+tn(i)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let s=!1,o=!1;if(ce(e,(r,a)=>{if(r===".value")s=!0;else if(r!==".priority"&&r!==".sv"&&(o=!0,!So(r)))throw new Error(t+" contains an invalid key ("+r+") "+tn(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);X1(i,r),Qi(t,a,i),Z1(i)}),s&&o)throw new Error(t+' contains ".value" child '+tn(i)+" in addition to actual children.")}},Cv=function(t,e){let n,i;for(n=0;n<e.length;n++){i=e[n];let o=Ni(i);for(let r=0;r<o.length;r++)if(!(o[r]===".priority"&&r===o.length-1)){if(!So(o[r]))throw new Error(t+"contains an invalid key ("+o[r]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(J1);let s=null;for(n=0;n<e.length;n++){if(i=e[n],s!==null&&qe(s,i))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},Zp=function(t,e,n,i){if(i&&e===void 0)return;let s=Oe(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(s+" must be an object containing the children to replace.");let o=[];ce(e,(r,a)=>{let l=new F(r);if(Qi(s,a,K(n,l)),Sl(l)===".priority"&&!$i(a))throw new Error(s+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(l)}),Cv(s,o)},Hl=function(t,e,n){if(!(n&&e===void 0)){if(_o(e))throw new Error(Oe(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!$i(e))throw new Error(Oe(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ji=function(t,e,n,i){if(!(i&&n===void 0)&&!So(n))throw new Error(Oe(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},qn=function(t,e,n,i){if(!(i&&n===void 0)&&!Xp(n))throw new Error(Oe(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},Ev=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),qn(t,e,n,i)},Fe=function(t,e){if(R(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},ef=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!So(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Tv(n))throw new Error(Oe(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var ol=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Do(t,e){let n=null;for(let i=0;i<e.length;i++){let s=e[i],o=s.getPath();n!==null&&!Dl(o,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:o}),n.events.push(s)}n&&t.eventLists_.push(n)}function tf(t,e,n){Do(t,n),nf(t,i=>Dl(i,e))}function Be(t,e,n){Do(t,n),nf(t,i=>qe(i,e)||qe(e,i))}function nf(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){let s=t.eventLists_[i];if(s){let o=s.path;e(o)?(Sv(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function Sv(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let i=n.getEventRunner();sn&&le("event: "+n.toString()),jn(i)}}}var sf="repo_interrupt",Dv=25,rl=class{constructor(e,n,i,s){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ol,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Xs(),this.transactionQueueTree_=new Ui,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function Iv(t,e,n){if(t.stats_=El(t.repoInfo_),t.forceRestClient_||I1())t.server_=new za(t.repoInfo_,(i,s,o,r)=>{Zh(t,i,s,o,r)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>ep(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ee(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Il(t.repoInfo_,e,(i,s,o,r)=>{Zh(t,i,s,o,r)},i=>{ep(t,i)},i=>{Rv(t,i)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(i=>{t.server_.refreshAuthToken(i)}),t.appCheckProvider_.addTokenChangeListener(i=>{t.server_.refreshAppCheckToken(i.token)}),t.statsReporter_=M1(t.repoInfo_,()=>new Ga(t.stats_,t.server_)),t.infoData_=new Va,t.infoSyncTree_=new ao({startListening:(i,s,o,r)=>{let a=[],l=t.infoData_.getNode(i._path);return l.isEmpty()||(a=qi(t.infoSyncTree_,i._path,l),setTimeout(()=>{r("ok")},0)),a},stopListening:()=>{}}),Gl(t,"connected",!1),t.serverSyncTree_=new ao({startListening:(i,s,o,r)=>(t.server_.listen(i,o,s,(a,l)=>{let c=r(a,l);Be(t.eventQueue_,i._path,c)}),[]),stopListening:(i,s)=>{t.server_.unlisten(i,s)}})}function of(t){let n=t.infoData_.getNode(new F(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Xi(t){return fv({timestamp:of(t)})}function Zh(t,e,n,i,s){t.dataUpdateCount++;let o=new F(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let r=[];if(s)if(i){let l=ci(n,c=>Y(c));r=lv(t.serverSyncTree_,o,l,s)}else{let l=Y(n);r=jp(t.serverSyncTree_,o,l,s)}else if(i){let l=ci(n,c=>Y(c));r=ov(t.serverSyncTree_,o,l)}else{let l=Y(n);r=qi(t.serverSyncTree_,o,l)}let a=o;r.length>0&&(a=Hn(t,o)),Be(t.eventQueue_,a,r)}function ep(t,e){Gl(t,"connected",e),e===!1&&Ov(t)}function Rv(t,e){ce(e,(n,i)=>{Gl(t,n,i)})}function Gl(t,e,n){let i=new F("/.info/"+e),s=Y(n);t.infoData_.updateSnapshot(i,s);let o=qi(t.infoSyncTree_,i,s);Be(t.eventQueue_,i,o)}function Io(t){return t.nextWriteId_++}function Mv(t,e,n){let i=cv(t.serverSyncTree_,e);return i!=null?Promise.resolve(i):t.server_.get(e).then(s=>{let o=Y(s).withIndex(e._queryParams.getIndex());tl(t.serverSyncTree_,e,n,!0);let r;if(e._queryParams.loadsAllData())r=qi(t.serverSyncTree_,e._path,o);else{let a=Vi(t.serverSyncTree_,e);r=jp(t.serverSyncTree_,e._path,o,a)}return Be(t.eventQueue_,e._path,r),lo(t.serverSyncTree_,e,n,null,!0),o},s=>(Yn(t,"get for query "+ee(e)+" failed: "+s),Promise.reject(new Error(s))))}function jl(t,e,n,i,s){Yn(t,"set",{path:e.toString(),value:n,priority:i});let o=Xi(t),r=Y(n,i),a=wo(t.serverSyncTree_,e),l=Vl(r,a,o),c=Io(t),u=Fl(t.serverSyncTree_,e,l,c,!0);Do(t.eventQueue_,u),t.server_.put(e.toString(),r.val(!0),(h,p)=>{let y=h==="ok";y||me("set at "+e+" failed: "+h);let S=$t(t.serverSyncTree_,c,!y);Be(t.eventQueue_,e,S),qt(t,s,h,p)});let d=Kl(t,e);Hn(t,d),Be(t.eventQueue_,d,[])}function kv(t,e,n,i){Yn(t,"update",{path:e.toString(),value:n});let s=!0,o=Xi(t),r={};if(ce(n,(a,l)=>{s=!1,r[a]=Yp(K(e,a),Y(l),t.serverSyncTree_,o)}),s)le("update() called with empty data.  Don't do anything."),qt(t,i,"ok",void 0);else{let a=Io(t),l=sv(t.serverSyncTree_,e,r,a);Do(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,u)=>{let d=c==="ok";d||me("update at "+e+" failed: "+c);let h=$t(t.serverSyncTree_,a,!d),p=h.length>0?Hn(t,e):e;Be(t.eventQueue_,p,h),qt(t,i,c,u)}),ce(n,c=>{let u=Kl(t,K(e,c));Hn(t,u)}),Be(t.eventQueue_,e,[])}}function Ov(t){Yn(t,"onDisconnectEvents");let e=Xi(t),n=Xs();$a(t.onDisconnect_,P(),(s,o)=>{let r=Yp(s,o,t.serverSyncTree_,e);Wn(n,s,r)});let i=[];$a(n,P(),(s,o)=>{i=i.concat(qi(t.serverSyncTree_,s,o));let r=Kl(t,s);Hn(t,r)}),t.onDisconnect_=Xs(),Be(t.eventQueue_,P(),i)}function Nv(t,e,n){t.server_.onDisconnectCancel(e.toString(),(i,s)=>{i==="ok"&&Ua(t.onDisconnect_,e),qt(t,n,i,s)})}function tp(t,e,n,i){let s=Y(n);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,r)=>{o==="ok"&&Wn(t.onDisconnect_,e,s),qt(t,i,o,r)})}function Av(t,e,n,i,s){let o=Y(n,i);t.server_.onDisconnectPut(e.toString(),o.val(!0),(r,a)=>{r==="ok"&&Wn(t.onDisconnect_,e,o),qt(t,s,r,a)})}function xv(t,e,n,i){if(vs(n)){le("onDisconnect().update() called with empty data.  Don't do anything."),qt(t,i,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(s,o)=>{s==="ok"&&ce(n,(r,a)=>{let l=Y(a);Wn(t.onDisconnect_,K(e,r),l)}),qt(t,i,s,o)})}function Pv(t,e,n){let i;R(e._path)===".info"?i=tl(t.infoSyncTree_,e,n):i=tl(t.serverSyncTree_,e,n),tf(t.eventQueue_,e._path,i)}function al(t,e,n){let i;R(e._path)===".info"?i=lo(t.infoSyncTree_,e,n):i=lo(t.serverSyncTree_,e,n),tf(t.eventQueue_,e._path,i)}function rf(t){t.persistentConnection_&&t.persistentConnection_.interrupt(sf)}function Fv(t){t.persistentConnection_&&t.persistentConnection_.resume(sf)}function Yn(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),le(n,...e)}function qt(t,e,n,i){e&&jn(()=>{if(n==="ok")e(null);else{let s=(n||"error").toUpperCase(),o=s;i&&(o+=": "+i);let r=new Error(o);r.code=s,e(r)}})}function Bv(t,e,n,i,s,o){Yn(t,"transaction on "+e);let r={path:e,update:n,onComplete:i,status:null,order:sp(),applyLocally:o,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Wl(t,e,void 0);r.currentInputSnapshot=a;let l=r.update(a.val());if(l===void 0)r.unwatcher(),r.currentOutputSnapshotRaw=null,r.currentOutputSnapshotResolved=null,r.onComplete&&r.onComplete(null,!1,r.currentInputSnapshot);else{Qi("transaction failed: Data returned ",l,r.path),r.status=0;let c=Co(t.transactionQueueTree_,e),u=ln(c)||[];u.push(r),$l(c,u);let d;typeof l=="object"&&l!==null&&We(l,".priority")?(d=Ft(l,".priority"),f($i(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(wo(t.serverSyncTree_,e)||E.EMPTY_NODE).getPriority().val();let h=Xi(t),p=Y(l,d),y=Vl(p,a,h);r.currentOutputSnapshotRaw=p,r.currentOutputSnapshotResolved=y,r.currentWriteId=Io(t);let S=Fl(t.serverSyncTree_,e,y,r.currentWriteId,r.applyLocally);Be(t.eventQueue_,e,S),Ro(t,t.transactionQueueTree_)}}function Wl(t,e,n){return wo(t.serverSyncTree_,e,n)||E.EMPTY_NODE}function Ro(t,e=t.transactionQueueTree_){if(e||Mo(t,e),ln(e)){let n=lf(t,e);f(n.length>0,"Sending zero length transaction queue"),n.every(s=>s.status===0)&&Lv(t,Yi(e),n)}else Qp(e)&&Eo(e,n=>{Ro(t,n)})}function Lv(t,e,n){let i=n.map(c=>c.currentWriteId),s=Wl(t,e,i),o=s,r=s.hash();for(let c=0;c<n.length;c++){let u=n[c];f(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;let d=De(e,u.path);o=o.updateChild(d,u.currentOutputSnapshotRaw)}let a=o.val(!0),l=e;t.server_.put(l.toString(),a,c=>{Yn(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat($t(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Mo(t,Co(t.transactionQueueTree_,e)),Ro(t,t.transactionQueueTree_),Be(t.eventQueue_,e,u);for(let h=0;h<d.length;h++)jn(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{me("transaction at "+l.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}Hn(t,e)}},r)}function Hn(t,e){let n=af(t,e),i=Yi(n),s=lf(t,n);return zv(t,s,i),i}function zv(t,e,n){if(e.length===0)return;let i=[],s=[],r=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let l=e[a],c=De(n,l.path),u=!1,d;if(f(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,d=l.abortReason,s=s.concat($t(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Dv)u=!0,d="maxretry",s=s.concat($t(t.serverSyncTree_,l.currentWriteId,!0));else{let h=Wl(t,l.path,r);l.currentInputSnapshot=h;let p=e[a].update(h.val());if(p!==void 0){Qi("transaction failed: Data returned ",p,l.path);let y=Y(p);typeof p=="object"&&p!=null&&We(p,".priority")||(y=y.updatePriority(h.getPriority()));let I=l.currentWriteId,ie=Xi(t),_e=Vl(y,h,ie);l.currentOutputSnapshotRaw=y,l.currentOutputSnapshotResolved=_e,l.currentWriteId=Io(t),r.splice(r.indexOf(I),1),s=s.concat(Fl(t.serverSyncTree_,l.path,_e,l.currentWriteId,l.applyLocally)),s=s.concat($t(t.serverSyncTree_,I,!0))}else u=!0,d="nodata",s=s.concat($t(t.serverSyncTree_,l.currentWriteId,!0))}Be(t.eventQueue_,n,s),s=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?i.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):i.push(()=>e[a].onComplete(new Error(d),!1,null))))}Mo(t,t.transactionQueueTree_);for(let a=0;a<i.length;a++)jn(i[a]);Ro(t,t.transactionQueueTree_)}function af(t,e){let n,i=t.transactionQueueTree_;for(n=R(e);n!==null&&ln(i)===void 0;)i=Co(i,n),e=U(e),n=R(e);return i}function lf(t,e){let n=[];return cf(t,e,n),n.sort((i,s)=>i.order-s.order),n}function cf(t,e,n){let i=ln(e);if(i)for(let s=0;s<i.length;s++)n.push(i[s]);Eo(e,s=>{cf(t,s,n)})}function Mo(t,e){let n=ln(e);if(n){let i=0;for(let s=0;s<n.length;s++)n[s].status!==2&&(n[i]=n[s],i++);n.length=i,$l(e,n.length>0?n:void 0)}Eo(e,i=>{Mo(t,i)})}function Kl(t,e){let n=Yi(af(t,e)),i=Co(t.transactionQueueTree_,e);return yv(i,s=>{_a(t,s)}),_a(t,i),Jp(i,s=>{_a(t,s)}),n}function _a(t,e){let n=ln(e);if(n){let i=[],s=[],o=-1;for(let r=0;r<n.length;r++)n[r].status===3||(n[r].status===1?(f(o===r-1,"All SENT items should be at beginning of queue."),o=r,n[r].status=3,n[r].abortReason="set"):(f(n[r].status===0,"Unexpected transaction status in abort"),n[r].unwatcher(),s=s.concat($t(t.serverSyncTree_,n[r].currentWriteId,!0)),n[r].onComplete&&i.push(n[r].onComplete.bind(null,new Error("set"),!1,null))));o===-1?$l(e,void 0):n.length=o+1,Be(t.eventQueue_,Yi(e),s);for(let r=0;r<i.length;r++)jn(i[r])}}function Vv(t){let e="",n=t.split("/");for(let i=0;i<n.length;i++)if(n[i].length>0){let s=n[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}e+="/"+s}return e}function Uv(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let i=n.split("=");i.length===2?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):me(`Invalid query segment '${n}' in query '${t}'`)}return e}var ll=function(t,e){let n=$v(t),i=n.namespace;n.domain==="firebase.com"&&_t(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&n.domain!=="localhost"&&_t("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||y1();let s=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Gs(n.host,n.secure,i,s,e,"",i!==n.subdomain),path:new F(n.pathString)}},$v=function(t){let e="",n="",i="",s="",o="",r=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(u,d)),u<d&&(s=Vv(t.substring(u,d)));let h=Uv(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(r=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;let p=e.slice(0,c);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{let y=e.indexOf(".");i=e.substring(0,y).toLowerCase(),n=e.substring(y+1),o=i}"ns"in h&&(o=h.ns)}return{host:e,port:l,domain:n,subdomain:i,secure:r,scheme:a,pathString:s,namespace:o}};var np="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Hv=function(){let t=0,e=[];return function(n){let i=n===t;t=n;let s,o=new Array(8);for(s=7;s>=0;s--)o[s]=np.charAt(n%64),n=Math.floor(n/64);f(n===0,"Cannot push at time == 0");let r=o.join("");if(i){for(s=11;s>=0&&e[s]===63;s--)e[s]=0;e[s]++}else for(s=0;s<12;s++)e[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)r+=np.charAt(e[s]);return f(r.length===20,"nextPushId: Length should be 20."),r}}();var co=class{constructor(e,n,i,s){this.eventType=e,this.eventRegistration=n,this.snapshot=i,this.prevName=s}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ee(this.snapshot.exportVal())}},uo=class{constructor(e,n,i){this.eventRegistration=e,this.error=n,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Hi=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return f(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var ho=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new ae;return Nv(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Fe("OnDisconnect.remove",this._path);let e=new ae;return tp(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Fe("OnDisconnect.set",this._path),yt("OnDisconnect.set",e,this._path,!1);let n=new ae;return tp(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Fe("OnDisconnect.setWithPriority",this._path),yt("OnDisconnect.setWithPriority",e,this._path,!1),Hl("OnDisconnect.setWithPriority",n,!1);let i=new ae;return Av(this._repo,this._path,e,n,i.wrapCallback(()=>{})),i.promise}update(e){Fe("OnDisconnect.update",this._path),Zp("OnDisconnect.update",e,this._path,!1);let n=new ae;return xv(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Re=class t{constructor(e,n,i,s){this._repo=e,this._path=n,this._queryParams=i,this._orderByCalled=s}get key(){return M(this._path)?null:Sl(this._path)}get ref(){return new Le(this._repo,this._path)}get _queryIdentifier(){let e=$h(this._queryParams),n=Cl(e);return n==="{}"?"default":n}get _queryObject(){return $h(this._queryParams)}isEqual(e){if(e=$(e),!(e instanceof t))return!1;let n=this._repo===e._repo,i=Dl(this._path,e._path),s=this._queryIdentifier===e._queryIdentifier;return n&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+Q1(this._path)}};function ko(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Qt(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===mt){let i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",s="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==jt)throw new Error(i);if(typeof e!="string")throw new Error(s)}if(t.hasEnd()){if(t.getIndexEndName()!==Nt)throw new Error(i);if(typeof n!="string")throw new Error(s)}}else if(t.getIndex()===H){if(e!=null&&!$i(e)||n!=null&&!$i(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(f(t.getIndex()instanceof Ai||t.getIndex()===Ml,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Oo(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Le=class t extends Re{constructor(e,n){super(e,n,new Bi,!1)}get parent(){let e=Sp(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Gn=class t{constructor(e,n,i){this._node=e,this.ref=n,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new F(e),i=Yt(this.ref,e);return new t(this._node.getChild(n),i,H)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>e(new t(s,Yt(this.ref,i),H)))}hasChild(e){let n=new F(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function ql(t,e){return t=$(t),t._checkNotDeleted("ref"),e!==void 0?Yt(t._root,e):t._root}function Yl(t,e){t=$(t),t._checkNotDeleted("refFromURL");let n=ll(e,t._repo.repoInfo_.nodeAdmin);ef("refFromURL",n);let i=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&i.host!==t._repo.repoInfo_.host&&_t("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+t._repo.repoInfo_.host+")"),ql(t,n.path.toString())}function Yt(t,e){return t=$(t),R(t._path)===null?Ev("child","path",e,!1):qn("child","path",e,!1),new Le(t._repo,K(t._path,e))}function uf(t,e){t=$(t),Fe("push",t._path),yt("push",e,t._path,!0);let n=of(t._repo),i=Hv(n),s=Yt(t,i),o=Yt(t,i),r;return e!=null?r=No(o,e).then(()=>o):r=Promise.resolve(o),s.then=r.then.bind(r),s.catch=r.then.bind(r,void 0),s}function df(t){return Fe("remove",t._path),No(t,null)}function No(t,e){t=$(t),Fe("set",t._path),yt("set",e,t._path,!1);let n=new ae;return jl(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function hf(t,e){t=$(t),Fe("setPriority",t._path),Hl("setPriority",e,!1);let n=new ae;return jl(t._repo,K(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function pf(t,e,n){if(Fe("setWithPriority",t._path),yt("setWithPriority",e,t._path,!1),Hl("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let i=new ae;return jl(t._repo,t._path,e,n,i.wrapCallback(()=>{})),i.promise}function ff(t,e){Zp("update",e,t._path,!1);let n=new ae;return kv(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function mf(t){t=$(t);let e=new Hi(()=>{}),n=new Gi(e);return Mv(t._repo,t,n).then(i=>new Gn(i,new Le(t._repo,t._path),t._queryParams.getIndex()))}var Gi=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let i=n._queryParams.getIndex();return new co("value",this,new Gn(e.snapshotNode,new Le(n._repo,n._path),i))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new uo(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},po=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new uo(this,e,n):null}createEvent(e,n){f(e.childName!=null,"Child events should have a childName.");let i=Yt(new Le(n._repo,n._path),e.childName),s=n._queryParams.getIndex();return new co(e.type,this,new Gn(e.snapshotNode,i,s),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Zi(t,e,n,i,s){let o;if(typeof i=="object"&&(o=void 0,s=i),typeof i=="function"&&(o=i),s&&s.onlyOnce){let l=n,c=(u,d)=>{al(t._repo,t,a),l(u,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let r=new Hi(n,o||void 0),a=e==="value"?new Gi(r):new po(e,r);return Pv(t._repo,t,a),()=>al(t._repo,t,a)}function Ao(t,e,n,i){return Zi(t,"value",e,n,i)}function Ql(t,e,n,i){return Zi(t,"child_added",e,n,i)}function Jl(t,e,n,i){return Zi(t,"child_changed",e,n,i)}function Xl(t,e,n,i){return Zi(t,"child_moved",e,n,i)}function Zl(t,e,n,i){return Zi(t,"child_removed",e,n,i)}function ec(t,e,n){let i=null,s=n?new Hi(n):null;e==="value"?i=new Gi(s):e&&(i=new po(e,s)),al(t._repo,t,i)}var ze=class{},fo=class extends ze{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){yt("endAt",this._value,e._path,!0);let n=La(e._queryParams,this._value,this._key);if(Oo(n),Qt(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Re(e._repo,e._path,n,e._orderByCalled)}};function _f(t,e){return Ji("endAt","key",e,!0),new fo(t,e)}var cl=class extends ze{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){yt("endBefore",this._value,e._path,!1);let n=my(e._queryParams,this._value,this._key);if(Oo(n),Qt(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Re(e._repo,e._path,n,e._orderByCalled)}};function gf(t,e){return Ji("endBefore","key",e,!0),new cl(t,e)}var mo=class extends ze{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){yt("startAt",this._value,e._path,!0);let n=Ba(e._queryParams,this._value,this._key);if(Oo(n),Qt(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Re(e._repo,e._path,n,e._orderByCalled)}};function yf(t=null,e){return Ji("startAt","key",e,!0),new mo(t,e)}var ul=class extends ze{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){yt("startAfter",this._value,e._path,!1);let n=fy(e._queryParams,this._value,this._key);if(Oo(n),Qt(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Re(e._repo,e._path,n,e._orderByCalled)}};function vf(t,e){return Ji("startAfter","key",e,!0),new ul(t,e)}var dl=class extends ze{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Re(e._repo,e._path,hy(e._queryParams,this._limit),e._orderByCalled)}};function bf(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new dl(t)}var hl=class extends ze{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Re(e._repo,e._path,py(e._queryParams,this._limit),e._orderByCalled)}};function wf(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new hl(t)}var pl=class extends ze{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){ko(e,"orderByChild");let n=new F(this._path);if(M(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let i=new Ai(n),s=go(e._queryParams,i);return Qt(s),new Re(e._repo,e._path,s,!0)}};function Tf(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return qn("orderByChild","path",t,!1),new pl(t)}var fl=class extends ze{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){ko(e,"orderByKey");let n=go(e._queryParams,mt);return Qt(n),new Re(e._repo,e._path,n,!0)}};function Cf(){return new fl}var ml=class extends ze{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){ko(e,"orderByPriority");let n=go(e._queryParams,H);return Qt(n),new Re(e._repo,e._path,n,!0)}};function Ef(){return new ml}var _l=class extends ze{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){ko(e,"orderByValue");let n=go(e._queryParams,Ml);return Qt(n),new Re(e._repo,e._path,n,!0)}};function Sf(){return new _l}var gl=class extends ze{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(yt("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new fo(this._value,this._key)._apply(new mo(this._value,this._key)._apply(e))}};function Df(t,e){return Ji("equalTo","key",e,!0),new gl(t,e)}function Qe(t,...e){let n=$(t);for(let i of e)n=i._apply(n);return n}Qy(Le);tv(Le);var Gv="FIREBASE_DATABASE_EMULATOR_HOST",yl={},jv=!1;function Wv(t,e,n,i){t.repoInfo_=new Gs(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}function tc(t,e,n,i,s){let o=i||t.options.databaseURL;o===void 0&&(t.options.projectId||_t("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),le("Using default host for project ",t.options.projectId),o=`${t.options.projectId}-default-rtdb.firebaseio.com`);let r=ll(o,s),a=r.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[Gv]),c?(l=!0,o=`http://${c}?ns=${a.namespace}`,r=ll(o,s),a=r.repoInfo):l=!r.repoInfo.secure;let u=s&&l?new Ii(Ii.OWNER):new Ta(t.name,t.options,e);ef("Invalid Firebase Database URL",r),M(r.path)||_t("Database URL must point to the root of a Firebase Database (not including a child path).");let d=qv(a,t,u,new wa(t.name,n));return new vl(d,t)}function Kv(t,e){let n=yl[e];(!n||n[t.key]!==t)&&_t(`Database ${e}(${t.repoInfo_}) has already been deleted.`),rf(t),delete n[t.key]}function qv(t,e,n,i){let s=yl[e.name];s||(s={},yl[e.name]=s);let o=s[t.toURLString()];return o&&_t("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new rl(t,jv,n,i),s[t.toURLString()]=o,o}var vl=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Iv(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Le(this._repo,P())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Kv(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&_t("Cannot call "+e+" on a deleted database.")}};function If(){Ep.IS_TRANSPORT_INITIALIZED&&me("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function Rf(){If(),Oi.forceDisallow()}function Mf(){If(),xn.forceDisallow(),Oi.forceAllow()}function kf(t,e,n,i={}){t=$(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&_t("Cannot call useEmulator() after instance has already been initialized.");let s=t._repoInternal,o;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&_t('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new Ii(Ii.OWNER);else if(i.mockUserToken){let r=typeof i.mockUserToken=="string"?i.mockUserToken:gs(i.mockUserToken,t.app.options.projectId);o=new Ii(r)}Wv(s,e,n,o)}function Of(t){t=$(t),t._checkNotDeleted("goOffline"),rf(t._repo)}function Nf(t){t=$(t),t._checkNotDeleted("goOnline"),Fv(t._repo)}function Af(t,e){rp(t,e)}function Yv(t){Tl(Cs),Te(new ne("database",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return tc(i,s,o,n)},"PUBLIC").setMultipleInstances(!0)),z(Sh,Dh,t),z(Sh,Dh,"esm2017")}var Qv={".sv":"timestamp"};function xf(){return Qv}function Pf(t){return{".sv":{increment:t}}}var bl=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function Ff(t,e,n){var i;if(t=$(t),Fe("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let s=(i=n?.applyLocally)!==null&&i!==void 0?i:!0,o=new ae,r=(l,c,u)=>{let d=null;l?o.reject(l):(d=new Gn(u,new Le(t._repo,t._path),H),o.resolve(new bl(c,d)))},a=Ao(t,()=>{});return Bv(t._repo,t._path,e,r,a,s),o.promise}Il.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Il.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Yv();var Jv="@firebase/database-compat",Xv="1.0.4";var Zv=new Bt("@firebase/database-compat"),Bf=function(t){let e="FIREBASE WARNING: "+t;Zv.warn(e)};var eb=function(t,e,n,i){if(!(i&&n===void 0)&&typeof n!="boolean")throw new Error(Oe(t,e)+"must be a boolean.")},tb=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Oe(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var nc=class{constructor(e){this._delegate=e}cancel(e){C("OnDisconnect.cancel",0,1,arguments.length),te("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),i=>e(i)),n}remove(e){C("OnDisconnect.remove",0,1,arguments.length),te("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),i=>e(i)),n}set(e,n){C("OnDisconnect.set",1,2,arguments.length),te("OnDisconnect.set","onComplete",n,!0);let i=this._delegate.set(e);return n&&i.then(()=>n(null),s=>n(s)),i}setWithPriority(e,n,i){C("OnDisconnect.setWithPriority",2,3,arguments.length),te("OnDisconnect.setWithPriority","onComplete",i,!0);let s=this._delegate.setWithPriority(e,n);return i&&s.then(()=>i(null),o=>i(o)),s}update(e,n){if(C("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,Bf("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}te("OnDisconnect.update","onComplete",n,!0);let i=this._delegate.update(e);return n&&i.then(()=>n(null),s=>n(s)),i}};var ic=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return C("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var cn=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return C("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return C("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return C("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return C("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return C("DataSnapshot.child",0,1,arguments.length),e=String(e),qn("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return C("DataSnapshot.hasChild",1,1,arguments.length),qn("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return C("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return C("DataSnapshot.forEach",1,1,arguments.length),te("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return C("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return C("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return C("DataSnapshot.ref",0,0,arguments.length),new At(this._database,this._delegate.ref)}get ref(){return this.getRef()}},xo=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,i,s){var o;C("Query.on",2,4,arguments.length),te("Query.on","callback",n,!1);let r=t.getCancelAndContextArgs_("Query.on",i,s),a=(c,u)=>{n.call(r.context,new cn(this.database,c),u)};a.userCallback=n,a.context=r.context;let l=(o=r.cancel)===null||o===void 0?void 0:o.bind(r.context);switch(e){case"value":return Ao(this._delegate,a,l),n;case"child_added":return Ql(this._delegate,a,l),n;case"child_removed":return Zl(this._delegate,a,l),n;case"child_changed":return Jl(this._delegate,a,l),n;case"child_moved":return Xl(this._delegate,a,l),n;default:throw new Error(Oe("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,i){if(C("Query.off",0,3,arguments.length),tb("Query.off",e,!0),te("Query.off","callback",n,!0),er("Query.off","context",i,!0),n){let s=()=>{};s.userCallback=n,s.context=i,ec(this._delegate,e,s)}else ec(this._delegate,e)}get(){return mf(this._delegate).then(e=>new cn(this.database,e))}once(e,n,i,s){C("Query.once",1,4,arguments.length),te("Query.once","callback",n,!0);let o=t.getCancelAndContextArgs_("Query.once",i,s),r=new ae,a=(c,u)=>{let d=new cn(this.database,c);n&&n.call(o.context,d,u),r.resolve(d)};a.userCallback=n,a.context=o.context;let l=c=>{o.cancel&&o.cancel.call(o.context,c),r.reject(c)};switch(e){case"value":Ao(this._delegate,a,l,{onlyOnce:!0});break;case"child_added":Ql(this._delegate,a,l,{onlyOnce:!0});break;case"child_removed":Zl(this._delegate,a,l,{onlyOnce:!0});break;case"child_changed":Jl(this._delegate,a,l,{onlyOnce:!0});break;case"child_moved":Xl(this._delegate,a,l,{onlyOnce:!0});break;default:throw new Error(Oe("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return r.promise}limitToFirst(e){return C("Query.limitToFirst",1,1,arguments.length),new t(this.database,Qe(this._delegate,bf(e)))}limitToLast(e){return C("Query.limitToLast",1,1,arguments.length),new t(this.database,Qe(this._delegate,wf(e)))}orderByChild(e){return C("Query.orderByChild",1,1,arguments.length),new t(this.database,Qe(this._delegate,Tf(e)))}orderByKey(){return C("Query.orderByKey",0,0,arguments.length),new t(this.database,Qe(this._delegate,Cf()))}orderByPriority(){return C("Query.orderByPriority",0,0,arguments.length),new t(this.database,Qe(this._delegate,Ef()))}orderByValue(){return C("Query.orderByValue",0,0,arguments.length),new t(this.database,Qe(this._delegate,Sf()))}startAt(e=null,n){return C("Query.startAt",0,2,arguments.length),new t(this.database,Qe(this._delegate,yf(e,n)))}startAfter(e=null,n){return C("Query.startAfter",0,2,arguments.length),new t(this.database,Qe(this._delegate,vf(e,n)))}endAt(e=null,n){return C("Query.endAt",0,2,arguments.length),new t(this.database,Qe(this._delegate,_f(e,n)))}endBefore(e=null,n){return C("Query.endBefore",0,2,arguments.length),new t(this.database,Qe(this._delegate,gf(e,n)))}equalTo(e,n){return C("Query.equalTo",1,2,arguments.length),new t(this.database,Qe(this._delegate,Df(e,n)))}toString(){return C("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return C("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(C("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,i){let s={cancel:void 0,context:void 0};if(n&&i)s.cancel=n,te(e,"cancel",s.cancel,!0),s.context=i,er(e,"context",s.context,!0);else if(n)if(typeof n=="object"&&n!==null)s.context=n;else if(typeof n=="function")s.cancel=n;else throw new Error(Oe(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return s}get ref(){return new At(this.database,new Le(this._delegate._repo,this._delegate._path))}},At=class t extends xo{constructor(e,n){super(e,new Re(n._repo,n._path,new Bi,!1)),this.database=e,this._delegate=n}getKey(){return C("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return C("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Yt(this._delegate,e))}getParent(){C("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return C("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){C("Reference.set",1,2,arguments.length),te("Reference.set","onComplete",n,!0);let i=No(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}update(e,n){if(C("Reference.update",1,2,arguments.length),Array.isArray(e)){let s={};for(let o=0;o<e.length;++o)s[""+o]=e[o];e=s,Bf("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Fe("Reference.update",this._delegate._path),te("Reference.update","onComplete",n,!0);let i=ff(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}setWithPriority(e,n,i){C("Reference.setWithPriority",2,3,arguments.length),te("Reference.setWithPriority","onComplete",i,!0);let s=pf(this._delegate,e,n);return i&&s.then(()=>i(null),o=>i(o)),s}remove(e){C("Reference.remove",0,1,arguments.length),te("Reference.remove","onComplete",e,!0);let n=df(this._delegate);return e&&n.then(()=>e(null),i=>e(i)),n}transaction(e,n,i){C("Reference.transaction",1,3,arguments.length),te("Reference.transaction","transactionUpdate",e,!1),te("Reference.transaction","onComplete",n,!0),eb("Reference.transaction","applyLocally",i,!0);let s=Ff(this._delegate,e,{applyLocally:i}).then(o=>new ic(o.committed,new cn(this.database,o.snapshot)));return n&&s.then(o=>n(null,o.committed,o.snapshot),o=>n(o,!1,null)),s}setPriority(e,n){C("Reference.setPriority",1,2,arguments.length),te("Reference.setPriority","onComplete",n,!0);let i=hf(this._delegate,e);return n&&i.then(()=>n(null),s=>n(s)),i}push(e,n){C("Reference.push",0,2,arguments.length),te("Reference.push","onComplete",n,!0);let i=uf(this._delegate,e),s=i.then(r=>new t(this.database,r));n&&s.then(()=>n(null),r=>n(r));let o=new t(this.database,i);return o.then=s.then.bind(s),o.catch=s.catch.bind(s,void 0),o}onDisconnect(){return Fe("Reference.onDisconnect",this._delegate._path),new nc(new ho(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var un=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:Rf,forceLongPolling:Mf}}useEmulator(e,n,i={}){kf(this._delegate,e,n,i)}ref(e){if(C("database.ref",0,1,arguments.length),e instanceof At){let n=Yl(this._delegate,e.toString());return new At(this,n)}else{let n=ql(this._delegate,e);return new At(this,n)}}refFromURL(e){C("database.refFromURL",1,1,arguments.length);let i=Yl(this._delegate,e);return new At(this,i)}goOffline(){return C("database.goOffline",0,0,arguments.length),Of(this._delegate)}goOnline(){return C("database.goOnline",0,0,arguments.length),Nf(this._delegate)}};un.ServerValue={TIMESTAMP:xf(),increment:t=>Pf(t)};function nb({app:t,url:e,version:n,customAuthImpl:i,customAppCheckImpl:s,namespace:o,nodeAdmin:r=!1}){Tl(n);let a=new tr("database-standalone"),l=new ws("auth-internal",a);l.setComponent(new ne("auth-internal",()=>i,"PRIVATE"));let c;return s&&(c=new ws("app-check-internal",a),c.setComponent(new ne("app-check-internal",()=>s,"PRIVATE"))),{instance:new un(tc(t,l,c,e,r),t),namespace:o}}var ib=Object.freeze({__proto__:null,initStandalone:nb});var sb=un.ServerValue;function ob(t){t.INTERNAL.registerComponent(new ne("database-compat",(e,{instanceIdentifier:n})=>{let i=e.getProvider("app-compat").getImmediate(),s=e.getProvider("database").getImmediate({identifier:n});return new un(s,i)},"PUBLIC").setServiceProps({Reference:At,Query:xo,Database:un,DataSnapshot:cn,enableLogging:Af,INTERNAL:ib,ServerValue:sb}).setMultipleInstances(!0)),t.registerVersion(Jv,Xv)}ob(et);function es(t,e,n="on",i=cc){return new Jt(s=>{let o=null;return o=t[n](e,(r,a)=>{i.schedule(()=>{s.next({snapshot:r,prevKey:a})}),n==="once"&&i.schedule(()=>s.complete())},r=>{i.schedule(()=>s.error(r))}),n==="on"?{unsubscribe(){o!=null&&t.off(e,o)}}:{unsubscribe(){}}}).pipe(ue(s=>{let{snapshot:o,prevKey:r}=s,a=null;return o.exists()&&(a=o.key),{type:e,payload:o,prevKey:r,key:a}}),_c())}function rb(t){return typeof t=="string"}function ab(t){return typeof t.exportVal=="function"}function $f(t){return t==null}function Hf(t){return typeof t.set=="function"}function Lf(t,e){return Hf(e)?e:t.ref(e)}function Gf(t,e){if(rb(t))return e.stringCase();if(Hf(t))return e.firebaseCase();if(ab(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function jf(t){return($f(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function Wf(t,e,n){e=jf(e);let i=e.map(s=>es(t,s,"on",n));return hn(...i)}function lb(t,e,n){let i=Wf(t,e).pipe(Uo((s,o)=>[...s,o],[]));return ub(t,i,n)}function cb(t,e){return es(t,"value","on",e).pipe(ue(n=>{let i;return n.payload.forEach(s=>(i=s.key,!1)),{data:n,lastKeyToLoad:i}}))}function ub(t,e,n){return cb(t,n).pipe(ei(e),ue(([s,o])=>{let r=s.lastKeyToLoad,a=o.map(l=>l.key);return{actions:o,lastKeyToLoad:r,loadedKeys:a}}),gc(s=>s.loadedKeys.indexOf(s.lastKeyToLoad)===-1),ue(s=>s.actions))}function zf(t,e){return function(i,s){return Gf(i,{stringCase:()=>t.child(i)[e](s),firebaseCase:()=>i[e](s),snapshotCase:()=>i.ref[e](s)})}}function db(t){return function(n){return n?Gf(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function hb(t,e,n){return es(t,"value","once",n).pipe(ke(i=>{let s=[ge(i)];return e.forEach(o=>s.push(es(t,o,"on",n))),hn(...s).pipe(Uo(fb,[]))}),Zn())}function Kf(t,e){let n=t.length;for(let i=0;i<n;i++)if(t[i].payload.key===e)return i;return-1}function pb(t,e){if($f(e))return 0;{let n=Kf(t,e);return n===-1?t.length:n+1}}function fb(t,e){let{payload:n,prevKey:i,key:s}=e,o=Kf(t,s),r=pb(t,i);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(l=>{let c={payload:l,type:"value",prevKey:a,key:l.key};return a=l.key,t=[...t,c],!1})}return t;case"child_added":if(o>-1)(t[o-1]?.key||null)!==i&&(t=t.filter(l=>l.payload.key!==n.key),t.splice(r,0,e));else{if(i==null)return[e,...t];t=t.slice(),t.splice(r,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===s?e:a);case"child_moved":if(o>-1){let a=t.splice(o,1)[0];return t=t.slice(),t.splice(r,0,a),t}return t;default:return t}}function Vf(t,e,n){return e=jf(e),hb(t,e,n)}function mb(t,e){let n=e.schedulers.outsideAngular,i=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:zf(i,"update"),set:zf(i,"set"),push:s=>i.push(s),remove:db(i),snapshotChanges(s){return Vf(t,s,n).pipe(Rt)},stateChanges(s){return Wf(t,s,n).pipe(Rt)},auditTrail(s){return lb(t,s,n).pipe(Rt)},valueChanges(s,o){return Vf(t,s,n).pipe(ue(a=>a.map(l=>o&&o.idField?Je(Me({},l.payload.val()),{[o.idField]:l.key}):l.payload.val())),Rt)}}}function Uf(t,e){return function(){return es(t,"value","on",e)}}function _b(t,e){return{query:t,snapshotChanges(){return Uf(t,e.schedulers.outsideAngular)().pipe(Rt)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return Uf(t,e.schedulers.outsideAngular)().pipe(Rt,ue(i=>i.payload.exists()?i.payload.val():null))}}}var gb=new G("angularfire2.realtimeDatabaseURL"),yb=new G("angularfire2.database.use-emulator"),vb=(()=>{class t{schedulers;database;constructor(n,i,s,o,r,a,l,c,u,d,h,p,y,S,I){this.schedulers=a;let ie=l,_e=Vs(n,r,i);c&&ca(_e,r,u,h,p,y,d,S),this.database=Us(`${_e.name}.database.${s}`,"AngularFireDatabase",_e.name,()=>{let x=r.runOutsideAngular(()=>_e.database(s||void 0));return ie&&x.useEmulator(...ie),x},[ie])}list(n,i){let s=this.schedulers.ngZone.runOutsideAngular(()=>Lf(this.database,n)),o=s;return i&&(o=i(s)),mb(o,this)}object(n){let i=this.schedulers.ngZone.runOutsideAngular(()=>Lf(this.database,n));return _b(i,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(i){return new(i||t)(D(Ls),D(zs,8),D(gb,8),D(Tt),D(j),D(Ne),D(yb,8),D(Eh,8),D(ia,8),D(sa,8),D(oa,8),D(ra,8),D(aa,8),D(la,8),D(It,8))};static \u0275prov=ye({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),qf=(()=>{class t{constructor(){et.registerVersion("angularfire",Ce.full,"rtdb-compat")}static \u0275fac=function(i){return new(i||t)};static \u0275mod=N({type:t});static \u0275inj=O({providers:[vb]})}return t})();function bb(t){let e=t,n=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return i===0&&n%10===1&&n%100!==11?1:i===0&&n%10===Math.floor(n%10)&&n%10>=2&&n%10<=4&&!(n%100>=12&&n%100<=14)?3:i===0&&n%10===0||i===0&&n%10===Math.floor(n%10)&&n%10>=5&&n%10<=9||i===0&&n%100===Math.floor(n%100)&&n%100>=11&&n%100<=14?4:5}var Yf=["uk",[["\u0434\u043F","\u043F\u043F"],void 0,void 0],void 0,[["\u041D","\u041F","\u0412","\u0421","\u0427","\u041F","\u0421"],["\u043D\u0434","\u043F\u043D","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043F\u0442","\u0441\u0431"],["\u043D\u0435\u0434\u0456\u043B\u044F","\u043F\u043E\u043D\u0435\u0434\u0456\u043B\u043E\u043A","\u0432\u0456\u0432\u0442\u043E\u0440\u043E\u043A","\u0441\u0435\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440","\u043F\u02BC\u044F\u0442\u043D\u0438\u0446\u044F","\u0441\u0443\u0431\u043E\u0442\u0430"],["\u043D\u0434","\u043F\u043D","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043F\u0442","\u0441\u0431"]],void 0,[["\u0441","\u043B","\u0431","\u043A","\u0442","\u0447","\u043B","\u0441","\u0432","\u0436","\u043B","\u0433"],["\u0441\u0456\u0447.","\u043B\u044E\u0442.","\u0431\u0435\u0440.","\u043A\u0432\u0456\u0442.","\u0442\u0440\u0430\u0432.","\u0447\u0435\u0440\u0432.","\u043B\u0438\u043F.","\u0441\u0435\u0440\u043F.","\u0432\u0435\u0440.","\u0436\u043E\u0432\u0442.","\u043B\u0438\u0441\u0442.","\u0433\u0440\u0443\u0434."],["\u0441\u0456\u0447\u043D\u044F","\u043B\u044E\u0442\u043E\u0433\u043E","\u0431\u0435\u0440\u0435\u0437\u043D\u044F","\u043A\u0432\u0456\u0442\u043D\u044F","\u0442\u0440\u0430\u0432\u043D\u044F","\u0447\u0435\u0440\u0432\u043D\u044F","\u043B\u0438\u043F\u043D\u044F","\u0441\u0435\u0440\u043F\u043D\u044F","\u0432\u0435\u0440\u0435\u0441\u043D\u044F","\u0436\u043E\u0432\u0442\u043D\u044F","\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434\u0430","\u0433\u0440\u0443\u0434\u043D\u044F"]],[["\u0421","\u041B","\u0411","\u041A","\u0422","\u0427","\u041B","\u0421","\u0412","\u0416","\u041B","\u0413"],["\u0441\u0456\u0447","\u043B\u044E\u0442","\u0431\u0435\u0440","\u043A\u0432\u0456","\u0442\u0440\u0430","\u0447\u0435\u0440","\u043B\u0438\u043F","\u0441\u0435\u0440","\u0432\u0435\u0440","\u0436\u043E\u0432","\u043B\u0438\u0441","\u0433\u0440\u0443"],["\u0441\u0456\u0447\u0435\u043D\u044C","\u043B\u044E\u0442\u0438\u0439","\u0431\u0435\u0440\u0435\u0437\u0435\u043D\u044C","\u043A\u0432\u0456\u0442\u0435\u043D\u044C","\u0442\u0440\u0430\u0432\u0435\u043D\u044C","\u0447\u0435\u0440\u0432\u0435\u043D\u044C","\u043B\u0438\u043F\u0435\u043D\u044C","\u0441\u0435\u0440\u043F\u0435\u043D\u044C","\u0432\u0435\u0440\u0435\u0441\u0435\u043D\u044C","\u0436\u043E\u0432\u0442\u0435\u043D\u044C","\u043B\u0438\u0441\u0442\u043E\u043F\u0430\u0434","\u0433\u0440\u0443\u0434\u0435\u043D\u044C"]],[["\u0434\u043E \u043D.\u0435.","\u043D.\u0435."],["\u0434\u043E \u043D. \u0435.","\u043D. \u0435."],["\u0434\u043E \u043D\u0430\u0448\u043E\u0457 \u0435\u0440\u0438","\u043D\u0430\u0448\u043E\u0457 \u0435\u0440\u0438"]],1,[6,0],["dd.MM.yy","d MMM y '\u0440'.","d MMMM y '\u0440'.","EEEE, d MMMM y '\u0440'."],["HH:mm","HH:mm:ss","HH:mm:ss z","HH:mm:ss zzzz"],["{1}, {0}",void 0,"{1} '\u043E' {0}",void 0],[",","\xA0",";","%","+","-","\u0415","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","#,##0.00\xA0\xA4","#E0"],"UAH","\u20B4","\u0443\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430 \u0433\u0440\u0438\u0432\u043D\u044F",{AUD:[void 0,"$"],BRL:[void 0,"R$"],BYN:[void 0,"\u0440."],CAD:[void 0,"$"],CNY:[void 0,"\xA5"],EUR:[void 0,"\u20AC"],GBP:[void 0,"\xA3"],HKD:[void 0,"$"],ILS:[void 0,"\u20AA"],INR:[void 0,"\u20B9"],KRW:[void 0,"\u20A9"],MXN:[void 0,"$"],NZD:[void 0,"$"],PHP:[void 0,"\u20B1"],RUR:[void 0,"\u0440."],TWD:[void 0,"$"],UAH:["\u20B4"],UAK:["\u043A\u0440\u0431."],USD:[void 0,"$"],VND:[void 0,"\u20AB"],XCD:[void 0,"$"]},"ltr",bb];function wb(t){let e=t,n=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return n===1&&i===0?1:5}var Qf=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",wb];function Tb(t){let e=t,n=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return n===1&&i===0?1:n===Math.floor(n)&&n>=2&&n<=4&&i===0?3:i!==0?4:5}var Jf=["cs",[["dop.","odp."],void 0,void 0],void 0,[["N","P","\xDA","S","\u010C","P","S"],["ne","po","\xFAt","st","\u010Dt","p\xE1","so"],["ned\u011Ble","pond\u011Bl\xED","\xFAter\xFD","st\u0159eda","\u010Dtvrtek","p\xE1tek","sobota"],["ne","po","\xFAt","st","\u010Dt","p\xE1","so"]],void 0,[["1","2","3","4","5","6","7","8","9","10","11","12"],["led","\xFAno","b\u0159e","dub","kv\u011B","\u010Dvn","\u010Dvc","srp","z\xE1\u0159","\u0159\xEDj","lis","pro"],["ledna","\xFAnora","b\u0159ezna","dubna","kv\u011Btna","\u010Dervna","\u010Dervence","srpna","z\xE1\u0159\xED","\u0159\xEDjna","listopadu","prosince"]],[["1","2","3","4","5","6","7","8","9","10","11","12"],["led","\xFAno","b\u0159e","dub","kv\u011B","\u010Dvn","\u010Dvc","srp","z\xE1\u0159","\u0159\xEDj","lis","pro"],["leden","\xFAnor","b\u0159ezen","duben","kv\u011Bten","\u010Derven","\u010Dervenec","srpen","z\xE1\u0159\xED","\u0159\xEDjen","listopad","prosinec"]],[["p\u0159.n.l.","n.l."],["p\u0159. n. l.","n. l."],["p\u0159ed na\u0161\xEDm letopo\u010Dtem","na\u0161eho letopo\u010Dtu"]],1,[6,0],["dd.MM.yy","d. M. y","d. MMMM y","EEEE d. MMMM y"],["H:mm","H:mm:ss","H:mm:ss z","H:mm:ss zzzz"],["{1} {0}",void 0,void 0,void 0],[",","\xA0",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0\xA0%","#,##0.00\xA0\xA4","#E0"],"CZK","K\u010D","\u010Desk\xE1 koruna",{AUD:["AU$","$"],BYN:[void 0,"\u0440."],CSK:["K\u010Ds"],CZK:["K\u010D"],ILS:[void 0,"\u20AA"],INR:[void 0,"\u20B9"],JPY:["JP\xA5","\xA5"],PHP:[void 0,"\u20B1"],RON:[void 0,"L"],RUR:[void 0,"\u0440."],TWD:["NT$"],USD:["US$","$"],VND:[void 0,"\u20AB"],XEU:["ECU"],XXX:[]},"ltr",Tb];var Eb=["*"];var Sb=["dialog"];var Xf={animation:!0,transitionTimerDelayMs:5},Db=(()=>{let e=class e{constructor(){this.animation=Xf.animation}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ib(t){let{transitionDelay:e,transitionDuration:n}=window.getComputedStyle(t),i=parseFloat(e),s=parseFloat(n);return(i+s)*1e3}function Zf(t){return typeof t=="string"}function sc(t){return t!=null}function Rb(t){return t&&t.then}function em(t){return(t||document.body).getBoundingClientRect()}function Mb(t){return e=>new Jt(n=>{let i=r=>t.run(()=>n.next(r)),s=r=>t.run(()=>n.error(r)),o=()=>t.run(()=>n.complete());return e.subscribe({next:i,error:s,complete:o})})}var kb=()=>{},{transitionTimerDelayMs:Ob}=Xf,Po=new Map,dn=(t,e,n,i)=>{let s=i.context||{},o=Po.get(e);if(o)switch(i.runningTransition){case"continue":return uc;case"stop":t.run(()=>o.transition$.complete()),s=Object.assign(o.context,s),Po.delete(e)}let r=n(e,i.animation,s)||kb;if(!i.animation||window.getComputedStyle(e).transitionProperty==="none")return t.run(()=>r()),ge(void 0).pipe(Mb(t));let a=new Ue,l=new Ue,c=a.pipe(hc(!0));Po.set(e,{transition$:a,complete:()=>{l.next(),l.complete()},context:s});let u=Ib(e);return t.runOutsideAngular(()=>{let d=vt(e,"transitionend").pipe(Ae(c),st(({target:p})=>p===e)),h=Vo(u+Ob).pipe(Ae(c));dc(h,d,l).pipe(Ae(c)).subscribe(()=>{Po.delete(e),t.run(()=>{r(),a.next(),a.complete()})})}),a.asObservable()};var tm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var nm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var im=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})(),sm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var ac=function(t){return t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.ArrowLeft=37]="ArrowLeft",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowDown=40]="ArrowDown",t}(ac||{});var mR=(()=>{let t=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2,e=()=>/Android/.test(navigator.userAgent);return typeof navigator<"u"?!!navigator.userAgent&&(t()||e()):!1})();var Nb=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function om(t){let e=Array.from(t.querySelectorAll(Nb)).filter(n=>n.tabIndex!==-1);return[e[0],e[e.length-1]]}var Ab=(t,e,n,i=!1)=>{t.runOutsideAngular(()=>{let s=vt(e,"focusin").pipe(Ae(n),ue(o=>o.target));vt(e,"keydown").pipe(Ae(n),st(o=>o.which===ac.Tab),ei(s)).subscribe(([o,r])=>{let[a,l]=om(e);(r===a||r===e)&&o.shiftKey&&(l.focus(),o.preventDefault()),r===l&&!o.shiftKey&&(a.focus(),o.preventDefault())}),i&&vt(e,"click").pipe(Ae(n),ei(s),ue(o=>o[1])).subscribe(o=>o.focus())})};var _R=new Date(1882,10,12),gR=new Date(2174,10,25);var yR=1e3*60*60*24;var lc=1080,xb=24*lc,Pb=12*lc+793,vR=29*xb+Pb,bR=11*lc+204;var rm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var am=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})(),Fb=(()=>{let e=class e{constructor(){this._ngbConfig=b(Db),this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return this._animation??this._ngbConfig.animation}set animation(i){this._animation=i}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Qn=class{constructor(e,n,i){this.nodes=e,this.viewRef=n,this.componentRef=i}};var Bb=(()=>{let e=class e{constructor(){this._document=b(mn)}hide(){let i=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),s=this._document.body,o=s.style,{overflow:r,paddingRight:a}=o;if(i>0){let l=parseFloat(window.getComputedStyle(s).paddingRight);o.paddingRight=`${l+i}px`}return o.overflow="hidden",()=>{i>0&&(o.paddingRight=a),o.overflow=r}}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Lb=(()=>{let e=class e{constructor(){this._nativeElement=b(Wo).nativeElement,this._zone=b(j)}ngOnInit(){this._zone.onStable.asObservable().pipe(Xn(1)).subscribe(()=>{dn(this._zone,this._nativeElement,(i,s)=>{s&&em(i),i.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return dn(this._zone,this._nativeElement,({classList:i})=>i.remove("show"),{animation:this.animation,runningTransition:"stop"})}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(s,o){s&2&&(os("modal-backdrop"+(o.backdropClass?" "+o.backdropClass:"")),Ko("show",!o.animation)("fade",o.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},standalone:!0,features:[L],decls:0,vars:0,template:function(s,o){},encapsulation:2});let t=e;return t})(),Fo=class{update(e){}close(e){}dismiss(e){}},zb=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],Vb=["animation","backdropClass"],oc=class{_applyWindowOptions(e,n){zb.forEach(i=>{sc(n[i])&&(e[i]=n[i])})}_applyBackdropOptions(e,n){Vb.forEach(i=>{sc(n[i])&&(e[i]=n[i])})}update(e){this._applyWindowOptions(this._windowCmptRef.instance,e),this._backdropCmptRef&&this._backdropCmptRef.instance&&this._applyBackdropOptions(this._backdropCmptRef.instance,e)}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(Ae(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(Ae(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}constructor(e,n,i,s){this._windowCmptRef=e,this._contentRef=n,this._backdropCmptRef=i,this._beforeDismiss=s,this._closed=new Ue,this._dismissed=new Ue,this._hidden=new Ue,e.instance.dismissEvent.subscribe(o=>{this.dismiss(o)}),this.result=new Promise((o,r)=>{this._resolve=o,this._reject=r}),this.result.then(null,()=>{})}close(e){this._windowCmptRef&&(this._closed.next(e),this._resolve(e),this._removeModalElements())}_dismiss(e){this._dismissed.next(e),this._reject(e),this._removeModalElements()}dismiss(e){if(this._windowCmptRef)if(!this._beforeDismiss)this._dismiss(e);else{let n=this._beforeDismiss();Rb(n)?n.then(i=>{i!==!1&&this._dismiss(e)},()=>{}):n!==!1&&this._dismiss(e)}}_removeModalElements(){let e=this._windowCmptRef.instance.hide(),n=this._backdropCmptRef?this._backdropCmptRef.instance.hide():ge(void 0);e.subscribe(()=>{let{nativeElement:i}=this._windowCmptRef.location;i.parentNode.removeChild(i),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),n.subscribe(()=>{if(this._backdropCmptRef){let{nativeElement:i}=this._backdropCmptRef.location;i.parentNode.removeChild(i),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),is(e,n).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}},rc=function(t){return t[t.BACKDROP_CLICK=0]="BACKDROP_CLICK",t[t.ESC=1]="ESC",t}(rc||{}),Ub=(()=>{let e=class e{constructor(){this._document=b(mn),this._elRef=b(Wo),this._zone=b(j),this._closed$=new Ue,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new Ct,this.shown=new Ue,this.hidden=new Ue}get fullscreenClass(){return this.fullscreen===!0?" modal-fullscreen":Zf(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(i){this.dismissEvent.emit(i)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe(Xn(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){let{nativeElement:i}=this._elRef,s={animation:this.animation,runningTransition:"stop"},o=dn(this._zone,i,()=>i.classList.remove("show"),s),r=dn(this._zone,this._dialogEl.nativeElement,()=>{},s),a=is(o,r);return a.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),a}_show(){let i={animation:this.animation,runningTransition:"continue"},s=dn(this._zone,this._elRef.nativeElement,(r,a)=>{a&&em(r),r.classList.add("show")},i),o=dn(this._zone,this._dialogEl.nativeElement,()=>{},i);is(s,o).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){let{nativeElement:i}=this._elRef;this._zone.runOutsideAngular(()=>{vt(i,"keydown").pipe(Ae(this._closed$),st(o=>o.which===ac.Escape)).subscribe(o=>{this.keyboard?requestAnimationFrame(()=>{o.defaultPrevented||this._zone.run(()=>this.dismiss(rc.ESC))}):this.backdrop==="static"&&this._bumpBackdrop()});let s=!1;vt(this._dialogEl.nativeElement,"mousedown").pipe(Ae(this._closed$),yc(()=>s=!1),ke(()=>vt(i,"mouseup").pipe(Ae(this._closed$),Xn(1))),st(({target:o})=>i===o)).subscribe(()=>{s=!0}),vt(i,"click").pipe(Ae(this._closed$)).subscribe(({target:o})=>{i===o&&(this.backdrop==="static"?this._bumpBackdrop():this.backdrop===!0&&!s&&this._zone.run(()=>this.dismiss(rc.BACKDROP_CLICK))),s=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){let{nativeElement:i}=this._elRef;if(!i.contains(document.activeElement)){let s=i.querySelector("[ngbAutofocus]"),o=om(i)[0];(s||o||i).focus()}}_restoreFocus(){let i=this._document.body,s=this._elWithFocus,o;s&&s.focus&&i.contains(s)?o=s:o=i,this._zone.runOutsideAngular(()=>{setTimeout(()=>o.focus()),this._elWithFocus=null})}_bumpBackdrop(){this.backdrop==="static"&&dn(this._zone,this._elRef.nativeElement,({classList:i})=>(i.add("modal-static"),()=>i.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["ngb-modal-window"]],viewQuery:function(s,o){if(s&1&&Nc(Sb,7),s&2){let r;Oc(r=Ac())&&(o._dialogEl=r.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(s,o){s&2&&(Sc("aria-modal",!0)("aria-labelledby",o.ariaLabelledBy)("aria-describedby",o.ariaDescribedBy),os("modal d-block"+(o.windowClass?" "+o.windowClass:"")),Ko("fade",o.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},standalone:!0,features:[L],ngContentSelectors:Eb,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(s,o){s&1&&(Dc(),g(0,"div",0,1)(2,"div",2),Ic(3),_()()),s&2&&os("modal-dialog"+(o.size?" modal-"+o.size:"")+(o.centered?" modal-dialog-centered":"")+o.fullscreenClass+(o.scrollable?" modal-dialog-scrollable":"")+(o.modalDialogClass?" "+o.modalDialogClass:""))},styles:[`ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}
`],encapsulation:2});let t=e;return t})(),$b=(()=>{let e=class e{constructor(){this._applicationRef=b(xc),this._injector=b(de),this._environmentInjector=b(jo),this._document=b(mn),this._scrollBar=b(Bb),this._activeWindowCmptHasChanged=new Ue,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._modalRefs=[],this._windowCmpts=[],this._activeInstances=new Ct;let i=b(j);this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){let s=this._windowCmpts[this._windowCmpts.length-1];Ab(i,s.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(s.location.nativeElement)}})}_restoreScrollBar(){let i=this._scrollBarRestoreFn;i&&(this._scrollBarRestoreFn=null,i())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(i,s,o){let r=o.container instanceof HTMLElement?o.container:sc(o.container)?this._document.querySelector(o.container):this._document.body;if(!r)throw new Error(`The specified modal container "${o.container||"body"}" was not found in the DOM.`);this._hideScrollBar();let a=new Fo;i=o.injector||i;let l=i.get(jo,null)||this._environmentInjector,c=this._getContentRef(i,l,s,a,o),u=o.backdrop!==!1?this._attachBackdrop(r):void 0,d=this._attachWindowComponent(r,c.nodes),h=new oc(d,c,u,o.beforeDismiss);return this._registerModalRef(h),this._registerWindowCmpt(d),h.hidden.pipe(Xn(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(this._document.body.classList.remove("modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),a.close=p=>{h.close(p)},a.dismiss=p=>{h.dismiss(p)},a.update=p=>{h.update(p)},h.update(o),this._modalRefs.length===1&&this._document.body.classList.add("modal-open"),u&&u.instance&&u.changeDetectorRef.detectChanges(),d.changeDetectorRef.detectChanges(),h}get activeInstances(){return this._activeInstances}dismissAll(i){this._modalRefs.forEach(s=>s.dismiss(i))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(i){let s=ls(Lb,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector});return this._applicationRef.attachView(s.hostView),i.appendChild(s.location.nativeElement),s}_attachWindowComponent(i,s){let o=ls(Ub,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector,projectableNodes:s});return this._applicationRef.attachView(o.hostView),i.appendChild(o.location.nativeElement),o}_getContentRef(i,s,o,r,a){return o?o instanceof kc?this._createFromTemplateRef(o,r):Zf(o)?this._createFromString(o):this._createFromComponent(i,s,o,r,a):new Qn([])}_createFromTemplateRef(i,s){let o={$implicit:s,close(a){s.close(a)},dismiss(a){s.dismiss(a)}},r=i.createEmbeddedView(o);return this._applicationRef.attachView(r),new Qn([r.rootNodes],r)}_createFromString(i){let s=this._document.createTextNode(`${i}`);return new Qn([[s]])}_createFromComponent(i,s,o,r,a){let l=de.create({providers:[{provide:Fo,useValue:r}],parent:i}),c=ls(o,{environmentInjector:s,elementInjector:l}),u=c.location.nativeElement;return a.scrollable&&u.classList.add("component-host-scrollable"),this._applicationRef.attachView(c.hostView),new Qn([[u]],c.hostView,c)}_setAriaHidden(i){let s=i.parentElement;s&&i!==this._document.body&&(Array.from(s.children).forEach(o=>{o!==i&&o.nodeName!=="SCRIPT"&&(this._ariaHiddenValues.set(o,o.getAttribute("aria-hidden")),o.setAttribute("aria-hidden","true"))}),this._setAriaHidden(s))}_revertAriaHidden(){this._ariaHiddenValues.forEach((i,s)=>{i?s.setAttribute("aria-hidden",i):s.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(i){let s=()=>{let o=this._modalRefs.indexOf(i);o>-1&&(this._modalRefs.splice(o,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(i),this._activeInstances.emit(this._modalRefs),i.result.then(s,s)}_registerWindowCmpt(i){this._windowCmpts.push(i),this._activeWindowCmptHasChanged.next(),i.onDestroy(()=>{let s=this._windowCmpts.indexOf(i);s>-1&&(this._windowCmpts.splice(s,1),this._activeWindowCmptHasChanged.next())})}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Hb=(()=>{let e=class e{constructor(){this._injector=b(de),this._modalStack=b($b),this._config=b(Fb)}open(i,s={}){let o=Me(Je(Me({},this._config),{animation:this._config.animation}),s);return this._modalStack.open(this._injector,i,o)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(i){this._modalStack.dismissAll(i)}hasOpenModals(){return this._modalStack.hasOpenModals()}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=ye({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),lm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({providers:[Hb]});let t=e;return t})();var cm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var um=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var dm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var hm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var pm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var fm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var mm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var _m=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var gm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var wR=new G("live announcer delay",{providedIn:"root",factory:()=>100});var ym=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})();var vm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({});let t=e;return t})(),Gb=[tm,nm,im,sm,rm,am,lm,cm,vm,um,dm,hm,pm,fm,mm,_m,gm,ym],bm=(()=>{let e=class e{};e.\u0275fac=function(s){return new(s||e)},e.\u0275mod=N({type:e}),e.\u0275inj=O({imports:[Gb,tm,nm,im,sm,rm,am,lm,cm,vm,um,dm,hm,pm,fm,mm,_m,gm,ym]});let t=e;return t})();cs(Yf);cs(Qf);cs(Jf);var wm={providers:[Wc(id,qc(),Yc(),Kc()),ti([Ru(()=>Mu(gu)),Ou(()=>Au()),xu(()=>Pu()),Cd(()=>Ed()),zd(()=>Vd()),$d(()=>Hd()),th(()=>nh()),ch(()=>mr())]),qf,ti(Bu),ti(Zc),ti(bm),sd(),Bc()]};var Tm=(()=>{let e=class e{constructor(){this.authService=b(dt),this.calendarEvents=b(Lt),this.translationsService=b(Fu),this.contactsService=b(Ds),this.i18n=b(Mn),this.Nzi18n=b(su),this.showLayoutTopBottom=Ec(!0)}ngOnInit(){this.Nzi18n.setLocale(ou),this.calendarEvents.fetchData(),this.authService.fetchAuth(),this.contactsService.fetchData(),this.translationsService.fetchTranslate(),this.getTranslations()}getTranslations(){this.translationsService.fetchTranslate(),console.log(this.translationsService.$translations())}};e.\u0275fac=function(s){return new(s||e)},e.\u0275cmp=B({type:e,selectors:[["app-root"]],standalone:!0,features:[L],decls:1,vars:0,template:function(s,o){s&1&&A(0,"router-outlet")},dependencies:[Hc,hu,re],encapsulation:2});let t=e;return t})();zc(Tm,wm).catch(t=>console.error(t));
